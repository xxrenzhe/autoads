(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9956],{29824:(e,s,t)=>{Promise.resolve().then(t.bind(t,80782))},80782:(e,s,t)=>{"use strict";t.d(s,{default:()=>A});var a=t(54568),l=t(7620),n=t(63353),c=t(47227),r=t(64148),i=t(80244),d=t(3761),o=t(70111),x=t(39756),m=t(86907),h=t(97904),u=t(12186),j=t(73146),p=t(557),f=t(51603),g=t(51874),N=t(8039),v=t(30149),y=t(76451),w=t(33033),b=t(132),k=t(71402),F=t(42260),B=t(34503),S=t(17296),D=t(45155),R=t(7110);let U=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];function A(){let[e,s]=(0,l.useState)(null),[t,A]=(0,l.useState)(null),[L,T]=(0,l.useState)(!0),[C,Z]=(0,l.useState)(!1),[O,E]=(0,l.useState)("30d"),[W,P]=(0,l.useState)("all");(0,l.useEffect)(()=>{I()},[O,W]);let I=async()=>{try{T(!0);let[e,t]=await Promise.all([N.L.getCached("/user/tokens/balance",void 0,5e3,!1),N.L.get("/user/tokens/usage?".concat(new URLSearchParams({..."all"!==O&&{startDate:new Date(Date.now()-24*parseInt(O)*36e5).toISOString()},..."all"!==W&&{feature:W}})))]);(null==e?void 0:e.success)&&s(e.data),(null==t?void 0:t.success)&&A(t.data)}catch(e){console.error("Error fetching token data:",e),g.oR.error("Failed to fetch token data")}finally{T(!1),Z(!1)}},_=async()=>{Z(!0),await I()},X=async()=>{try{let e=await N.L.get("/user/tokens/usage?".concat(new URLSearchParams({limit:"1000",..."all"!==O&&{startDate:new Date(Date.now()-24*parseInt(O)*36e5).toISOString()},..."all"!==W&&{feature:W}})));if(null==e?void 0:e.success){let s=z(e.data.records);K(s,"token-usage-".concat(new Date().toISOString().split("T")[0],".csv")),g.oR.success("Usage data exported successfully")}}catch(e){console.error("Error exporting usage:",e),g.oR.error("Failed to export usage data")}},z=e=>{var s,t,a;return(a=[["Date","Feature","Operation","Tokens","Items","Batch","Efficiency"],...null==e||null==(s=e.filter(Boolean))?void 0:s.map(e=>[new Date(e.createdAt).toLocaleDateString(),e.feature,e.operation,e.tokensConsumed,e.itemCount,e.isBatch?"Yes":"No",(e.tokensConsumed/e.itemCount).toFixed(2)])],null==(t=a.filter(Boolean)))?void 0:t.map(e=>e.join(",")).join("\n")},K=(e,s)=>{let t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download=s,l.click(),window.URL.revokeObjectURL(a)};if(L)return(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(x.A,{className:"h-8 w-8 animate-spin"})});if(!e||!t)return(0,a.jsxs)(o.Fc,{children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsx)(o.TN,{children:"Failed to load token usage data. Please try refreshing the page."})]});let Q=Object.entries(e.analytics.byFeature).map(s=>{let[t,a]=s;return{name:t.charAt(0).toUpperCase()+t.slice(1),value:a,percentage:(a/e.monthlyUsage*100).toFixed(1)}});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Token Usage Analytics"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Track your token consumption and usage patterns"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(c.$,{variant:"outline",onClick:X,children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,a.jsxs)(c.$,{variant:"outline",onClick:_,disabled:C,children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2 ".concat(C?"animate-spin":"")}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Current Balance"}),(0,a.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.currentBalance.toLocaleString()}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"tokens available"})]})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Monthly Usage"}),(0,a.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.monthlyUsage.toLocaleString()}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["of ",e.planQuota.toLocaleString()," quota"]}),(0,a.jsx)(i.k,{value:e.usagePercentage,className:"mt-2"})]})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Daily Average"}),(0,a.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.analytics.averageDaily.toFixed(1)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"tokens per day"})]})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-sm font-medium",children:"Efficiency"}),(0,a.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.Wu,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.analytics.efficiency.toFixed(2)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"tokens per item"})]})]})]}),e.forecast.willExceedQuota&&(0,a.jsxs)(o.Fc,{children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsxs)(o.TN,{children:[(0,a.jsx)("strong",{children:"Usage Warning:"})," Based on current usage patterns, you may exceed your monthly quota. Projected usage: ",e.forecast.projectedUsage.toFixed(0)," tokens (Confidence: ",(100*e.forecast.confidence).toFixed(0),"%)"]})]}),e.forecast.daysUntilDepletion&&e.forecast.daysUntilDepletion<7&&(0,a.jsxs)(o.Fc,{children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsxs)(o.TN,{children:[(0,a.jsx)("strong",{children:"Low Balance Warning:"})," At current usage rate, your token balance will be depleted in approximately ",e.forecast.daysUntilDepletion," days."]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Time Range:"}),(0,a.jsxs)("select",{value:O,onChange:e=>E(e.target.value),className:"px-3 py-1 border rounded-md text-sm",children:[(0,a.jsx)("option",{value:"7",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90",children:"Last 90 days"}),(0,a.jsx)("option",{value:"all",children:"All time"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Feature:"}),(0,a.jsxs)("select",{value:W,onChange:e=>P(e.target.value),className:"px-3 py-1 border rounded-md text-sm",children:[(0,a.jsx)("option",{value:"all",children:"All features"}),(0,a.jsx)("option",{value:"siterank",children:"SiteRank"}),(0,a.jsx)("option",{value:"batchopen",children:"BatchOpen"}),(0,a.jsx)("option",{value:"adscenter",children:"AdsCenter"})]})]})]}),(0,a.jsxs)(d.tU,{defaultValue:"overview",className:"space-y-4",children:[(0,a.jsxs)(d.j7,{children:[(0,a.jsx)(d.Xi,{value:"overview",children:"Overview"}),(0,a.jsx)(d.Xi,{value:"trends",children:"Trends"}),(0,a.jsx)(d.Xi,{value:"batches",children:"Batch Operations"}),(0,a.jsx)(d.Xi,{value:"forecast",children:"Forecast"})]}),(0,a.jsx)(d.av,{value:"overview",className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Usage by Feature"}),(0,a.jsx)(n.BT,{children:"Token consumption breakdown"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)(v.u,{width:"100%",height:300,children:(0,a.jsxs)(y.r,{children:[(0,a.jsx)(w.F,{data:Q,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:e=>{let{name:s,percentage:t}=e;return"".concat(s,": ").concat(t,"%")},children:Q.map((e,s)=>(0,a.jsx)(b.f,{fill:U[s%U.length]},"cell-".concat(s)))}),(0,a.jsx)(k.m,{})]})})})]}),(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Recent Usage"}),(0,a.jsx)(n.BT,{children:"Latest token consumption activities"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"space-y-3",children:t.records.slice(0,5).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium capitalize",children:e.feature}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.operation," • ",e.itemCount," items",e.isBatch&&(0,a.jsx)(r.E,{variant:"secondary",className:"ml-2",children:"Batch"})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-medium",children:[e.tokensConsumed," tokens"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]})]},s))})})]})]})}),(0,a.jsx)(d.av,{value:"trends",className:"space-y-4",children:(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Usage Trends"}),(0,a.jsx)(n.BT,{children:"Token consumption over time"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)(v.u,{width:"100%",height:400,children:(0,a.jsxs)(F.Q,{data:t.timeSeries,children:[(0,a.jsx)(B.d,{strokeDasharray:"3 3"}),(0,a.jsx)(S.W,{dataKey:"date"}),(0,a.jsx)(D.h,{}),(0,a.jsx)(k.m,{}),(0,a.jsx)(R.G,{type:"monotone",dataKey:"totalTokens",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3})]})})})]})}),(0,a.jsx)(d.av,{value:"batches",className:"space-y-4",children:(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Batch Operations"}),(0,a.jsx)(n.BT,{children:"Summary of batch operations and their efficiency"})]}),(0,a.jsx)(n.Wu,{children:(0,a.jsx)("div",{className:"space-y-3",children:t.batchSummaries.slice(0,10).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium capitalize",children:e.feature}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.operation," • ",e.totalItems," items"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-medium",children:[e.totalTokens," tokens"]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(e.totalTokens/e.totalItems).toFixed(2)," per item"]})]})]},s))})})]})}),(0,a.jsx)(d.av,{value:"forecast",className:"space-y-4",children:(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Usage Forecast"}),(0,a.jsx)(n.BT,{children:"Projected token consumption for the next 30 days"})]}),(0,a.jsxs)(n.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:t.forecast.next30Days.toFixed(0)}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Projected tokens"})]}),(0,a.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[(100*t.forecast.confidence).toFixed(0),"%"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Confidence"})]}),(0,a.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.forecast.daysUntilDepletion||"∞"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Days until depletion"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Forecast by Feature"}),Object.entries(t.forecast.breakdown).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"capitalize",children:s}),(0,a.jsxs)("span",{className:"font-medium",children:[t.toFixed(0)," tokens"]})]},s)})]})]})]})})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2076,4121,7358],()=>s(29824)),_N_E=e.O()}]);