(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9254],{33716:(e,s,t)=>{"use strict";t.d(s,{default:()=>w});var a=t(54568),n=t(7620),l=t(63353),r=t(47227),c=t(65165),i=t(67474),o=t(64148),d=t(80244),x=t(70111),m=t(60803),u=t(39756),h=t(86907),j=t(62708),p=t(78839),f=t(557),g=t(22878),N=t(66043),y=t(40860),b=t(51874),v=t(8039);function w(){let[e,s]=(0,n.useState)(null),[t,w]=(0,n.useState)(!0),[k,B]=(0,n.useState)(100),[F,U]=(0,n.useState)(!1),[A,T]=(0,n.useState)(!1);(0,n.useEffect)(()=>{C()},[]);let C=async()=>{try{w(!0);let e=await v.L.getCached("/user/tokens/balance",void 0,5e3,!0);e?s(e):b.oR.error("Failed to fetch token balance")}catch(e){console.error("Error fetching balance:",e),b.oR.error("Failed to fetch token balance")}finally{w(!1)}},R=async()=>{if(k<1||k>1e4)return void b.oR.error("Top-up amount must be between 1 and 10,000 tokens");try{U(!0);let e=await v.L.post("/user/tokens/balance",{amount:k,reason:"Token top-up: ".concat(k," tokens")});if((null==e?void 0:e.success)&&(null==e?void 0:e.data)){let t=e.data;s(e=>e?{...e,currentBalance:t.newBalance}:null),T(!1),B(100),b.oR.success(t.message)}else b.oR.error((null==e?void 0:e.error)||"Failed to process top-up")}catch(e){console.error("Error processing top-up:",e),b.oR.error("Failed to process top-up")}finally{U(!1)}};if(t)return(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)(u.A,{className:"h-8 w-8 animate-spin"})});if(!e)return(0,a.jsxs)(x.Fc,{children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsx)(x.TN,{children:"Failed to load token balance. Please try refreshing the page."})]});let Z=e?e.currentBalance<10?{color:"red",text:"Critical"}:e.currentBalance<50?{color:"yellow",text:"Low"}:e.currentBalance<200?{color:"blue",text:"Moderate"}:{color:"green",text:"Healthy"}:{color:"gray",text:"Unknown"},S=e?e.usagePercentage>=90?{color:"red",text:"High Usage"}:e.usagePercentage>=70?{color:"yellow",text:"Moderate Usage"}:{color:"green",text:"Normal Usage"}:{color:"gray",text:"Unknown"};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Token Balance"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your token balance and monitor usage"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",onClick:C,disabled:t,children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,a.jsxs)(r.$,{onClick:()=>T(!0),children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Top Up"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-sm font-medium",children:"Current Balance"}),(0,a.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.currentBalance.toLocaleString()}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(o.E,{variant:"red"===Z.color?"destructive":"yellow"===Z.color?"secondary":"default",children:Z.text}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"tokens available"})]})]})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-sm font-medium",children:"Monthly Usage"}),(0,a.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.monthlyUsage.toLocaleString()}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs mb-1",children:[(0,a.jsx)("span",{children:"Usage"}),(0,a.jsxs)("span",{children:[e.usagePercentage.toFixed(1),"%"]})]}),(0,a.jsx)(d.k,{value:e.usagePercentage,className:"h-2"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(o.E,{variant:"red"===S.color?"destructive":"yellow"===S.color?"secondary":"default",children:S.text}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["of ",e.planQuota.toLocaleString()," quota"]})]})]})]})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ZB,{className:"text-sm font-medium",children:"Daily Average"}),(0,a.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold",children:e.analytics.averageDaily.toFixed(1)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"tokens per day"}),e.forecast.daysUntilDepletion&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("p",{className:"text-sm font-medium",children:[e.forecast.daysUntilDepletion," days remaining"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"at current usage rate"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[e.currentBalance<50&&(0,a.jsxs)(x.Fc,{children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsxs)(x.TN,{children:[(0,a.jsx)("strong",{children:"Low Balance Warning:"})," Your token balance is running low. Consider topping up to avoid service interruption."]})]}),e.forecast.willExceedQuota&&(0,a.jsxs)(x.Fc,{children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsxs)(x.TN,{children:[(0,a.jsx)("strong",{children:"Usage Warning:"})," Based on current usage patterns, you may exceed your monthly quota. Projected usage: ",e.forecast.projectedUsage.toFixed(0)," tokens (Confidence: ",(100*e.forecast.confidence).toFixed(0),"%)"]})]}),e.forecast.daysUntilDepletion&&e.forecast.daysUntilDepletion<7&&(0,a.jsxs)(x.Fc,{children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsxs)(x.TN,{children:[(0,a.jsx)("strong",{children:"Critical Balance Warning:"})," At current usage rate, your token balance will be depleted in approximately ",e.forecast.daysUntilDepletion," days."]})]})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Usage Breakdown"}),(0,a.jsx)(l.BT,{children:"Token consumption by feature this month"})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:Object.entries(e.analytics.byFeature).map(s=>{let[t,n]=s,l=n/e.monthlyUsage*100;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"capitalize font-medium",children:t}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[n.toLocaleString()," tokens (",l.toFixed(1),"%)"]})]}),(0,a.jsx)(d.k,{value:l,className:"h-2"})]},t)})})})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"h-5 w-5"}),"Usage Forecast"]}),(0,a.jsx)(l.BT,{children:"Projected token consumption for the next 30 days"})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.forecast.projectedUsage.toFixed(0)}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Projected tokens"})]}),(0,a.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[(100*e.forecast.confidence).toFixed(0),"%"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Confidence level"})]}),(0,a.jsxs)("div",{className:"text-center p-4 border rounded-lg",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.analytics.efficiency.toFixed(2)}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tokens per item"})]})]})})]}),A&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)(l.Zp,{className:"w-full max-w-md mx-4",children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5"}),"Top Up Tokens"]}),(0,a.jsx)(l.BT,{children:"Add tokens to your account balance"})]}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.J,{htmlFor:"topup-amount",children:"Amount"}),(0,a.jsx)(c.p,{id:"topup-amount",type:"number",min:"1",max:"10000",value:k,onChange:e=>B(parseInt(e.target.value)||0),placeholder:"Enter token amount"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Minimum: 1 token, Maximum: 10,000 tokens"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,a.jsx)("span",{children:"Current Balance:"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.currentBalance.toLocaleString()," tokens"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,a.jsx)("span",{children:"After Top-up:"}),(0,a.jsxs)("span",{className:"font-medium",children:[(e.currentBalance+k).toLocaleString()," tokens"]})]}),(0,a.jsx)(m.w,{}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>T(!1),className:"flex-1",children:"Cancel"}),(0,a.jsx)(r.$,{onClick:R,disabled:F||k<1||k>1e4,className:"flex-1",children:F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Top Up"]})})]})]})]})})]})}},61362:(e,s,t)=>{Promise.resolve().then(t.bind(t,33716))}},e=>{var s=s=>e(e.s=s);e.O(0,[2076,4121,7358],()=>s(61362)),_N_E=e.O()}]);