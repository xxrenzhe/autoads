(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{21948:(e,n,r)=>{"use strict";r.d(n,{default:()=>e_});var s=r(54568),i=r(7620),t=r(55570),a=r(80826),l=r(73804),c=r(10835),o=r(33161),d=r(50010),x=r(92982),h=r(66848),A=r(78867),j=r(33431),m=r(31184),u=r(18570),y=r(59934),p=r(56120),v=r(99825),b=r(15984),g=r(15511),k=r(8136),f=r(27584),S=r(67556),w=r(82512),C=r(81575),I=r(81357),T=r(19001),D=r(3705),R=r(32077),P=r(31926),E=r(5759),B=r(63626),L=r(83348),U=r(82741),z=r(49645),W=r(96935),M=r(52684),N=r(50257),F=r(24327),O=r(56206),q=r(25952);let H=e=>{let{open:n,onClose:r,checkInResult:i,onShare:t,hasSharedToday:a=!1}=e,{checkIn:o}=i;return(0,s.jsxs)(M.A,{open:n,onClose:r,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,overflow:"hidden"}},children:[(0,s.jsxs)(N.A,{sx:{textAlign:"center",pb:2},children:[(0,s.jsx)(z.N,{children:n&&(0,s.jsx)(W.P.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20},children:(0,s.jsx)(W.P.div,{animate:{rotate:[0,10,-10,0],scale:[1,1.1,1]},transition:{duration:.5,ease:"easeInOut"},children:(0,s.jsx)(w.A,{color:"success",sx:{fontSize:64,mb:2,filter:"drop-shadow(0 4px 8px rgba(76, 175, 80, 0.3))"}})})})}),(0,s.jsxs)(W.P.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:[(0,s.jsx)(c.A,{variant:"h4",fontWeight:700,children:"签到成功！"}),(0,s.jsx)(c.A,{variant:"body1",color:"text.secondary",mt:1,children:(e=>1===e?"初来乍到，继续加油！":2===e?"连续两天，保持势头！":3===e?"三连达成，势不可挡！":e>=4?"签到达人，太棒了！":"签到成功！")(o.streak)})]})]}),(0,s.jsxs)(F.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(W.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},children:(0,s.jsxs)(l.A,{sx:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",color:"white",borderRadius:2,p:3,mb:3,position:"relative",overflow:"hidden"},children:[(0,s.jsx)(l.A,{sx:{position:"absolute",top:-50,right:-50,width:100,height:100,background:"rgba(255, 255, 255, 0.1)",borderRadius:"50%"}}),(0,s.jsxs)(c.A,{variant:"h3",fontWeight:700,children:["+",o.tokens," Token"]}),(0,s.jsxs)(m.A,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,mt:1,children:[(0,s.jsx)(C.A,{}),(0,s.jsxs)(c.A,{variant:"body1",children:["连续 ",o.streak," 天"]})]})]})}),o.rewardLevel>1&&(0,s.jsx)(W.P.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},children:(0,s.jsx)(y.A,{label:"奖励等级 ".concat(o.rewardLevel),color:"success",sx:{mb:3,fontSize:"1rem",px:2,py:1,"& .MuiChip-icon":{fontSize:"1.2rem"}},icon:(0,s.jsx)(T.A,{})})}),(0,s.jsx)(v.A,{sx:{my:3}}),(0,s.jsx)(W.P.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},children:(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsxs)(m.A,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,mb:2,children:[(0,s.jsx)(q.A,{color:"primary"}),(0,s.jsx)(c.A,{variant:"h6",children:"分享签到"})]}),a?(0,s.jsx)(l.A,{sx:{bgcolor:"success.light",color:"white",borderRadius:2,p:2},children:(0,s.jsxs)(m.A,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,children:[(0,s.jsx)(w.A,{}),(0,s.jsx)(c.A,{variant:"body1",fontWeight:600,children:"今日分享奖励已领取"})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{variant:"body2",color:"text.secondary",mb:2,children:"分享到社交媒体，额外获得 10 Token 奖励！"}),(0,s.jsx)(m.A,{direction:"row",spacing:2,justifyContent:"center",children:[{id:"weixin",name:"微信",icon:"\uD83D\uDCAC"},{id:"weibo",name:"微博",icon:"\uD83D\uDCF1"},{id:"qq",name:"QQ空间",icon:"\uD83D\uDC27"}].map(e=>(0,s.jsx)(W.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,s.jsx)(p.A,{variant:"outlined",onClick:()=>t(e.id),startIcon:(0,s.jsx)("span",{style:{fontSize:"1.2rem"},children:e.icon}),sx:{borderRadius:2,minWidth:100},children:e.name})},e.id))})]})]})})]}),(0,s.jsx)(O.A,{sx:{justifyContent:"center",pb:3},children:(0,s.jsx)(W.P.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},children:(0,s.jsx)(p.A,{onClick:r,variant:"contained",size:"large",sx:{borderRadius:2,px:4,background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)","&:hover":{background:"linear-gradient(135deg, #45a049 0%, #4CAF50 100%)"}},children:"确定"})})})]})};var _=r(8039);let Q=()=>{let[e,n]=(0,i.useState)(null),[r,t]=(0,i.useState)(!1),[z,W]=(0,i.useState)(!1),[M,N]=(0,i.useState)(null),[F,O]=(0,i.useState)(!1),[q,Q]=(0,i.useState)(null),[V,Y]=(0,i.useState)(!1),[G,X]=(0,i.useState)({open:!1,message:"",severity:"success"});(0,i.useEffect)(()=>{J()},[]);let J=async()=>{t(!0),N(null);try{let e=await _.L.get("/user/check-in");n(e),await K()}catch(e){N(e instanceof Error?e.message:"Unknown error")}finally{t(!1)}},K=async()=>{try{let e=new Date,n=(0,R.A)(e).toISOString(),r=(0,P.A)(e).toISOString(),s=await _.L.get("/user/check-in/share-rewards",{startDate:n,endDate:r});Y((null==s?void 0:s.hasSharedToday)||!1)}catch(e){console.error("Failed to check share status:",e)}},Z=async()=>{W(!0),N(null);try{let e=await _.L.post("/user/check-in",void 0);if((null==e?void 0:e.success)===!1)throw Error((null==e?void 0:e.error)||"Check-in failed");Q(e),O(!0),await J()}catch(e){N(e instanceof Error?e.message:"Check-in failed")}finally{W(!1)}},$=async e=>{var n;if(!(null==q||null==(n=q.checkIn)?void 0:n.id))return void X({open:!0,message:"请先完成签到",severity:"error"});try{let n="我在 AdsCenter 已连续签到 ".concat(q.checkIn.streak," 天，获得了 ").concat(q.checkIn.tokens," Token 奖励！一起来签到赢取奖励吧！"),r=window.location.origin,s=await _.L.post("/user/check-in/share-rewards",{checkInId:q.checkIn.id,platform:e,shareText:n,shareUrl:r});if((null==s?void 0:s.success)===!1)throw Error((null==s?void 0:s.error)||"Share reward failed");if(Y(!0),X({open:!0,message:"分享成功！获得 ".concat(s.rewardToken," Token 奖励"),severity:"success"}),await J(),"weixin"===e)console.log("Sharing to WeChat:",n,r);else if("weibo"===e){let e="https://service.weibo.com/share/share.php?url=".concat(encodeURIComponent(r),"&title=").concat(encodeURIComponent(n));window.open(e,"_blank")}else if("qq"===e){let e="https://connect.qq.com/widget/shareqq/index.html?url=".concat(encodeURIComponent(r),"&title=").concat(encodeURIComponent(n));window.open(e,"_blank")}}catch(e){X({open:!0,message:e instanceof Error?e.message:"分享失败",severity:"error"})}},ee=e=>{let n=[{level:1,tokens:10,label:"第一天",color:"primary"},{level:2,tokens:20,label:"第二天",color:"secondary"},{level:3,tokens:40,label:"第三天",color:"warning"},{level:4,tokens:80,label:"第四天+",color:"success"}];return n[e-1]||n[0]};if(r)return(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsx)(h.A,{})})});if(M)return(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsx)(a.A,{severity:"error",children:M})})});if(!e)return null;let{hasCheckedInToday:en,todayCheckIn:er,stats:es,nextReward:ei}=e;return ee(Math.min(es.currentStreak,4)),ee(ei.rewardLevel),(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(f.A,{sx:{mr:1,color:"primary.main"}}),(0,s.jsx)(c.A,{variant:"h5",component:"h2",children:"每日签到"})]}),(0,s.jsx)(A.A,{title:"刷新",children:(0,s.jsx)(j.A,{onClick:J,size:"small",children:(0,s.jsx)(S.A,{})})})]}),(0,s.jsxs)(x.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{sx:{bgcolor:"primary.light",color:"white"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(w.A,{}),(0,s.jsx)(c.A,{variant:"h4",sx:{my:1},children:es.currentStreak}),(0,s.jsx)(c.A,{variant:"body2",children:"当前连续天数"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{sx:{bgcolor:"warning.light",color:"white"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(C.A,{}),(0,s.jsx)(c.A,{variant:"h4",sx:{my:1},children:es.longestStreak}),(0,s.jsx)(c.A,{variant:"body2",children:"最长连续天数"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{sx:{bgcolor:"info.light",color:"white"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(I.A,{}),(0,s.jsx)(c.A,{variant:"h4",sx:{my:1},children:es.thisMonthCheckIns}),(0,s.jsx)(c.A,{variant:"body2",children:"本月签到"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{sx:{bgcolor:"secondary.light",color:"white"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(T.A,{}),(0,s.jsx)(c.A,{variant:"h4",sx:{my:1},children:es.totalCheckIns}),(0,s.jsx)(c.A,{variant:"body2",children:"累计签到"})]})})})]}),(0,s.jsxs)(l.A,{sx:{mb:3},children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"奖励进度"}),(0,s.jsx)(m.A,{spacing:2,children:[1,2,3,4].map(e=>{let n=ee(e),r=es.currentStreak>=e,i=ei.rewardLevel===e;return(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(u.A,{color:r?"success":"default",variant:r?"standard":"dot",badgeContent:r?(0,s.jsx)(g.A,{fontSize:"small"}):0,children:(0,s.jsx)(y.A,{label:"".concat(n.label,": ").concat(n.tokens," Token"),color:r?"success":i?"primary":"default",variant:r?"filled":"outlined",icon:(0,s.jsx)(D.A,{})})}),i&&!en&&(0,s.jsx)(c.A,{variant:"body2",color:"primary",sx:{ml:2},children:"下一次签到可获得"})]},e)})})]}),(0,s.jsx)(l.A,{sx:{textAlign:"center",mb:3},children:(0,s.jsx)(p.A,{variant:"contained",size:"large",onClick:Z,disabled:en||z,startIcon:en?(0,s.jsx)(g.A,{}):(0,s.jsx)(D.A,{}),sx:{minWidth:200},children:en?"今日已签到 (+".concat(null==er?void 0:er.tokens," Token)"):z?"签到中...":"立即签到 (+".concat(ei.tokens," Token)")})}),(0,s.jsx)(v.A,{sx:{my:2}}),(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"签到日历"}),(()=>{if(!e)return null;let n=new Date,r=[];for(let s=29;s>=0;s--){let i=(0,E.A)(n,s),t=(0,B.A)(i,"yyyy-MM-dd"),a=e.history.find(e=>(0,B.A)(new Date(e.date),"yyyy-MM-dd")===t);r.push({date:i,checkIn:a,isToday:(0,L.A)(i),isPast:i<n})}return(0,s.jsx)(x.Ay,{container:!0,spacing:1,sx:{mt:2},children:r.map((n,r)=>{let i=(0,B.A)(n.date,"EEE",{locale:U.A}),t=(0,B.A)(n.date,"d");return(0,s.jsx)(x.Ay,{item:!0,xs:4,sm:3,md:2,lg:1,children:(0,s.jsxs)(o.A,{sx:{height:80,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:n.checkIn?"success.light":n.isToday?"primary.light":n.isPast?"grey.100":"background.paper",border:n.isToday?2:1,borderColor:n.isToday?"primary.main":"grey.300"},children:[(0,s.jsx)(c.A,{variant:"caption",color:"textSecondary",children:i}),(0,s.jsx)(c.A,{variant:"h6",sx:{my:.5},children:t}),n.checkIn?(0,s.jsx)(g.A,{color:"success",fontSize:"small"}):n.isToday&&!e.hasCheckedInToday?(0,s.jsx)(k.A,{color:"primary",fontSize:"small"}):null,n.checkIn&&(0,s.jsxs)(c.A,{variant:"caption",color:"success.dark",fontWeight:600,children:["+",n.checkIn.tokens]})]})},r)})})})(),(0,s.jsx)(H,{open:F,onClose:()=>O(!1),checkInResult:q,onShare:$,hasSharedToday:V}),(0,s.jsx)(b.A,{open:G.open,autoHideDuration:6e3,onClose:()=>X({...G,open:!1}),message:G.message})]})})};var V=r(58030),Y=r(82258),G=r(14283),X=r(17412),J=r(61963),K=r(87822),Z=r(7005),$=r(56538),ee=r(53049),en=r(99788),er=r(19364),es=r(66146),ei=r(93535),et=r(60333),ea=r(55649),el=r(86909),ec=r(29573),eo=r(4735),ed=r(6913),ex=r(44615),eh=r(44652),eA=r(34721),ej=r(89581),em=r(83668),eu=r(51874);let ey=()=>{var e,n;let[r,t]=(0,i.useState)([]),[m,u]=(0,i.useState)(null),[p,v]=(0,i.useState)([]),[b,g]=(0,i.useState)(!1),[k,f]=(0,i.useState)(null),[w,C]=(0,i.useState)(0),[T,R]=(0,i.useState)(1),[P,E]=(0,i.useState)({type:"",source:"",startDate:"",endDate:""}),[L,z]=(0,i.useState)(null),W={SUBSCRIPTION:(0,s.jsx)(el.A,{}),PURCHASED:(0,s.jsx)(ec.A,{}),ACTIVITY:(0,s.jsx)(D.A,{}),BONUS:(0,s.jsx)(eo.A,{}),REFERRAL:(0,s.jsx)(q.A,{})},M={SUBSCRIPTION:"订阅Token",PURCHASED:"购买Token",ACTIVITY:"活动Token",BONUS:"奖励Token",REFERRAL:"推荐Token"},N={daily_check_in:"每日签到",token_purchase:"Token购买",subscription:"订阅套餐",admin_grant:"管理员授予",siterank:"网站排名",batchopen:"批量打开",adscenter:"链接替换"};(0,i.useEffect)(()=>{F()},[T,P]);let F=async()=>{g(!0),f(null);try{var e;let n=new URLSearchParams({page:T.toString(),limit:"20"});P.type&&n.append("type",P.type),P.source&&n.append("source",P.source),P.startDate&&n.append("startDate",P.startDate),P.endDate&&n.append("endDate",P.endDate);let[r,s,i]=await Promise.all([_.L.get("/user/tokens/transactions",Object.fromEntries(n)),_.L.post("/user/tokens/transactions/stats",{timeRange:{start:new Date(Date.now()-2592e6),end:new Date}}),_.L.get("/user/tokens/balance-history",{days:30})]);t((null==(e=r.data)?void 0:e.transactions)||[]),u(s.data||null),v(i.data||[])}catch(n){let e=n instanceof Error?n.message:"Unknown error";f(e),eu.oR.error("加载交易数据失败："+e)}finally{g(!1)}},O=(e,n)=>{E(r=>({...r,[e]:n})),R(1)},H=async()=>{try{let e=new URLSearchParams;Object.entries(P).forEach(n=>{let[r,s]=n;s&&e.append(r,s)});let n=await _.L.post("/admin/tokens/transactions/export",Object.fromEntries(e));if(null==n?void 0:n.data){let e=n.data,r=Q(e.data),s=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");i.href=URL.createObjectURL(s),i.download=e.filename,i.click()}}catch(e){console.error("Export failed:",e),eu.oR.error("导出失败，请稍后重试")}},Q=e=>{if(0===e.length)return"";let n=Object.keys(e[0]);return[n.join(","),...e.map(e=>n.map(n=>JSON.stringify(e[n])).join(","))].join("\n")};return b?(0,s.jsx)(l.A,{sx:{p:3},children:(0,s.jsx)(h.A,{})}):k?(0,s.jsx)(l.A,{sx:{p:3},children:(0,s.jsx)(a.A,{severity:"error",children:k})}):(0,s.jsxs)(l.A,{sx:{p:3},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,s.jsx)(c.A,{variant:"h4",component:"h1",children:"Token 交易记录"}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(A.A,{title:"刷新",children:(0,s.jsx)(j.A,{onClick:F,children:(0,s.jsx)(S.A,{})})}),(0,s.jsx)(A.A,{title:"导出",children:(0,s.jsx)(j.A,{onClick:H,children:(0,s.jsx)(ed.A,{})})}),(0,s.jsx)(A.A,{title:"筛选",children:(0,s.jsx)(j.A,{onClick:e=>z(e.currentTarget),children:(0,s.jsx)(ex.A,{})})})]})]}),m&&(0,s.jsxs)(x.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(el.A,{sx:{mr:1,color:"primary.main"}}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{color:"textSecondary",variant:"body2",children:"当前余额"}),(0,s.jsx)(c.A,{variant:"h5",children:(null==(n=m.byType)||null==(e=n.SUBSCRIPTION)?void 0:e.acquired)||0})]})]})})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(I.A,{sx:{mr:1,color:"success.main"}}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{color:"textSecondary",variant:"body2",children:"总获得Token"}),(0,s.jsx)(c.A,{variant:"h5",color:"success.main",children:m.totalAcquired.toLocaleString()})]})]})})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(eh.A,{sx:{mr:1,color:"error.main"}}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{color:"textSecondary",variant:"body2",children:"总消耗Token"}),(0,s.jsx)(c.A,{variant:"h5",color:"error.main",children:m.totalConsumed.toLocaleString()})]})]})})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(eA.A,{sx:{mr:1,color:"info.main"}}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{color:"textSecondary",variant:"body2",children:"总交易数"}),(0,s.jsx)(c.A,{variant:"h5",children:m.totalTransactions})]})]})})})})]}),(0,s.jsx)(V.A,{anchorEl:L,open:!!L,onClose:()=>z(null),children:(0,s.jsx)(Y.A,{children:(0,s.jsxs)(G.A,{fullWidth:!0,size:"small",children:[(0,s.jsx)(X.A,{children:"Token类型"}),(0,s.jsxs)(J.A,{value:P.type,label:"Token类型",onChange:e=>O("type",e.target.value),children:[(0,s.jsx)(Y.A,{value:"",children:"全部"}),(0,s.jsx)(Y.A,{value:"SUBSCRIPTION",children:"订阅Token"}),(0,s.jsx)(Y.A,{value:"PURCHASED",children:"购买Token"}),(0,s.jsx)(Y.A,{value:"ACTIVITY",children:"活动Token"}),(0,s.jsx)(Y.A,{value:"BONUS",children:"奖励Token"}),(0,s.jsx)(Y.A,{value:"REFERRAL",children:"推荐Token"})]})]})})}),(0,s.jsx)(l.A,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,s.jsxs)(K.A,{value:w,onChange:(e,n)=>{C(n)},children:[(0,s.jsx)(Z.A,{label:"交易记录"}),(0,s.jsx)(Z.A,{label:"余额趋势"}),(0,s.jsx)(Z.A,{label:"统计报表"})]})}),0===w&&(0,s.jsx)($.A,{component:ee.A,children:(0,s.jsxs)(en.A,{children:[(0,s.jsx)(er.A,{children:(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:"时间"}),(0,s.jsx)(ei.A,{children:"类型"}),(0,s.jsx)(ei.A,{children:"来源"}),(0,s.jsx)(ei.A,{children:"数量"}),(0,s.jsx)(ei.A,{children:"余额变化"}),(0,s.jsx)(ei.A,{children:"描述"})]})}),(0,s.jsx)(et.A,{children:r.map(e=>(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:(0,B.A)(new Date(e.createdAt),"yyyy-MM-dd HH:mm",{locale:U.A})}),(0,s.jsx)(ei.A,{children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[W[e.type],(0,s.jsx)(l.A,{sx:{ml:1},children:M[e.type]})]})}),(0,s.jsx)(ei.A,{children:(0,s.jsx)(y.A,{label:N[e.source]||e.source,size:"small",variant:"outlined"})}),(0,s.jsx)(ei.A,{children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[e.amount>0?(0,s.jsx)(ej.A,{sx:{mr:.5,color:"success.main",fontSize:16}}):(0,s.jsx)(em.A,{sx:{mr:.5,color:"error.main",fontSize:16}}),(0,s.jsx)(c.A,{color:e.amount>0?"success.main":"error.main",fontWeight:600,children:Math.abs(e.amount)})]})}),(0,s.jsx)(ei.A,{children:(0,s.jsxs)(c.A,{variant:"body2",children:[e.balanceBefore," → ",e.balanceAfter]})}),(0,s.jsx)(ei.A,{children:e.description||"-"})]},e.id))})]})}),1===w&&(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"余额趋势 (最近30天)"}),(0,s.jsx)(l.A,{sx:{height:300,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,s.jsx)(c.A,{color:"textSecondary",children:"图表组件待集成"})})]})}),2===w&&m&&(0,s.jsxs)(x.Ay,{container:!0,spacing:3,children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,md:6,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"按类型统计"}),(0,s.jsx)(l.A,{sx:{mt:2},children:Object.entries(m.byType).map(e=>{let[n,r]=e;return(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[(0,s.jsx)(c.A,{variant:"body2",children:M[n]}),(0,s.jsxs)(c.A,{variant:"body2",children:["获得: ",r.acquired," / 消耗: ",r.consumed]})]}),(0,s.jsx)(h.A,{variant:"determinate",value:r.acquired/(r.acquired+r.consumed)*100,sx:{height:8}})]},n)})})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,md:6,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"按来源统计"}),(0,s.jsx)(l.A,{sx:{mt:2},children:Object.entries(m.bySource).map(e=>{let[n,r]=e;return(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,s.jsx)(c.A,{variant:"body2",children:N[n]||n}),(0,s.jsx)(c.A,{variant:"body2",fontWeight:600,children:r})]},n)})})]})})})]}),(0,s.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,s.jsx)(ea.A,{count:Math.ceil(5),page:T,onChange:(e,n)=>R(n),color:"primary"})})]})};var ep=r(1566),ev=r(29070),eb=r(67478),eg=r(50448),ek=r(12031),ef=r(27327);let eS=()=>{let[e,n]=(0,i.useState)(null),[r,t]=(0,i.useState)(null),[h,m]=(0,i.useState)(!1),[u,v]=(0,i.useState)(!1),[b,f]=(0,i.useState)(!1),[S,C]=(0,i.useState)(null),[I,D]=(0,i.useState)(null),[R,P]=(0,i.useState)(0),[E,L]=(0,i.useState)(""),[z,W]=(0,i.useState)(!1),[H,Q]=(0,i.useState)(null),[V,Y]=(0,i.useState)(!1);(0,i.useEffect)(()=>{G()},[]);let G=async()=>{m(!0),C(null);try{let e=await _.L.get("/user/invitation/create"),r=e.data||e;n(r.currentInvitation),t(r.stats)}catch(e){C(e instanceof Error?e.message:"Unknown error")}finally{m(!1)}},X=async()=>{v(!0),C(null);try{let e=await _.L.post("/user/invitation/create",void 0);if((null==e?void 0:e.success)===!1)throw Error((null==e?void 0:e.error)||"Failed to create invitation");D("Invitation code created successfully"),await G()}catch(e){C(e instanceof Error?e.message:"Failed to create invitation")}finally{v(!1)}},J=async()=>{if(!E.trim())return void C("Please enter an invitation code");f(!0),C(null);try{let e=await _.L.post("/user/invitation/accept",{invitationCode:E.trim()});if((null==e?void 0:e.success)===!1)throw Error((null==e?void 0:e.error)||"Failed to accept invitation");Q(e),W(!0),L(""),await G()}catch(e){C(e instanceof Error?e.message:"Failed to accept invitation")}finally{f(!1)}},ea=async e=>{try{await navigator.clipboard.writeText(e),Y(!0),setTimeout(()=>Y(!1),2e3)}catch(e){console.error("Failed to copy:",e)}},el=e=>{switch(e){case"ACCEPTED":return"success";case"PENDING":return"warning";case"EXPIRED":return"error";default:return"default"}},ec=e=>{switch(e){case"ACCEPTED":return(0,s.jsx)(g.A,{});case"PENDING":return(0,s.jsx)(k.A,{});case"EXPIRED":return(0,s.jsx)(eb.A,{});default:return null}};return h?(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,s.jsx)(ep.A,{})})})}):(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(eg.A,{sx:{mr:1,color:"primary.main"}}),(0,s.jsx)(c.A,{variant:"h5",component:"h2",children:"邀请好友"})]}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"邀请好友注册，双方均可获得Pro套餐"})]}),r&&(0,s.jsxs)(x.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(o.A,{sx:{bgcolor:"primary.light",color:"white"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(eg.A,{}),(0,s.jsx)(c.A,{variant:"h4",sx:{my:1},children:r.totalInvited}),(0,s.jsx)(c.A,{variant:"body2",children:"已邀请人数"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(o.A,{sx:{bgcolor:"success.light",color:"white"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(g.A,{}),(0,s.jsx)(c.A,{variant:"h4",sx:{my:1},children:r.totalAccepted}),(0,s.jsx)(c.A,{variant:"body2",children:"成功邀请"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(o.A,{sx:{bgcolor:"warning.light",color:"white"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(T.A,{}),(0,s.jsx)(c.A,{variant:"h4",sx:{my:1},children:r.totalTokensEarned}),(0,s.jsx)(c.A,{variant:"body2",children:"获得Token"})]})})})]}),(0,s.jsx)(l.A,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,s.jsxs)(K.A,{value:R,onChange:(e,n)=>P(n),children:[(0,s.jsx)(Z.A,{label:"我的邀请码"}),(0,s.jsx)(Z.A,{label:"使用邀请码"}),(0,s.jsx)(Z.A,{label:"邀请记录"})]})}),S&&(0,s.jsx)(a.A,{severity:"error",sx:{mb:2},onClose:()=>C(null),children:S}),I&&(0,s.jsx)(a.A,{severity:"success",sx:{mb:2},onClose:()=>D(null),children:I}),0===R&&(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"创建邀请码"}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"邀请好友注册，双方都将获得30天Pro套餐和100个Token"}),(null==e?void 0:e.status)==="ACTIVE"?(0,s.jsx)(o.A,{sx:{bgcolor:"success.lightest",p:3},children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h5",color:"success.main",gutterBottom:!0,children:e.code}),(0,s.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:["有效期至: ",e.expiresAt?(0,B.A)(new Date(e.expiresAt),"yyyy-MM-dd",{locale:U.A}):"永久"]})]}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(A.A,{title:V?"已复制":"复制邀请码",children:(0,s.jsx)(j.A,{onClick:()=>ea(e.code),color:V?"success":"primary",children:(0,s.jsx)(ek.A,{})})}),(0,s.jsx)(A.A,{title:"分享",children:(0,s.jsx)(j.A,{color:"primary",children:(0,s.jsx)(q.A,{})})})]})]})}):(0,s.jsx)(p.A,{variant:"contained",size:"large",onClick:X,disabled:u,startIcon:u?(0,s.jsx)(ep.A,{size:20}):(0,s.jsx)(eg.A,{}),sx:{minWidth:200},children:u?"创建中...":"生成邀请码"})]}),1===R&&(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"使用邀请码"}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",sx:{mb:2},children:"输入好友的邀请码，获得Pro套餐和奖励Token"}),(0,s.jsxs)(l.A,{sx:{display:"flex",gap:2,maxWidth:500},children:[(0,s.jsx)(ev.A,{fullWidth:!0,label:"邀请码",value:E,onChange:e=>L(e.target.value.toUpperCase()),placeholder:"请输入8位邀请码",inputProps:{maxLength:8,style:{textTransform:"uppercase"}}}),(0,s.jsx)(p.A,{variant:"contained",onClick:J,disabled:b||!E.trim(),sx:{minWidth:120},children:b?"使用中...":"使用"})]}),(0,s.jsxs)(l.A,{sx:{mt:3,p:2,bgcolor:"info.lightest",borderRadius:1},children:[(0,s.jsxs)(c.A,{variant:"h6",color:"info.main",gutterBottom:!0,children:[(0,s.jsx)(ef.A,{sx:{mr:1,verticalAlign:"middle"}}),"奖励内容"]}),(0,s.jsxs)("ul",{style:{margin:0,paddingLeft:20},children:[(0,s.jsx)("li",{children:"30天Pro套餐访问权限"}),(0,s.jsx)("li",{children:"100个奖励Token"}),(0,s.jsx)("li",{children:"所有Pro功能解锁"})]})]})]}),2===R&&r&&(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"邀请记录"}),r.recentInvitations.length>0?(0,s.jsx)($.A,{component:ee.A,children:(0,s.jsxs)(en.A,{children:[(0,s.jsx)(er.A,{children:(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:"邀请码"}),(0,s.jsx)(ei.A,{children:"状态"}),(0,s.jsx)(ei.A,{children:"奖励Token"}),(0,s.jsx)(ei.A,{children:"创建时间"}),(0,s.jsx)(ei.A,{children:"过期时间"})]})}),(0,s.jsx)(et.A,{children:r.recentInvitations.map(e=>(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:(0,s.jsx)(c.A,{variant:"body2",fontWeight:600,children:e.code})}),(0,s.jsx)(ei.A,{children:(0,s.jsx)(y.A,{icon:ec(e.status)||void 0,label:e.status,color:el(e.status),size:"small"})}),(0,s.jsx)(ei.A,{children:e.tokensReward}),(0,s.jsx)(ei.A,{children:(0,B.A)(new Date(e.createdAt),"yyyy-MM-dd HH:mm",{locale:U.A})}),(0,s.jsx)(ei.A,{children:e.expiresAt?(0,B.A)(new Date(e.expiresAt),"yyyy-MM-dd",{locale:U.A}):"永久"})]},e.id))})]})}):(0,s.jsx)(l.A,{sx:{textAlign:"center",py:4},children:(0,s.jsx)(c.A,{color:"textSecondary",children:"暂无邀请记录"})})]}),(0,s.jsxs)(M.A,{open:z,onClose:()=>W(!1),maxWidth:"sm",fullWidth:!0,children:[(0,s.jsxs)(N.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(w.A,{color:"success",sx:{fontSize:48,mb:1}}),(0,s.jsx)(c.A,{variant:"h4",children:"邀请成功！"})]}),(0,s.jsxs)(F.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(a.A,{severity:"success",sx:{mb:2},children:null==H?void 0:H.message}),(0,s.jsx)(c.A,{variant:"body1",color:"textSecondary",children:"Pro套餐已添加到您的账户"})]}),(0,s.jsx)(O.A,{sx:{justifyContent:"center"},children:(0,s.jsx)(p.A,{onClick:()=>W(!1),variant:"contained",children:"确定"})})]})]})})};var ew=r(61562),eC=r(62434);function eI(e){let{children:n,value:r,index:i}=e;return(0,s.jsx)("div",{hidden:r!==i,style:{height:r===i?"auto":0,overflow:"hidden"},children:n})}let eT=e=>{let{userId:n,onQuickRecharge:r}=e,[t,m]=(0,i.useState)(0),[u,v]=(0,i.useState)(null),[b,g]=(0,i.useState)(!0),[k,f]=(0,i.useState)(new Date),[w,C]=(0,i.useState)(!1),T=async()=>{try{g(!0);let e=await _.L.get("/user/usage-report",{userId:n});v(e)}catch(e){console.error("Failed to fetch usage data:",e),eu.oR.error("加载使用报告失败，请稍后重试")}finally{g(!1),f(new Date)}};(0,i.useEffect)(()=>{T();let e=setInterval(T,3e4);return()=>clearInterval(e)},[n]);let D=e=>new Intl.NumberFormat("zh-CN").format(e);return b&&!u?(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",py:4},children:(0,s.jsx)(c.A,{children:"加载使用报告中..."})})})}):u?(0,s.jsxs)(l.A,{children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,s.jsx)(c.A,{variant:"h6",children:"使用报告"}),(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsxs)(c.A,{variant:"caption",color:"textSecondary",children:["最后更新: ",(0,B.A)(k,"HH:mm:ss")]}),(0,s.jsx)(A.A,{title:"刷新数据",children:(0,s.jsx)(j.A,{size:"small",onClick:T,disabled:b,children:(0,s.jsx)(S.A,{})})})]})]}),(0,s.jsxs)(x.Ay,{container:!0,spacing:2,sx:{mb:3},children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",gutterBottom:!0,children:"本月使用"}),(0,s.jsx)(c.A,{variant:"h4",color:"primary",children:D(u.monthlyStats.totalTokensUsed)}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"Tokens"}),0!==u.monthlyStats.growthRate&&(0,s.jsx)(y.A,{icon:u.monthlyStats.growthRate>0?(0,s.jsx)(I.A,{}):(0,s.jsx)(eh.A,{}),label:"".concat(Math.abs(u.monthlyStats.growthRate),"%"),color:u.monthlyStats.growthRate>0?"success":"error",size:"small",sx:{mt:1}})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",gutterBottom:!0,children:"API调用"}),(0,s.jsx)(c.A,{variant:"h4",color:"info.main",children:D(u.monthlyStats.totalApiCalls)}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"本月总计"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",gutterBottom:!0,children:"日均使用"}),(0,s.jsx)(c.A,{variant:"h4",color:"warning.main",children:D(Math.round(u.monthlyStats.avgDailyUsage))}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"Tokens/天"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",gutterBottom:!0,children:"限流状态"}),(0,s.jsxs)(l.A,{sx:{position:"relative",mt:2},children:[(0,s.jsx)(h.A,{variant:"determinate",value:u.rateLimitStatus.percentage,color:(e=>e>=90?"error":e>=70?"warning":"success")(u.rateLimitStatus.percentage),sx:{height:8,borderRadius:4}}),(0,s.jsxs)(c.A,{variant:"body2",sx:{mt:1},children:[u.rateLimitStatus.currentUsage,"/",u.rateLimitStatus.limit]})]})]})})})]}),(0,s.jsx)(l.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,s.jsxs)(K.A,{value:t,onChange:(e,n)=>m(n),children:[(0,s.jsx)(Z.A,{label:"使用趋势",icon:(0,s.jsx)(ew.A,{})}),(0,s.jsx)(Z.A,{label:"Token分布",icon:(0,s.jsx)(eA.A,{})}),(0,s.jsx)(Z.A,{label:"详细记录"})]})}),(0,s.jsx)(eI,{value:t,index:0,children:(0,s.jsx)(o.A,{sx:{mt:2},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"近7天使用趋势"}),(0,s.jsx)(l.A,{sx:{height:200},children:(0,s.jsx)(x.Ay,{container:!0,spacing:1,sx:{height:"100%",alignItems:"flex-end"},children:u.dailyUsage.slice(-7).map((e,n)=>{let r=Math.max(...u.dailyUsage.map(e=>e.tokensUsed)),i=e.tokensUsed/r*150;return(0,s.jsxs)(x.Ay,{item:!0,xs:!0,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)(l.A,{sx:{width:"100%",height:"".concat(i,"px"),bgcolor:"primary.main",borderRadius:1,transition:"height 0.3s"}}),(0,s.jsx)(c.A,{variant:"caption",sx:{mt:1},children:(0,B.A)(new Date(e.date),"MM/dd")}),(0,s.jsx)(c.A,{variant:"caption",color:"textSecondary",children:e.tokensUsed})]},n)})})})]})})}),(0,s.jsx)(eI,{value:t,index:1,children:(0,s.jsx)(o.A,{sx:{mt:2},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Token类型分布"}),(0,s.jsxs)(x.Ay,{container:!0,spacing:2,children:[(0,s.jsxs)(x.Ay,{item:!0,xs:12,md:6,children:[(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,s.jsx)(c.A,{variant:"body2",children:"订阅Token"}),(0,s.jsx)(c.A,{variant:"body2",children:u.tokenDistribution.subscription})]}),(0,s.jsx)(h.A,{variant:"determinate",value:u.tokenDistribution.subscription/(u.tokenDistribution.subscription+u.tokenDistribution.activity+u.tokenDistribution.purchased)*100,sx:{height:8,borderRadius:4}})]}),(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,s.jsx)(c.A,{variant:"body2",children:"活动Token"}),(0,s.jsx)(c.A,{variant:"body2",children:u.tokenDistribution.activity})]}),(0,s.jsx)(h.A,{variant:"determinate",value:u.tokenDistribution.activity/(u.tokenDistribution.subscription+u.tokenDistribution.activity+u.tokenDistribution.purchased)*100,sx:{height:8,borderRadius:4},color:"success"})]}),(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,s.jsx)(c.A,{variant:"body2",children:"购买Token"}),(0,s.jsx)(c.A,{variant:"body2",children:u.tokenDistribution.purchased})]}),(0,s.jsx)(h.A,{variant:"determinate",value:u.tokenDistribution.purchased/(u.tokenDistribution.subscription+u.tokenDistribution.activity+u.tokenDistribution.purchased)*100,sx:{height:8,borderRadius:4},color:"warning"})]})]}),(0,s.jsx)(x.Ay,{item:!0,xs:12,md:6,children:(0,s.jsx)(o.A,{variant:"outlined",children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"使用建议"}),(0,s.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:[u.rateLimitStatus.percentage>=80&&(0,s.jsx)(a.A,{severity:"warning",sx:{mb:2},children:"您的API使用量已接近限制，建议升级套餐或购买更多Token"}),0===u.tokenDistribution.subscription&&(0,s.jsx)(a.A,{severity:"info",sx:{mb:2},children:"订阅Token可享受更优惠的价格，考虑订阅我们的套餐"}),"• 订阅Token优先使用，有效期与订阅同步",(0,s.jsx)("br",{}),"• 活动Token30天后过期，建议优先使用",(0,s.jsx)("br",{}),"• 购买Token永久有效，可长期保存"]})]})})})]})]})})}),(0,s.jsx)(eI,{value:t,index:2,children:(0,s.jsx)(o.A,{sx:{mt:2},children:(0,s.jsxs)(d.A,{children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,s.jsx)(c.A,{variant:"h6",children:"详细使用记录"}),(0,s.jsx)(p.A,{variant:"outlined",size:"small",onClick:()=>C(!0),children:"查看全部"})]}),(0,s.jsx)($.A,{component:ee.A,variant:"outlined",children:(0,s.jsxs)(en.A,{size:"small",children:[(0,s.jsx)(er.A,{children:(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:"时间"}),(0,s.jsx)(ei.A,{children:"类型"}),(0,s.jsx)(ei.A,{children:"Token消耗"}),(0,s.jsx)(ei.A,{children:"API调用"})]})}),(0,s.jsx)(et.A,{children:u.dailyUsage.slice(-5).reverse().map((e,n)=>(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:(0,B.A)(new Date(e.date),"MM/dd HH:mm")}),(0,s.jsx)(ei.A,{children:"API调用"}),(0,s.jsx)(ei.A,{children:e.tokensUsed}),(0,s.jsx)(ei.A,{children:e.apiCalls})]},n))})]})})]})})}),u.rateLimitStatus.percentage>=70&&(0,s.jsx)(o.A,{sx:{mt:3,bgcolor:"warning.light"},children:(0,s.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h6",color:"warning.dark",children:"Token余额不足"}),(0,s.jsxs)(c.A,{variant:"body2",color:"warning.dark",children:["您的使用量已达到",u.rateLimitStatus.percentage,"%，建议及时充值以避免服务中断"]})]}),(0,s.jsx)(p.A,{variant:"contained",color:"warning",startIcon:(0,s.jsx)(eC.A,{}),onClick:r,children:"快速充值"})]})}),(0,s.jsxs)(M.A,{open:w,onClose:()=>C(!1),maxWidth:"md",fullWidth:!0,children:[(0,s.jsx)(N.A,{children:"详细使用记录"}),(0,s.jsx)(F.A,{children:(0,s.jsx)($.A,{children:(0,s.jsxs)(en.A,{children:[(0,s.jsx)(er.A,{children:(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:"日期"}),(0,s.jsx)(ei.A,{children:"Token使用"}),(0,s.jsx)(ei.A,{children:"API调用"}),(0,s.jsx)(ei.A,{children:"占比"})]})}),(0,s.jsx)(et.A,{children:u.dailyUsage.map((e,n)=>{let r=u.monthlyStats.totalTokensUsed,i=r>0?(e.tokensUsed/r*100).toFixed(1):"0";return(0,s.jsxs)(es.A,{children:[(0,s.jsx)(ei.A,{children:(0,B.A)(new Date(e.date),"yyyy-MM-dd")}),(0,s.jsx)(ei.A,{children:D(e.tokensUsed)}),(0,s.jsx)(ei.A,{children:D(e.apiCalls)}),(0,s.jsx)(ei.A,{children:(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(h.A,{variant:"determinate",value:parseFloat(i),sx:{width:60,height:6}}),(0,s.jsxs)(c.A,{variant:"body2",children:[i,"%"]})]})})]},n)})})]})})}),(0,s.jsx)(O.A,{children:(0,s.jsx)(p.A,{onClick:()=>C(!1),children:"关闭"})})]})]}):(0,s.jsx)(o.A,{children:(0,s.jsx)(d.A,{children:(0,s.jsx)(c.A,{color:"error",children:"无法加载使用数据"})})})};var eD=r(4609),eR=r(70667),eP=r(24501),eE=r(42042),eB=r(18071),eL=r(79590),eU=r(7727),ez=r(8422);let eW=e=>{let{userId:n,currentBalance:r,onRechargeSuccess:t}=e,[h,A]=(0,i.useState)(!1),[j,m]=(0,i.useState)(null),[u,b]=(0,i.useState)("alipay"),[k,f]=(0,i.useState)(0),[S,w]=(0,i.useState)(!1),[C,I]=(0,i.useState)(""),[T,D]=(0,i.useState)(""),[R,P]=(0,i.useState)(""),[E,B]=(0,i.useState)(""),L=[{id:"starter",name:"入门包",tokens:1e3,price:9.9,bonus:0,description:"适合轻度用户"},{id:"standard",name:"标准包",tokens:5e3,price:39.9,bonus:500,popular:!0,description:"最受欢迎"},{id:"premium",name:"高级包",tokens:1e4,price:69.9,bonus:1500,description:"超值优惠"},{id:"enterprise",name:"企业包",tokens:5e4,price:299.9,bonus:1e4,description:"企业用户首选"}],U=()=>{A(!1),z()},z=()=>{f(0),m(null),b("alipay"),D(""),P(""),B(""),I("")},W=e=>{m(e),f(1)},q=()=>{let e=parseFloat(T),n=parseInt(R);return!e||e<1?void B("请输入有效的充值金额"):!n||n<100?void B("最少充值100个Token"):void(m({id:"custom",name:"自定义",tokens:n,price:e,bonus:0,description:"自定义充值"}),f(1))},H=async()=>{if(j){w(!0),B("");try{let e=await _.L.post("/payment/create-checkout-session",{userId:n,packageId:j.id,amount:j.price,tokens:j.tokens,bonus:j.bonus,paymentMethod:u});e.success?"alipay"===u||"wechat"===u?(I(e.paymentUrl||""),f(2)):Q():B(e.error||"创建支付订单失败")}catch(e){console.error("Payment error:",e),B("支付系统暂时不可用，请稍后重试")}finally{w(!1)}}},Q=()=>{f(3),t&&j&&t(j.tokens+j.bonus)};return(0,s.jsxs)(l.A,{children:[(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,s.jsx)(c.A,{variant:"h6",children:"快速充值"}),(0,s.jsx)(p.A,{variant:"contained",startIcon:(0,s.jsx)(eC.A,{}),onClick:()=>A(!0),children:"立即充值"})]}),(0,s.jsx)(x.Ay,{container:!0,spacing:2,children:L.slice(0,3).map(e=>(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(o.A,{variant:"outlined",sx:{height:"100%"},children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"subtitle1",children:e.name}),(0,s.jsxs)(c.A,{variant:"h5",color:"primary",sx:{my:1},children:["\xa5",e.price]}),(0,s.jsxs)(c.A,{variant:"body2",children:[e.tokens," Tokens"]}),e.bonus>0&&(0,s.jsx)(y.A,{label:"+".concat(e.bonus,"赠送"),color:"success",size:"small",sx:{mt:1}})]})})},e.id))}),(0,s.jsx)(l.A,{sx:{mt:2,p:2,bgcolor:"info.light",borderRadius:1},children:(0,s.jsxs)(c.A,{variant:"body2",color:"info.dark",children:[(0,s.jsx)(ez.A,{sx:{fontSize:16,mr:1,verticalAlign:"middle"}}),"充值说明：购买Token永久有效，支持随时退款未使用部分"]})})]})}),(0,s.jsxs)(M.A,{open:h,onClose:U,maxWidth:"md",fullWidth:!0,children:[(0,s.jsx)(N.A,{children:"Token充值"}),(0,s.jsxs)(F.A,{children:[(0,s.jsx)(eP.A,{activeStep:k,sx:{mb:4},children:["选择套餐","支付方式","确认支付","完成"].map((e,n)=>(0,s.jsx)(eE.A,{children:(0,s.jsx)(eB.A,{children:e})},e))}),(e=>{switch(e){case 0:return(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"选择充值套餐"}),(0,s.jsx)(x.Ay,{container:!0,spacing:2,children:L.map(e=>(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(o.A,{variant:(null==j?void 0:j.id)===e.id?"elevation":"outlined",sx:{cursor:"pointer",position:"relative",border:(null==j?void 0:j.id)===e.id?2:1,borderColor:(null==j?void 0:j.id)===e.id?"primary.main":"divider",transition:"all 0.3s","&:hover":{transform:"translateY(-2px)",boxShadow:2}},onClick:()=>W(e),children:[e.popular&&(0,s.jsx)(y.A,{label:"最受欢迎",color:"primary",size:"small",sx:{position:"absolute",top:8,right:8}}),(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",component:"div",children:e.name}),(0,s.jsxs)(c.A,{variant:"h4",color:"primary",sx:{my:1},children:["\xa5",e.price]}),(0,s.jsxs)(c.A,{variant:"body2",color:"textSecondary",children:[e.tokens," Tokens"]}),e.bonus>0&&(0,s.jsxs)(c.A,{variant:"body2",color:"success.main",sx:{mt:1},children:["+",e.bonus," 赠送"]}),(0,s.jsx)(c.A,{variant:"caption",color:"textSecondary",sx:{mt:1},children:e.description})]})]})},e.id))}),(0,s.jsx)(v.A,{sx:{my:3}}),(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"自定义充值"}),(0,s.jsxs)(x.Ay,{container:!0,spacing:2,children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsx)(ev.A,{fullWidth:!0,label:"充值金额 (\xa5)",type:"number",value:T,onChange:e=>D(e.target.value),inputProps:{min:1,step:.1}})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsx)(ev.A,{fullWidth:!0,label:"Token数量",type:"number",value:R,onChange:e=>P(e.target.value),inputProps:{min:100}})})]}),E&&(0,s.jsx)(a.A,{severity:"error",sx:{mt:2},children:E}),(0,s.jsx)(p.A,{variant:"outlined",fullWidth:!0,sx:{mt:2},onClick:q,children:"自定义充值"})]});case 1:return(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"选择支付方式"}),j&&(0,s.jsx)(o.A,{sx:{mb:3,bgcolor:"grey.50"},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"subtitle1",children:j.name}),(0,s.jsxs)(c.A,{variant:"h4",color:"primary",children:["\xa5",j.price]}),(0,s.jsxs)(c.A,{variant:"body2",children:[j.tokens," Tokens",j.bonus>0&&(0,s.jsxs)("span",{children:[" + ",j.bonus," 赠送"]})]})]})}),(0,s.jsx)(G.A,{component:"fieldset",fullWidth:!0,children:(0,s.jsxs)(eD.A,{value:u,onChange:e=>b(e.target.value),children:[(0,s.jsx)(o.A,{variant:"outlined",sx:{mb:2,cursor:"pointer"},children:(0,s.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,s.jsx)(eR.A,{value:"alipay"}),(0,s.jsx)(eL.A,{color:"primary"}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"subtitle1",children:"支付宝"}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"扫码支付，即时到账"})]})]})}),(0,s.jsx)(o.A,{variant:"outlined",sx:{cursor:"pointer"},children:(0,s.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,s.jsx)(eR.A,{value:"wechat"}),(0,s.jsx)(eU.A,{color:"primary"}),(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"subtitle1",children:"微信支付"}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"扫码支付，安全便捷"})]})]})})]})})]});case 2:return(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"扫码支付"}),C?(0,s.jsxs)(l.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(o.A,{sx:{maxWidth:300,mx:"auto",p:2},children:(0,s.jsxs)(d.A,{children:[(0,s.jsxs)(c.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:["请使用","alipay"===u?"支付宝":"微信","扫码支付"]}),(0,s.jsx)(l.A,{sx:{width:200,height:200,bgcolor:"grey.200",mx:"auto",my:2,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,s.jsx)(eU.A,{sx:{fontSize:80}})}),(0,s.jsxs)(c.A,{variant:"h6",color:"primary",children:["\xa5",null==j?void 0:j.price]})]})}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",sx:{mt:2},children:"支付完成后将自动到账，如有问题请联系客服"}),(0,s.jsx)(p.A,{variant:"contained",sx:{mt:3},onClick:Q,children:"模拟支付成功"})]}):(0,s.jsx)(ep.A,{})]});case 3:return(0,s.jsxs)(l.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(g.A,{sx:{fontSize:64,color:"success.main",mb:2}}),(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"充值成功！"}),(0,s.jsxs)(c.A,{variant:"body1",color:"textSecondary",children:["您已成功充值 ",null==j?void 0:j.tokens," Tokens",(null==j?void 0:j.bonus)&&(0,s.jsxs)("span",{children:[" + ",j.bonus," 赠送"]})]}),(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",sx:{mt:1},children:"Token已实时到账，祝您使用愉快！"})]});default:return null}})(k)]}),(0,s.jsxs)(O.A,{children:[k>0&&k<3&&(0,s.jsx)(p.A,{onClick:()=>f(k-1),children:"上一步"}),1===k&&(0,s.jsx)(p.A,{variant:"contained",onClick:H,disabled:S,children:S?(0,s.jsx)(ep.A,{size:24}):"确认支付"}),3===k&&(0,s.jsx)(p.A,{variant:"contained",onClick:U,children:"完成"})]})]})]})};var eM=r(30234),eN=r(15095),eF=r(78006),eO=r(61331),eq=r(29359);let eH=e=>{let{subscription:n}=e,[r,t]=i.useState(!1),x=(null==n?void 0:n.provider)==="system",A=n&&new Date>new Date(n.currentPeriodEnd),j=n?Math.ceil((new Date(n.currentPeriodEnd).getTime()-new Date().getTime())/864e5):0,m=x&&j<=3&&j>0,u=n?A?{label:"已过期",color:"error",icon:(0,s.jsx)(eO.A,{})}:x?{label:"试用中",color:"info",icon:(0,s.jsx)(g.A,{})}:{label:"订阅中",color:"success",icon:(0,s.jsx)(g.A,{})}:{label:"无订阅",color:"default",icon:(0,s.jsx)(eO.A,{})};return(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"订阅管理"}),n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.A,{sx:{mb:3},children:[(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,s.jsx)(y.A,{icon:u.icon,label:u.label,color:u.color,size:"small"}),x&&(0,s.jsx)(y.A,{label:"14天免费试用",color:"warning",size:"small"})]}),(0,s.jsx)(c.A,{variant:"h5",color:"primary",gutterBottom:!0,children:n.plan.name}),(0,s.jsx)(c.A,{variant:"body2",color:"text.secondary",children:n.plan.description})]}),(0,s.jsxs)(l.A,{sx:{mb:3},children:[(0,s.jsx)(c.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:x?"试用期":"订阅周期"}),(0,s.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,s.jsx)(f.A,{fontSize:"small"}),(0,s.jsxs)(c.A,{variant:"body2",children:[new Date(n.currentPeriodStart).toLocaleDateString()," - "," ",new Date(n.currentPeriodEnd).toLocaleDateString()]})]}),!A&&j>0&&(0,s.jsxs)(l.A,{sx:{mt:1},children:[(0,s.jsx)(c.A,{variant:"body2",color:m?"warning.main":"text.secondary",sx:{fontWeight:m?"bold":"normal"},children:x?"试用期剩余 ".concat(j," 天"):"剩余 ".concat(j," 天")}),(0,s.jsx)(h.A,{variant:"determinate",value:x?(14-j)/14*100:(30-j)/30*100,color:m?"warning":"primary",sx:{mt:1,height:6}}),x&&(0,s.jsx)(c.A,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:"试用期结束后将自动转为免费套餐"})]})]}),(0,s.jsxs)(l.A,{sx:{mb:3},children:[(0,s.jsx)(c.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Token 配额"}),(0,s.jsxs)(c.A,{variant:"h6",color:"primary",children:[n.plan.tokenQuota.toLocaleString()," tokens/月"]})]}),(0,s.jsx)(v.A,{sx:{my:2}}),(0,s.jsx)(c.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"功能权限"}),(0,s.jsx)(eF.A,{dense:!0,children:(()=>{var e,r,i,t;if(!(null==n?void 0:n.plan.features))return null;let a=n.plan.features,l=[];return(null==(e=a.siterank)?void 0:e.enabled)&&l.push((0,s.jsx)(eM.Ay,{children:(0,s.jsx)(eN.A,{primary:"网站排名分析",secondary:"批量查询上限: ".concat(a.siterank.maxQueriesPerBatch||100," 个域名")})},"siterank")),(null==(r=a.batchopen)?void 0:r.enabled)&&(l.push((0,s.jsx)(eM.Ay,{children:(0,s.jsx)(eN.A,{primary:"真实点击工具",secondary:"批量打开上限: ".concat(a.batchopen.maxUrlsPerBatch||200," 个URL")})},"batchopen")),(null==(t=a.batchopen)?void 0:t.proxyRotation)&&l.push((0,s.jsx)(eM.Ay,{children:(0,s.jsx)(eN.A,{primary:"代理轮换",secondary:"支持HTTP代理轮换"})},"proxy"))),(null==(i=a.adscenter)?void 0:i.enabled)&&l.push((0,s.jsx)(eM.Ay,{children:(0,s.jsx)(eN.A,{primary:"自动化广告",secondary:"管理账号上限: ".concat(a.adscenter.maxAccountsManaged||5," 个")})},"adscenter")),l})()}),A&&!x&&(0,s.jsx)(a.A,{severity:"warning",sx:{mb:2},children:"您的订阅已过期，请立即续费以继续使用服务"}),A&&x&&(0,s.jsx)(a.A,{severity:"info",sx:{mb:2},children:"您的试用期已结束，已自动转为免费套餐。升级到付费套餐以享受更多功能"}),x&&m&&(0,s.jsx)(a.A,{severity:"warning",sx:{mb:2},children:(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"body2",sx:{fontWeight:"bold",mb:1},children:"试用期即将结束！"}),(0,s.jsxs)(c.A,{variant:"body2",children:["您的14天Pro试用期还剩 ",j," 天。试用期结束后将自动转为免费套餐， 部分高级功能将不可用。立即升级以继续享受完整服务！"]})]})}),x&&j>3&&(0,s.jsx)(a.A,{severity:"info",sx:{mb:2},children:(0,s.jsxs)(l.A,{children:[(0,s.jsx)(c.A,{variant:"body2",sx:{fontWeight:"bold",mb:1},children:"正在享受Pro试用期"}),(0,s.jsxs)(c.A,{variant:"body2",children:["您正在使用14天Pro免费试用，可以体验所有高级功能。 试用期还剩 ",j," 天，随时可以升级到正式版本。"]})]})}),(0,s.jsxs)(l.A,{sx:{display:"flex",gap:2,mt:3},children:[(0,s.jsx)(p.A,{variant:"contained",startIcon:(0,s.jsx)(eq.A,{}),onClick:()=>{window.location.href="/pricing"},disabled:r,color:m?"warning":"primary",size:x?"large":"medium",children:x?m?"立即升级避免中断":"升级到正式版":"更改套餐"}),!x&&(0,s.jsx)(p.A,{variant:"outlined",onClick:()=>{window.location.href="/subscription/manage"},disabled:r,children:"管理订阅"}),x&&(0,s.jsx)(p.A,{variant:"outlined",onClick:()=>{window.open("/pricing#faq","_blank")},disabled:r,children:"了解试用详情"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.A,{severity:"info",sx:{mb:3},children:"您当前没有订阅任何套餐。选择一个套餐开始使用我们的服务。"}),(0,s.jsx)(p.A,{variant:"contained",size:"large",onClick:()=>{window.location.href="/pricing"},sx:{width:"100%"},children:"查看套餐"})]})]})})},e_=e=>{var n,r,h;let{user:A}=e,[j,m]=(0,i.useState)("dashboard"),[u,y]=(0,i.useState)((null==A?void 0:A.tokenBalance)||0);(0,i.useRef)({});let p=e=>e?new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"未知",v=e=>{switch(e){case"ACTIVE":return{text:"账户已激活",color:"success",icon:"✓",ariaLabel:"账户状态：已激活，正常使用中"};case"INACTIVE":return{text:"账户未激活",color:"warning",icon:"⚠",ariaLabel:"账户状态：未激活，需要激活后使用"};case"BANNED":return{text:"账户已禁用",color:"error",icon:"\uD83D\uDEAB",ariaLabel:"账户状态：已禁用，无法使用"};default:return{text:"未知状态",color:"default",icon:"?",ariaLabel:"账户状态：未知"}}};return A?(0,s.jsxs)(t.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,s.jsxs)(l.A,{sx:{mb:4},children:[(0,s.jsx)(c.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"个人中心"}),(0,s.jsxs)(c.A,{variant:"body1",color:"textSecondary",children:["欢迎回来，",A.name||A.email]})]}),(0,s.jsx)(o.A,{sx:{mb:4},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"个人信息"}),(0,s.jsxs)(x.Ay,{container:!0,spacing:3,children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"邮箱地址"}),(0,s.jsx)(c.A,{variant:"body1",children:A.email})]})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"注册时间"}),(0,s.jsx)(c.A,{variant:"body1",children:p(A.createdAt)})]})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"最后登录"}),(0,s.jsx)(c.A,{variant:"body1",children:p(A.lastLoginAt)})]})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(l.A,{sx:{mb:2},children:[(0,s.jsx)(c.A,{variant:"body2",color:"textSecondary",children:"账户状态"}),(0,s.jsxs)(c.A,{variant:"body1",sx:{color:v(A.status).color},children:["• ",v(A.status).text]})]})})]})]})}),(0,s.jsxs)(x.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",children:"总Token余额"}),(0,s.jsx)(c.A,{variant:"h4",color:"primary",children:(null==A?void 0:A.tokenBalance)||0})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",children:"订阅Token"}),(0,s.jsx)(c.A,{variant:"h4",color:"info.main",children:(null==A||null==(n=A.tokensBySource)?void 0:n.subscription)||0}),(0,s.jsx)(c.A,{variant:"caption",color:"text.secondary",children:"跟随订阅周期"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",children:"活动Token"}),(0,s.jsx)(c.A,{variant:"h4",color:"success.main",children:(null==A||null==(r=A.tokensBySource)?void 0:r.activity)||0}),(0,s.jsx)(c.A,{variant:"caption",color:"text.secondary",children:"永不过期"})]})})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(o.A,{children:(0,s.jsxs)(d.A,{sx:{textAlign:"center"},children:[(0,s.jsx)(c.A,{variant:"h6",color:"textSecondary",children:"购买Token"}),(0,s.jsx)(c.A,{variant:"h4",color:"warning.main",children:(null==A||null==(h=A.tokensBySource)?void 0:h.purchased)||0}),(0,s.jsx)(c.A,{variant:"caption",color:"text.secondary",children:"永不过期"})]})})})]}),(0,s.jsx)(o.A,{sx:{mb:2},children:(0,s.jsxs)(d.A,{sx:{display:"flex",flexWrap:"wrap",gap:2},children:[(0,s.jsx)(l.A,{sx:{px:3,py:1,borderRadius:1,cursor:"pointer",bgcolor:"dashboard"===j?"primary.main":"transparent",color:"dashboard"===j?"white":"text.primary","&:hover":{bgcolor:"dashboard"===j?"primary.dark":"action.hover"}},onClick:()=>m("dashboard"),children:"数据概览"}),(0,s.jsx)(l.A,{sx:{px:3,py:1,borderRadius:1,cursor:"pointer",bgcolor:"usage"===j?"primary.main":"transparent",color:"usage"===j?"white":"text.primary","&:hover":{bgcolor:"usage"===j?"primary.dark":"action.hover"}},onClick:()=>m("usage"),children:"使用报告"}),(0,s.jsx)(l.A,{sx:{px:3,py:1,borderRadius:1,cursor:"pointer",bgcolor:"recharge"===j?"primary.main":"transparent",color:"recharge"===j?"white":"text.primary","&:hover":{bgcolor:"recharge"===j?"primary.dark":"action.hover"}},onClick:()=>m("recharge"),children:"快速充值"}),(0,s.jsx)(l.A,{sx:{px:3,py:1,borderRadius:1,cursor:"pointer",bgcolor:"checkin"===j?"primary.main":"transparent",color:"checkin"===j?"white":"text.primary","&:hover":{bgcolor:"checkin"===j?"primary.dark":"action.hover"}},onClick:()=>m("checkin"),children:"每日签到"}),(0,s.jsx)(l.A,{sx:{px:3,py:1,borderRadius:1,cursor:"pointer",bgcolor:"transactions"===j?"primary.main":"transparent",color:"transactions"===j?"white":"text.primary","&:hover":{bgcolor:"transactions"===j?"primary.dark":"action.hover"}},onClick:()=>m("transactions"),children:"交易记录"}),(0,s.jsx)(l.A,{sx:{px:3,py:1,borderRadius:1,cursor:"pointer",bgcolor:"subscription"===j?"primary.main":"transparent",color:"subscription"===j?"white":"text.primary","&:hover":{bgcolor:"subscription"===j?"primary.dark":"action.hover"}},onClick:()=>m("subscription"),children:"订阅管理"}),(0,s.jsx)(l.A,{sx:{px:3,py:1,borderRadius:1,cursor:"pointer",bgcolor:"invitation"===j?"primary.main":"transparent",color:"invitation"===j?"white":"text.primary","&:hover":{bgcolor:"invitation"===j?"primary.dark":"action.hover"}},onClick:()=>m("invitation"),children:"邀请好友"})]})}),"dashboard"===j&&(0,s.jsxs)(x.Ay,{container:!0,spacing:3,children:[(0,s.jsx)(x.Ay,{item:!0,xs:12,md:8,children:(0,s.jsx)(eT,{userId:A.id,onQuickRecharge:()=>m("recharge")})}),(0,s.jsx)(x.Ay,{item:!0,xs:12,md:4,children:(0,s.jsx)(eW,{userId:A.id,currentBalance:u,onRechargeSuccess:e=>{y(n=>n+e)}})})]}),"usage"===j&&(0,s.jsx)(eT,{userId:A.id,onQuickRecharge:()=>m("recharge")}),"recharge"===j&&(0,s.jsx)(eW,{userId:A.id,currentBalance:u,onRechargeSuccess:e=>{y(n=>n+e)}}),"checkin"===j&&(0,s.jsx)(Q,{}),"transactions"===j&&(0,s.jsx)(ey,{}),"subscription"===j&&(0,s.jsx)(eH,{subscription:null==A?void 0:A.subscription}),"invitation"===j&&(0,s.jsx)(eS,{})]}):(0,s.jsx)(t.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:(0,s.jsx)(a.A,{severity:"error",role:"alert","aria-live":"assertive",children:"请先登录以访问个人中心"})})}},45460:(e,n,r)=>{Promise.resolve().then(r.bind(r,21948))}},e=>{var n=n=>e(e.s=n);e.O(0,[2076,4121,7358],()=>n(45460)),_N_E=e.O()}]);