(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7212],{1976:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>C});var i=a(54568),n=a(7620),l=a(58482),t=a(47227),c=a(63353),r=a(64148),d=a(62708),o=a(72825),x=a(17633),m=a(39756),h=a(29179),u=a(6541),g=a(93059),j=a(48474),p=a(84748),v=a(28359),f=a(65165),N=a(67474),A=a(3761),y=a(8039);function C(){let[e,s]=(0,n.useState)([]),[a,C]=(0,n.useState)(!0),[w,k]=(0,n.useState)(null),[b,I]=(0,n.useState)(!1),[L,E]=(0,n.useState)(!1),[$,D]=(0,n.useState)(!1),[J,M]=(0,n.useState)({name:"",environmentId:"",repeatCount:1,notificationEmail:"",originalLinks:[""],googleAdsAccounts:[{accountId:"",accountName:""}],adMappingConfig:[]});(0,n.useEffect)(()=>{S()},[]);let S=async()=>{try{C(!0);let e=await y.L.get("/adscenter/configurations"),a=(Array.isArray(e)?e:(null==e?void 0:e.data)||[]).map(e=>{let s=e.payload||{};return{id:e.id,name:e.name,environmentId:s.environmentId||"",repeatCount:s.repeatCount||1,notificationEmail:s.notificationEmail||"",originalLinks:Array.isArray(s.originalLinks)?s.originalLinks:[],googleAdsAccounts:Array.isArray(s.googleAdsAccounts)?s.googleAdsAccounts:[],adMappingConfig:Array.isArray(s.adMappingConfig)?s.adMappingConfig:[],status:e.status||"active",createdAt:e.createdAt||new Date().toISOString(),updatedAt:e.updatedAt||e.createdAt||new Date().toISOString(),lastExecuted:s.lastExecuted}});s(a)}catch(e){console.error("加载配置失败:",e)}finally{C(!1)}},z=async()=>{try{let e={environmentId:J.environmentId,repeatCount:J.repeatCount,notificationEmail:J.notificationEmail,originalLinks:J.originalLinks.filter(e=>e.trim()),googleAdsAccounts:J.googleAdsAccounts.filter(e=>e.accountId.trim()),adMappingConfig:J.originalLinks.filter(e=>e.trim()).map(e=>({originalUrl:e,adMappings:[]}))},s=await y.L.post("/adscenter/configurations",{name:J.name,description:"",payload:e});(null==s?void 0:s.success)===!1?alert("创建配置失败: "+((null==s?void 0:s.error)||"未知错误")):(I(!1),F(),S())}catch(e){console.error("创建配置失败:",e),alert("创建配置失败")}},G=async()=>{if(w)try{let e={environmentId:J.environmentId,repeatCount:J.repeatCount,notificationEmail:J.notificationEmail,originalLinks:J.originalLinks.filter(e=>e.trim()),googleAdsAccounts:J.googleAdsAccounts.filter(e=>e.accountId.trim()),adMappingConfig:J.originalLinks.filter(e=>e.trim()).map(e=>({originalUrl:e,adMappings:[]}))},s=await y.L.put("/adscenter/configurations/".concat(w.id),{name:J.name,payload:e});(null==s?void 0:s.success)===!1?alert("更新配置失败: "+((null==s?void 0:s.error)||"未知错误")):(E(!1),k(null),F(),S())}catch(e){console.error("更新配置失败:",e),alert("更新配置失败")}},O=async e=>{if(confirm("确定要删除这个配置吗？"))try{let s=await y.L.delete("/adscenter/configurations/".concat(e));(null==s?void 0:s.success)===!1?alert("删除配置失败: "+((null==s?void 0:s.error)||"未知错误")):S()}catch(e){console.error("删除配置失败:",e),alert("删除配置失败")}},_=async(e,s)=>{try{let a=await y.L.put("/adscenter/configurations/".concat(e),{status:s});(null==a?void 0:a.success)===!1?alert("更新状态失败: "+((null==a?void 0:a.error)||"未知错误")):S()}catch(e){console.error("更新状态失败:",e),alert("更新状态失败")}},B=async e=>{try{let s=await y.L.post("/adscenter/executions",{configurationId:e});(null==s?void 0:s.success)===!1?alert("启动执行失败: "+((null==s?void 0:s.error)||"未知错误")):alert("执行已启动")}catch(e){console.error("启动执行失败:",e),alert("启动执行失败")}},F=()=>{M({name:"",environmentId:"",repeatCount:1,notificationEmail:"",originalLinks:[""],googleAdsAccounts:[{accountId:"",accountName:""}],adMappingConfig:[]})},P=e=>{k(e),M({name:e.name,environmentId:e.environmentId,repeatCount:e.repeatCount,notificationEmail:e.notificationEmail||"",originalLinks:e.originalLinks.length>0?e.originalLinks:[""],googleAdsAccounts:e.googleAdsAccounts.length>0?e.googleAdsAccounts:[{accountId:"",accountName:""}],adMappingConfig:e.adMappingConfig||[]}),E(!0)},U=e=>{k(e),D(!0)},X=()=>{M(e=>({...e,originalLinks:[...e.originalLinks,""]}))},Z=e=>{M(s=>({...s,originalLinks:s.originalLinks.filter((s,a)=>a!==e)}))},W=(e,s)=>{M(a=>({...a,originalLinks:a.originalLinks.map((a,i)=>i===e?s:a)}))},R=()=>{M(e=>({...e,googleAdsAccounts:[...e.googleAdsAccounts,{accountId:"",accountName:""}]}))},T=e=>{M(s=>({...s,googleAdsAccounts:s.googleAdsAccounts.filter((s,a)=>a!==e)}))},V=(e,s,a)=>{M(i=>({...i,googleAdsAccounts:i.googleAdsAccounts.map((i,n)=>n===e?{...i,[s]:a}:i)}))},q=e=>(0,i.jsx)(r.E,{variant:{active:"default",paused:"secondary",stopped:"destructive"}[e]||"default",children:{active:"活跃",paused:"暂停",stopped:"停止"}[e]||e}),H=e=>{let{isEdit:s=!1}=e;return(0,i.jsxs)(A.tU,{defaultValue:"basic",className:"w-full",children:[(0,i.jsxs)(A.j7,{className:"grid w-full grid-cols-3",children:[(0,i.jsx)(A.Xi,{value:"basic",children:"基础配置"}),(0,i.jsx)(A.Xi,{value:"links",children:"链接管理"}),(0,i.jsx)(A.Xi,{value:"ads",children:"Google Ads"})]}),(0,i.jsxs)(A.av,{value:"basic",className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{htmlFor:"name",children:"配置名称"}),(0,i.jsx)(f.p,{id:"name",value:J.name,onChange:e=>M(s=>({...s,name:e.target.value})),placeholder:"输入配置名称"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{htmlFor:"environmentId",children:"AdsPower 环境ID"}),(0,i.jsx)(f.p,{id:"environmentId",value:J.environmentId,onChange:e=>M(s=>({...s,environmentId:e.target.value})),placeholder:"输入环境ID"})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{htmlFor:"repeatCount",children:"执行次数"}),(0,i.jsx)(f.p,{id:"repeatCount",type:"number",min:"1",max:"10",value:J.repeatCount,onChange:e=>M(s=>({...s,repeatCount:parseInt(e.target.value)||1}))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{htmlFor:"notificationEmail",children:"通知邮箱"}),(0,i.jsx)(f.p,{id:"notificationEmail",type:"email",value:J.notificationEmail,onChange:e=>M(s=>({...s,notificationEmail:e.target.value})),placeholder:"输入邮箱地址"})]})]})]}),(0,i.jsx)(A.av,{value:"links",className:"space-y-4",children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsx)(N.J,{children:"广告联盟链接"}),(0,i.jsxs)(t.$,{type:"button",variant:"outline",size:"sm",onClick:X,children:[(0,i.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"添加链接"]})]}),J.originalLinks.map((e,s)=>(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(f.p,{value:e,onChange:e=>W(s,e.target.value),placeholder:"输入广告联盟链接"}),J.originalLinks.length>1&&(0,i.jsx)(t.$,{type:"button",variant:"outline",size:"sm",onClick:()=>Z(s),children:(0,i.jsx)(o.A,{className:"h-4 w-4"})})]},s))]})}),(0,i.jsx)(A.av,{value:"ads",className:"space-y-4",children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsx)(N.J,{children:"Google Ads 账户"}),(0,i.jsxs)(t.$,{type:"button",variant:"outline",size:"sm",onClick:R,children:[(0,i.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"添加账户"]})]}),J.googleAdsAccounts.map((e,s)=>(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)(f.p,{value:e.accountId,onChange:e=>V(s,"accountId",e.target.value),placeholder:"账户ID"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(f.p,{value:e.accountName,onChange:e=>V(s,"accountName",e.target.value),placeholder:"账户名称"}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:['账号名称是您自定义的易于识别的名称，用于在多个账号间进行区分。例如："主账号"、"品牌推广账号"等。',(0,i.jsx)("br",{}),(0,i.jsx)("span",{className:"text-blue-600 font-medium",children:"提示："}),'这与"Login Customer ID (MCC ID)"不同 - MCC ID是Google Ads系统中管理多个客户账户的管理员账户标识符，而账号名称是您在AdsCenter系统中给这个管理员账户起的名字。']})]}),J.googleAdsAccounts.length>1&&(0,i.jsx)(t.$,{type:"button",variant:"outline",size:"sm",onClick:()=>T(s),children:(0,i.jsx)(o.A,{className:"h-4 w-4"})})]})]},s))]})})]})};return a?(0,i.jsx)("div",{className:"container mx-auto p-6",children:(0,i.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,i.jsx)("p",{children:"加载配置中..."})]})})}):(0,i.jsxs)("div",{className:"min-h-screen ".concat(l.B8.gradients.hero),children:[(0,i.jsx)("div",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-200",children:(0,i.jsx)("div",{className:"container mx-auto px-6 py-6",children:(0,i.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:(0,i.jsx)(x.A,{className:"h-6 w-6 text-white"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"配置管理"}),(0,i.jsx)("p",{className:"text-lg text-gray-600",children:"管理 AdsPower 环境和广告联盟链接配置"})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)(t.$,{variant:"outline",onClick:S,disabled:a,children:[(0,i.jsx)(m.A,{className:"h-4 w-4 ".concat(a?"animate-spin":"")}),"刷新"]}),(0,i.jsxs)(v.lG,{open:b,onOpenChange:I,children:[(0,i.jsx)(v.zM,{asChild:!0,children:(0,i.jsxs)(t.$,{onClick:()=>{F(),I(!0)},children:[(0,i.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"新建配置"]})}),(0,i.jsxs)(v.Cf,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,i.jsxs)(v.c7,{children:[(0,i.jsx)(v.L3,{children:"创建新配置"}),(0,i.jsx)(v.rr,{children:"配置 AdsPower 环境和广告联盟链接的自动化处理"})]}),(0,i.jsx)(H,{}),(0,i.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,i.jsx)(t.$,{variant:"outline",onClick:()=>I(!1),children:"取消"}),(0,i.jsx)(t.$,{onClick:z,children:"创建配置"})]})]})]})]})]})})}),(0,i.jsx)("div",{className:"container mx-auto px-6 py-8",children:0===e.length?(0,i.jsx)(c.Zp,{children:(0,i.jsxs)(c.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,i.jsx)(h.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium mb-2",children:"暂无配置"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"创建您的第一个配置来开始自动化流程"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)(t.$,{onClick:()=>I(!0),children:[(0,i.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"创建配置"]}),(0,i.jsxs)(t.$,{onClick:()=>window.location.href="/adscenter/setup",variant:"outline",children:[(0,i.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"使用设置向导"]})]})]})}):(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map(e=>(0,i.jsxs)(c.Zp,{className:l.B8.cards.featured+" hover:shadow-xl transition-all duration-300",children:[(0,i.jsx)(c.aR,{children:(0,i.jsxs)("div",{className:"flex justify-between items-start",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(c.ZB,{className:"text-lg",children:e.name}),(0,i.jsxs)(c.BT,{children:["环境ID: ",e.environmentId]})]}),q(e.status)]})}),(0,i.jsxs)(c.Wu,{children:[(0,i.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"执行次数:"}),(0,i.jsx)("span",{children:e.repeatCount})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"链接数量:"}),(0,i.jsx)("span",{children:e.originalLinks.length})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Google Ads账户:"}),(0,i.jsx)("span",{children:e.googleAdsAccounts.length})]}),e.lastExecuted&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"最后执行:"}),(0,i.jsx)("span",{children:new Date(e.lastExecuted).toLocaleDateString()})]})]}),(0,i.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,i.jsx)(t.$,{size:"sm",variant:"outline",onClick:()=>U(e),children:(0,i.jsx)(u.A,{className:"h-4 w-4"})}),(0,i.jsx)(t.$,{size:"sm",variant:"outline",onClick:()=>P(e),children:(0,i.jsx)(g.A,{className:"h-4 w-4"})}),(0,i.jsx)(t.$,{size:"sm",variant:"outline",onClick:()=>B(e.id),disabled:"active"!==e.status,children:(0,i.jsx)(j.A,{className:"h-4 w-4"})}),"active"===e.status?(0,i.jsx)(t.$,{size:"sm",variant:"outline",onClick:()=>_(e.id,"paused"),children:(0,i.jsx)(p.A,{className:"h-4 w-4"})}):(0,i.jsx)(t.$,{size:"sm",variant:"outline",onClick:()=>_(e.id,"active"),children:(0,i.jsx)(j.A,{className:"h-4 w-4"})}),(0,i.jsx)(t.$,{size:"sm",variant:"outline",onClick:()=>O(e.id),children:(0,i.jsx)(o.A,{className:"h-4 w-4"})})]})]})]},e.id))})}),(0,i.jsx)(v.lG,{open:L,onOpenChange:E,children:(0,i.jsxs)(v.Cf,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,i.jsxs)(v.c7,{children:[(0,i.jsx)(v.L3,{children:"编辑配置"}),(0,i.jsx)(v.rr,{children:"修改配置信息"})]}),(0,i.jsx)(H,{isEdit:!0}),(0,i.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,i.jsx)(t.$,{variant:"outline",onClick:()=>E(!1),children:"取消"}),(0,i.jsx)(t.$,{onClick:G,children:"保存更改"})]})]})}),(0,i.jsx)(v.lG,{open:$,onOpenChange:D,children:(0,i.jsxs)(v.Cf,{className:"max-w-2xl",children:[(0,i.jsx)(v.c7,{children:(0,i.jsx)(v.L3,{children:"配置详情"})}),w&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"配置名称"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:w.name})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"状态"}),(0,i.jsx)("div",{className:"mt-1",children:q(w.status)})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"环境ID"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:w.environmentId})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"执行次数"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:w.repeatCount})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"广告联盟链接"}),(0,i.jsx)("div",{className:"mt-1 space-y-1",children:w.originalLinks.map((e,s)=>(0,i.jsx)("p",{className:"text-sm text-gray-600 break-all",children:e},s))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"Google Ads 账户"}),(0,i.jsx)("div",{className:"mt-1 space-y-1",children:w.googleAdsAccounts.map((e,s)=>(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:[e.accountName," (",e.accountId,")"]},s))})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"创建时间"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:new Date(w.createdAt).toLocaleString()})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N.J,{children:"更新时间"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:new Date(w.updatedAt).toLocaleString()})]})]})]})]})})]})}},86105:(e,s,a)=>{Promise.resolve().then(a.bind(a,1976))}},e=>{var s=s=>e(e.s=s);e.O(0,[2076,4121,7358],()=>s(86105)),_N_E=e.O()}]);