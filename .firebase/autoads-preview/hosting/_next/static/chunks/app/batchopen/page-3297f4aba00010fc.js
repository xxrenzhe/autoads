(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7933],{60646:(e,t,s)=>{"use strict";s.d(t,{default:()=>ev});var a=s(54568),r=s(7620),n=s(2664),l=s(58482),o=s(63353);let i={blue:{from:"from-blue-500",to:"to-blue-600",icon:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200"},green:{from:"from-green-500",to:"to-green-600",icon:"text-green-600",bg:"bg-green-50",border:"border-green-200"},purple:{from:"from-purple-500",to:"to-purple-600",icon:"text-purple-600",bg:"bg-purple-50",border:"border-purple-200"},orange:{from:"from-orange-500",to:"to-orange-600",icon:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200"}},c=e=>{let{title:t,subtitle:s,steps:n,className:l="py-8 bg-gradient-to-br from-green-50 via-white to-blue-50",colorTheme:c="blue",layout:d="horizontal",showStepNumbers:p=!0}=e,u=i[c];return(0,a.jsx)("section",{className:l,children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl md:text-3xl font-bold text-slate-900 mb-3",children:t}),s&&(0,a.jsx)("p",{className:"text-base md:text-lg text-slate-600 max-w-4xl mx-auto",children:s})]}),(0,a.jsx)("div",{className:"max-w-6xl mx-auto grid ".concat("horizontal"===d?"grid-cols-1 lg:grid-cols-3":"grid-cols-1"," gap-6"),children:n.map(e=>(0,a.jsxs)(o.Zp,{className:"w-full p-4 hover:shadow-md transition-all duration-300 border-0 bg-white/95 backdrop-blur-sm hover:scale-[1.02]",children:[(0,a.jsxs)(o.aR,{className:"text-center pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[p&&(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br ".concat(u.from," ").concat(u.to," rounded-full flex items-center justify-center text-white font-bold text-sm shadow-lg"),children:e.number}),(0,a.jsx)("div",{className:u.icon,children:e.icon&&"object"==typeof e.icon&&"type"in e.icon&&r.cloneElement(e.icon,{className:"w-6 h-6"})})]}),(0,a.jsx)(o.ZB,{className:"text-lg font-semibold text-slate-900",children:e.title}),(0,a.jsx)(o.BT,{className:"text-slate-600 text-sm",children:e.description})]}),e.content&&(0,a.jsx)(o.Wu,{className:"pt-2",children:(0,a.jsx)("div",{className:"flex flex-col gap-2",children:e.content})})]},e.number))})]})})};var d=s(61866),p=s(69669),u=s(81673),m=s(14645),x=s(8039);function h(){let{isAuthenticated:e,user:t}=(0,m.Z)(),{requireAuth:s}=(0,m.N)();return{consumeTokens:async function(e,t,a){var r,n,l;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!s())return null==(r=o.onAuthRequired)||r.call(o),{success:!1,error:"Authentication required"};try{let s=e.toUpperCase();try{let e=await x.L.post("/user/tokens/consume",{feature:s,operation:t,tokens:a,itemCount:o.itemCount,description:o.description,metadata:o.metadata});if(!0!==e.success)return{success:!1,error:(null==e?void 0:e.error)||"Failed to consume tokens"};return{success:!0,remainingBalance:e.remainingBalance,consumed:e.consumed}}catch(e){if((null==e?void 0:e.status)===402)return null==(l=o.onInsufficientBalance)||l.call(o),{success:!1,error:"Insufficient token balance"};return{success:!1,error:(null==e||null==(n=e.details)?void 0:n.error)||"Failed to consume tokens"}}}catch(e){return console.error("Token consumption error:",e),{success:!1,error:"Network error"}}},hasEnoughTokens:e=>((null==t?void 0:t.tokenBalance)||0)>=e,getTokenBalance:()=>(null==t?void 0:t.tokenBalance)||0,isAuthenticated:e}}function g(e,t,s){if(!e||"function"!=typeof e)return console.warn("Translation function is not provided or not a function"),s||t;let a=e(t);return"string"==typeof a?a:Array.isArray(a)?a.join(", "):void 0===a?void 0!==s?s:t.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim():String(a)}class b{string(e,t){return g(this.t,e,t||this.fallback)}array(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e||"function"!=typeof e)return console.warn("Translation function is not provided or not a function"),s;let a=e(t);return Array.isArray(a)?a:"string"==typeof a?[a]:void 0===a?s:[String(a)]}(this.t,e,t)}number(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||"function"!=typeof e)return console.warn("Translation function is not provided or not a function"),s;let a=e(t);if("number"==typeof a)return a;if("string"==typeof a){let e=parseInt(a,10);return isNaN(e)?s:e}return s}(this.t,e,t)}boolean(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||"function"!=typeof e)return console.warn("Translation function is not provided or not a function"),s;let a=e(t);return"boolean"==typeof a?a:"string"==typeof a?"true"===a.toLowerCase()||"1"===a:s}(this.t,e,t)}withPrefix(e){return new b(t=>this.t("".concat(e,".").concat(t)),this.fallback)}constructor(e,t=""){_define_property(this,"t",void 0),_define_property(this,"fallback",void 0),this.t=e,this.fallback=t}}var y=s(42772);let f=(0,d.KV)("ErrorBoundary");class S extends r.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),f.error("ErrorBoundary捕获到错误:",new p.$W("ErrorBoundary捕获到错误:",{error:e.message,stack:e.stack,componentStack:t.componentStack})),this.props.onError&&this.props.onError(e,t)}componentDidUpdate(e){let{resetKeys:t,resetOnPropsChange:s}=this.props,{hasError:a}=this.state;a&&(s&&e!==this.props||t&&e.resetKeys!==t)&&this.resetErrorBoundary()}render(){let{hasError:e,error:t,errorInfo:s}=this.state,{children:r,fallback:n}=this.props;return e&&t?n?"function"==typeof n?n(t,s):n:(0,a.jsx)("div",{className:"min-h-[200px] flex items-center justify-center p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"⚠️"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"出现了一个错误"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:t.message}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:this.resetErrorBoundary,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"重试"}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"ml-2 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"刷新页面"})]}),!1]})}):r}constructor(e){super(e),(0,y._)(this,"resetErrorBoundary",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}}let N=(0,d.KV)("UrlInput"),j=e=>{var t;let{input:s,onInputChange:n,urls:l,isOpening:o,getTranslation:i,t:c}=e,d=(0,r.useCallback)(e=>e.split("\n").filter(e=>{let t=e.trim();return t&&(t.startsWith("http://")||t.startsWith("https://"))}),[]),p=(0,r.useCallback)(d,[]),u=(0,r.useMemo)(()=>(function(e,t){let s;return function(){for(var a=arguments.length,r=Array(a),n=0;n<a;n++)r[n]=arguments[n];clearTimeout(s),s=setTimeout(()=>e(...r),t)}})(e=>{let t=p(e);N.debug("解析URLs:",{inputLength:e.length,parsedCount:t.length})},300),[p]),m=(0,r.useCallback)(e=>{n(e),u(e)},[n,u]);return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:i(c,"batchopen.input.title")}),(0,a.jsx)("textarea",{value:s,onChange:e=>m(e.target.value),placeholder:i(c,"batchopen.input.placeholder"),className:"w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",disabled:o}),(0,a.jsx)("div",{className:"mt-1 text-xs text-gray-500",children:(null==(t=i(c,"batchopen.input.urlCount"))?void 0:t.replace("{count}",String(l.length)))||"已解析 ".concat(l.length," 个有效URL")})]})},T=e=>{let{cycleCountInput:t,cycleCount:s,isOpening:n,accessMode:l,proxyUrl:o,refererOption:i,customReferer:c,paramErrors:d,onCycleCountInputChange:p,onCycleCountChange:u,onAccessModeChange:m,getTranslation:x,t:h}=e,g=(0,r.useCallback)(e=>{(""===e||/^\d+$/.test(e))&&(p(e),""!==e.trim()&&u(Math.min(1e3,Math.max(1,parseInt(e)||5))))},[p,u]),b=(0,r.useCallback)(e=>{if(""===e.target.value.trim())p("5"),u(5);else{let t=Math.min(1e3,Math.max(1,parseInt(e.target.value)||5));p(t.toString()),u(t)}},[p,u]);return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"访问模式"}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"accessMode",value:"http",checked:"http"===l,onChange:e=>m(e.target.value),disabled:n,className:"mr-2"}),(0,a.jsx)("span",{className:"text-sm",children:"简单HTTP访问"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"accessMode",value:"puppeteer",checked:"puppeteer"===l,onChange:e=>m(e.target.value),disabled:n,className:"mr-2"}),(0,a.jsx)("span",{className:"text-sm",children:"高级浏览器访问"})]})]})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:x(h,"batchopen.advancedVersion.cycleCount")}),(0,a.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",className:"w-full border rounded px-2 py-1",placeholder:"1-1000",value:t,onChange:e=>g(e.target.value),onBlur:b,disabled:n}),d.cycleCount&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:d.cycleCount})]})})]})};var _=s(64303);let E=(0,d.KV)("ProxyConfig"),v=[{name:"Google",url:"https://www.google.com/"},{name:"Facebook",url:"https://www.facebook.com/"},{name:"YouTube",url:"https://www.youtube.com/"},{name:"WhatsApp",url:"https://www.whatsapp.com/"},{name:"Instagram",url:"https://www.instagram.com/"},{name:"TikTok",url:"https://www.tiktok.com/"},{name:"Messenger",url:"https://www.messenger.com/"},{name:"Telegram",url:"https://telegram.org/"},{name:"Snapchat",url:"https://www.snapchat.com/"},{name:"X (Twitter)",url:"https://x.com/"},{name:"LinkedIn",url:"https://www.linkedin.com/"},{name:"Pinterest",url:"https://www.pinterest.com/"},{name:"Reddit",url:"https://www.reddit.com/"},{name:"Quora",url:"https://www.quora.com/"},{name:"Tumblr",url:"https://www.tumblr.com/"},{name:"Twitch",url:"https://www.twitch.tv/"},{name:"Discord",url:"https://discord.com/"}];v[1];let R=e=>{let{proxyUrl:t,proxyValidationSuccess:s,isValidatingProxy:n,lastValidatedProxyUrl:l,refererOption:o,selectedSocialMedia:i,customReferer:c,requiredProxyCount:d,isOpening:p,paramErrors:u,onProxyUrlChange:m,onRefererOptionChange:x,onSelectedSocialMediaChange:h,onCustomRefererChange:g,onValidateProxy:b,setError:y,setStatus:f,setProxyValidationSuccess:S,setLastValidatedProxyUrl:N}=e,j=(0,r.useCallback)(e=>{try{return new URL(e).searchParams.get("proxyType")}catch(e){return null}},[]),T=(0,r.useCallback)(e=>{m(e),y(""),e.trim()!==l&&(E.info("URL已修改，重置验证状态"),S(!1))},[m,l,S,y]),R=(0,r.useCallback)(async()=>{if(!t.trim())return;let e=j(t);if("socks5"===e){y("❌ 静默版本不支持SOCKS5代理！请使用HTTP代理 (proxyType=http)。\n\n\uD83D\uDCA1 解决方案：\n1. 将URL中的 proxyType=socks5 改为 proxyType=http\n2. 或使用我们提供的SOCKS5转换工具"),S(!1);return}if("socks4"===e){y("❌ 静默版本不支持SOCKS4代理！请使用HTTP代理 (proxyType=http)。\n\n\uD83D\uDCA1 解决方案：\n1. 将URL中的 proxyType=socks4 改为 proxyType=http\n2. 或联系代理服务商获取HTTP代理接口"),S(!1);return}await b(t)},[t,b,y,j]);return(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"动态代理IP（URL）"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:t,onChange:e=>T(e.target.value),placeholder:"https://api.iprocket.io/api?username=xxx&password=xxx&cc=ROW&ips=1&type=-res-&proxyType=http&responseType=txt",className:"flex-1 p-2 border rounded-lg ".concat(s?"border-green-500 bg-green-50":"border-gray-300"),disabled:p}),(0,a.jsx)(_.L,{featureName:"batchopen",onClick:R,disabled:p||!t.trim()||n,className:"px-4 py-2 rounded-lg whitespace-nowrap flex items-center gap-2 ".concat(n?"bg-blue-400 cursor-not-allowed":s?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed"," text-white"),children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"验证中..."]}):s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"验证成功"]}):"验证代理"})]}),u.proxyUrl&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:u.proxyUrl}),s&&(0,a.jsx)("div",{className:"text-green-600 text-sm mt-1",children:(0,a.jsx)("p",{children:"✓ 代理URL验证通过，可以正常获取代理IP"})}),(0,a.jsx)("div",{className:"text-gray-500 mt-1",children:(0,a.jsx)("p",{className:"text-[11px]",children:"\uD83D\uDCA1 提示：仅支持HTTP/HTTPS代理，不支持SOCKS5代理"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"自定义Referer"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"social",checked:"social"===o,onChange:()=>x("social"),className:"mr-2",disabled:p}),(0,a.jsx)("span",{className:"text-sm",children:"社交媒体来源"})]}),"social"===o&&(0,a.jsxs)("div",{className:"ml-6 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm whitespace-nowrap",children:"社交媒体"}),(0,a.jsx)("select",{value:i,onChange:e=>h(e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg",disabled:p,children:v.map(e=>(0,a.jsx)("option",{value:e.url,children:e.name},e.url))})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"custom",checked:"custom"===o,onChange:()=>x("custom"),className:"mr-2",disabled:p}),(0,a.jsx)("span",{className:"text-sm",children:"自定义"})]})]}),"custom"===o&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("input",{type:"text",value:c,onChange:e=>g(e.target.value),placeholder:"请输入自定义Referer，例如：https://www.google.com/（留空则不发送Referer）",className:"w-full p-2 border border-gray-300 rounded-lg",disabled:p}),u.customReferer&&(0,a.jsx)("p",{className:"text-red-500 text-sm mt-1",children:u.customReferer}),(0,a.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"\uD83D\uDCA1 提示：留空则浏览器请求不会发送Referer头"})]})]})]})},w=(0,d.KV)("TaskControl"),O=e=>{let{urls:t,paramErrors:s,isOpening:n,isTaskRunning:o,isPolling:i,isValidatingProxy:c,isFetchingProxies:d,proxyValidationSuccess:p,error:u,onStartTask:m,onTerminateTask:x,getTranslation:h,t:g}=e,b=(0,r.useCallback)(()=>0===t.length||Object.keys(s).length>0||n||o||i||c||d||!p,[t,s,n,o,i,c,d,p]),y=(0,r.useCallback)(()=>!o&&!i,[o,i]),f=(0,r.useCallback)(()=>{w.info("启动任务按钮被点击",{urlsCount:t.length,hasErrors:Object.keys(s).length>0,proxyValidated:p}),m()},[m,t,s,p]),S=(0,r.useCallback)(()=>{w.info("终止任务按钮被点击",{isTaskRunning:o,isPolling:i}),x()},[x,o,i]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,a.jsx)(_.L,{featureName:"batchopen",onClick:f,className:"".concat(l.B8.buttons.primary," flex-1 disabled:opacity-50 disabled:cursor-not-allowed"),disabled:b(),children:h(g,"batchopen.btn.open")}),(0,a.jsx)("button",{onClick:S,className:"".concat(l.B8.buttons.secondary," flex-1 disabled:opacity-50 disabled:cursor-not-allowed"),disabled:y(),children:h(g,"batchopen.btn.terminate")})]}),u&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,a.jsx)("p",{className:"text-red-700",children:u})})]})},C=e=>{let{showProgress:t,taskId:s,progress:r,successCount:n,failCount:l,totalVisits:o,status:i,message:c,taskStartTime:d,taskEndTime:p}=e;if(!t)return null;let u="idle"!==i&&o>0,m=Math.max(0,o-n-l);return(0,a.jsxs)("div",{className:"w-full space-y-2 mt-6 mb-2 px-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"terminated"===i?"任务已终止":"completed"===i?"任务完成":"error"===i?"任务失败":c||"正在执行..."}),(0,a.jsx)("span",{className:"whitespace-nowrap",children:"".concat(n+l,"/").concat(o)})]}),u&&(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat("terminated"===i?"bg-yellow-600":"completed"===i||n+l>=o&&o>0?"bg-green-600":"error"===i?"bg-red-600":"bg-blue-600"),style:{width:"".concat(r,"%")}})}),(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 mt-3 text-center",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg px-2 py-2 border border-gray-100",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"总计"}),(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:o})]}),"completed"===i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg px-2 py-2 border border-blue-100 col-span-2",children:[(0,a.jsx)("div",{className:"text-xs text-blue-600 mb-1",children:"耗时"}),(0,a.jsx)("div",{className:"font-semibold text-blue-900",children:(()=>{let e=(e=>{let t=e.match(/耗时:\s*(\d+m)?\d+s/);return t?t[0].replace("耗时: ",""):null})(c);if(e)return e;if("completed"===i&&d&&p){let e=Math.floor((p-d)/1e3),t=Math.floor(e/60),s=e%60;return t>0?"".concat(t,"m").concat(s,"s"):"".concat(s,"s")}if(d){let e=Math.floor((Date.now()-d)/1e3),t=Math.floor(e/60),s=e%60;return t>0?"".concat(t,"m").concat(s,"s"):"".concat(s,"s")}return"0s"})()})]}),(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg px-2 py-2 border border-green-100",children:[(0,a.jsx)("div",{className:"text-xs text-green-600 mb-1",children:"成功"}),(0,a.jsx)("div",{className:"font-semibold text-green-900",children:n})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg px-2 py-2 border border-gray-100",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"完成"}),(0,a.jsxs)("div",{className:"font-semibold text-gray-900",children:[o>0?Math.round((n+l)/o*100):0,"%"]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg px-2 py-2 border border-green-100",children:[(0,a.jsx)("div",{className:"text-xs text-green-600 mb-1",children:"成功"}),(0,a.jsx)("div",{className:"font-semibold text-green-900",children:n})]}),(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg px-2 py-2 border border-red-100",children:[(0,a.jsx)("div",{className:"text-xs text-red-600 mb-1",children:"失败"}),(0,a.jsx)("div",{className:"font-semibold text-red-900",children:l})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 rounded-lg px-2 py-2 border border-yellow-100",children:[(0,a.jsx)("div",{className:"text-xs text-yellow-600 mb-1",children:"处理中"}),(0,a.jsx)("div",{className:"font-semibold text-yellow-900",children:m})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg px-2 py-2 border border-blue-100",children:[(0,a.jsx)("div",{className:"text-xs text-blue-600 mb-1",children:"成功率"}),(0,a.jsxs)("div",{className:"font-semibold text-blue-900",children:[o>0?Math.round(n/o*100):0,"%"]})]})]})]}),s&&!1]})};var I=s(31637);let A={ALLOWED_TAGS:["p","br","strong","b","em","i","u","span","div","h1","h2","h3","h4","h5","h6","ul","ol","li","a","code","pre"],ALLOWED_ATTR:["href","target","rel","class","id"],FORBID_TAGS:["script","object","embed","form","input","textarea","select"],FORBID_ATTR:["onclick","onload","onerror","onmouseover","onfocus","onblur"]},k=e=>{let{html:t,mode:s="html",sanitizeOptions:r,className:n,as:l="div",...o}=e,i=(()=>{if(!t||"string"!=typeof t)return"";switch(s){case"i18n":return function(e){return e&&"string"==typeof e?I.A.sanitize(e,{ALLOWED_TAGS:["strong","b","em","i","u","br","span","code","a","div"],ALLOWED_ATTR:["class","href","target","rel"],KEEP_CONTENT:!0}):""}(t);case"user-input":return function(e){return e&&"string"==typeof e?I.A.sanitize(e,{ALLOWED_TAGS:[],ALLOWED_ATTR:[],KEEP_CONTENT:!0}):""}(t);default:return function(e,t){if(!e||"string"!=typeof e)return"";let s={...A,...t};return I.A.sanitize(e,{ALLOWED_TAGS:s.ALLOWED_TAGS,ALLOWED_ATTR:s.ALLOWED_ATTR,FORBID_TAGS:s.FORBID_TAGS,FORBID_ATTR:s.FORBID_ATTR,KEEP_CONTENT:!0})}(t,r?{ALLOWED_TAGS:r.allowedTags,ALLOWED_ATTR:r.allowedAttributes,FORBID_TAGS:r.forbiddenTags,FORBID_ATTR:r.forbiddenAttributes}:void 0)}})();return(0,a.jsx)(l,{className:n,dangerouslySetInnerHTML:{__html:i},...o})},P=e=>(0,a.jsx)(k,{...e,mode:"i18n"}),L=(0,d.KV)("FeatureDescription"),U=e=>{let{getTranslation:t,t:s}=e;return L.debug("FeatureDescription组件渲染"),(0,a.jsxs)("div",{className:"flex-1 min-w-0 flex flex-col",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-6 text-slate-900 border-b border-slate-200 pb-2",children:t(s,"batchOpenSection.silentVersion.title")}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsx)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-purple-600 text-base",children:"\uD83E\uDD16"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-purple-900 text-base mb-2",children:t(s,"batchOpenSection.featureDescription.featuresTitle")}),(0,a.jsx)("div",{className:"text-purple-800 text-sm leading-relaxed",children:(0,a.jsx)(P,{html:t(s,"batchOpenSection.silentVersion.tip"),as:"p"})})]})]})}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-blue-900 text-base mb-3 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-blue-600",children:"⚙️"}),t(s,"batchOpenSection.featureDescription.technicalTitle")]}),(0,a.jsx)("ul",{className:"list-disc list-inside text-blue-800 text-sm leading-relaxed space-y-2",children:s("batchOpenSection.featureDescription.technicalFeatures").map((e,t)=>(0,a.jsx)("li",{children:e},t))})]}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-red-900 text-base mb-3 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-red-600",children:"⚠️"}),t(s,"batchOpenSection.featureDescription.notesTitle")]}),(0,a.jsx)("ul",{className:"list-disc list-inside text-red-800 text-sm leading-relaxed space-y-2",children:s("batchOpenSection.featureDescription.notes").map((e,t)=>(0,a.jsx)("li",{children:e},t))})]})]})]})};var D=s(40459);let M=(e,t)=>{let s;return function(){for(var a=arguments.length,r=Array(a),n=0;n<a;n++)r[n]=arguments[n];clearTimeout(s),s=setTimeout(()=>e(...r),t)}},V=(0,d.KV)("SilentBatchOpen"),G={"batchopen.basicVersion.title":"初级版本","batchopen.advancedVersion.title":"高级版本","batchopen.silentVersion.title":"静默版本","batchopen.title":"批量打开URL","batchopen.desc":"后台批量访问URL，动态代理IP，自定义Referer","batchopen.advancedVersion.cycleCount":"每个URL访问次数","batchopen.input.title":"输入URL","batchopen.input.description":"请输入要打开的URL，每行一个","batchopen.input.placeholder":"请输入要批量打开的URL，每行一个...","batchopen.input.urlCount":"已解析 {count} 个有效URL","batchopen.btn.opening":"正在打开...","batchopen.btn.open":"批量打开","batchopen.btn.terminate":"终止","batchopen.status.popup_blocked_tip":"弹窗被阻止！请允许弹窗后重试","batchopen.status.opening":"正在打开...","batchopen.status.popup_blocked":"弹窗被阻止","batchopen.status.success":"成功打开{count}个URL","batchopen.status.terminated":"正在终止批量打开...","batchopen.error.no_urls":"请输入至少一个URL","batchopen.error.invalid_cycle_count":"每个URL打开次数必须在1-1000之间","batchopen.error.invalid_open_count":"打开次数必须在1-1000之间","batchOpenSection.silentVersion.title":"静默版本说明","batchOpenSection.silentVersion.tip":"无需安装任何插件，通过后端Chromium浏览器实现真实的浏览器访问，支持代理IP、自定义Referer等功能","batchOpenSection.featureDescription.featuresTitle":"功能说明","batchOpenSection.featureDescription.technicalTitle":"技术特点","batchOpenSection.featureDescription.notesTitle":"注意事项","batchopen.pluginDetection.title":"插件检测","batchopen.pluginDetection.detected":"已检测到 Background Open 插件","batchopen.pluginDetection.notDetected":"未检测到 Background Open 插件","batchopen.pluginDetection.tip":"使用高级版本需要安装插件","batchopen.pluginDetection.installLink":"点击安装","batchopen.pluginDetection.installing":"安装中...","batchopen.pluginDetection.installed":"已安装"},B=(e,t)=>g(e,t,G[t]),F={input:"",urls:[],progress:0,successCount:0,failCount:0,pendingCount:0,status:"",error:"",isOpening:!1,isTaskRunning:!1,isPolling:!1,showProgress:!1,hasTaskRun:!1,cycleCount:5,cycleCountInput:"5",accessMode:"http",proxyUrl:"",refererOption:"social",selectedSocialMedia:"https://www.facebook.com/",customReferer:"",taskId:null,isValidatingProxy:!1,proxyValidationSuccess:!1,lastValidatedProxyUrl:null,isFetchingProxies:!1,requiredProxyCount:0,totalVisits:0,taskStartTime:null,taskEndTime:null,paramErrors:{},proxyPhase:void 0,proxyStats:void 0,validationConfig:null,phaseStatus:void 0,completedPhases:void 0,phaseProgress:void 0};function K(e,t){switch(t.type){case"SET_INPUT":return{...e,input:t.payload};case"SET_URLS":return{...e,urls:t.payload};case"SET_PROGRESS":return{...e,progress:t.payload};case"SET_SUCCESS_COUNT":return{...e,successCount:t.payload};case"SET_FAIL_COUNT":return{...e,failCount:t.payload};case"SET_PENDING_COUNT":return{...e,pendingCount:t.payload};case"SET_STATUS":return{...e,status:t.payload};case"SET_ERROR":return{...e,error:t.payload};case"SET_IS_OPENING":return{...e,isOpening:t.payload};case"SET_IS_TASK_RUNNING":return{...e,isTaskRunning:t.payload};case"SET_IS_POLLING":return{...e,isPolling:t.payload};case"SET_SHOW_PROGRESS":return{...e,showProgress:t.payload};case"SET_HAS_TASK_RUN":return{...e,hasTaskRun:t.payload};case"SET_CYCLE_COUNT":return{...e,cycleCount:t.payload};case"SET_CYCLE_COUNT_INPUT":return{...e,cycleCountInput:t.payload};case"SET_ACCESS_MODE":return V.info("SET_ACCESS_MODE action:",{from:e.accessMode,to:t.payload}),{...e,accessMode:t.payload};case"SET_PROXY_URL":return{...e,proxyUrl:t.payload};case"SET_REFERER_OPTION":return{...e,refererOption:t.payload};case"SET_SELECTED_SOCIAL_MEDIA":return{...e,selectedSocialMedia:t.payload};case"SET_CUSTOM_REFERER":return{...e,customReferer:t.payload};case"SET_TASK_ID":return{...e,taskId:t.payload};case"SET_IS_VALIDATING_PROXY":return{...e,isValidatingProxy:t.payload};case"SET_PROXY_VALIDATION_SUCCESS":return{...e,proxyValidationSuccess:t.payload};case"SET_LAST_VALIDATED_PROXY_URL":return{...e,lastValidatedProxyUrl:t.payload};case"SET_IS_FETCHING_PROXIES":return{...e,isFetchingProxies:t.payload};case"SET_REQUIRED_PROXY_COUNT":return{...e,requiredProxyCount:t.payload};case"SET_TOTAL_VISITS":return{...e,totalVisits:t.payload};case"SET_TASK_START_TIME":return{...e,taskStartTime:t.payload};case"SET_TASK_END_TIME":return{...e,taskEndTime:t.payload};case"SET_PARAM_ERRORS":return{...e,paramErrors:t.payload};case"SET_PROXY_PHASE":return{...e,proxyPhase:t.payload};case"SET_PROXY_STATS":return{...e,proxyStats:t.payload};case"SET_VALIDATION_CONFIG":return{...e,validationConfig:t.payload};case"SET_PHASE_STATUS":return{...e,phaseStatus:t.payload};case"SET_COMPLETED_PHASES":return{...e,completedPhases:t.payload};case"SET_PHASE_PROGRESS":return{...e,phaseProgress:t.payload};case"RESET_PROGRESS":return{...e,progress:0,successCount:0,failCount:0,pendingCount:0,status:"",error:"",proxyPhase:void 0,phaseStatus:void 0,completedPhases:void 0,phaseProgress:void 0};case"RESET_FOR_NEW_TASK":return{...e,progress:0,successCount:0,failCount:0,pendingCount:0,status:"",error:"",taskId:null,isPolling:!1,urls:[],proxyPhase:void 0,phaseStatus:void 0,completedPhases:void 0,phaseProgress:void 0,taskStartTime:null,taskEndTime:null};case"UPDATE_FROM_PROGRESS_DATA":let{progress:s,successCount:a,failCount:r,message:n,status:l}=t.payload,o=n||"正在处理...",i=(e=>{let t=e.toLowerCase();return t.includes("代理验证")||t.includes("验证代理")?"proxy-validation":t.includes("代理ip获取")||t.includes("获取代理")?"proxy-acquisition":t.includes("代理分配")||t.includes("分配代理")?"proxy-distribution":t.includes("代理缓存")||t.includes("缓存代理")?"proxy-caching":t.includes("代理补充")||t.includes("补充代理")?"proxy-replenishment":t.includes("批量访问")||t.includes("正在访问")?"batch-execution":"unknown"})(o),c=(e=>{let t={},s=e.match(/(\d+)\s*个?\s*代理/);s&&(t.currentProxyCount=parseInt(s[1]));let a=e.match(/\((\d+)\/(\d+)\)/);return a&&(t.currentCount=parseInt(a[1]),t.targetCount=parseInt(a[2]),t.acquisitionProgress=Math.round(t.currentCount/t.targetCount*100)),e.includes("缓存")?t.source="cache":e.includes("批量")?t.source="batch":e.includes("个别")&&(t.source="individual"),e.includes("智能")||e.includes("优化")?t.strategy="optimized":e.includes("FIFO")||e.includes("先进先出")?t.strategy="fifo":e.includes("轮询")&&(t.strategy="round-robin"),(e.includes("不足")||e.includes("shortage"))&&(t.hasShortage=!0),(e.includes("降级")||e.includes("fallback"))&&(t.usingFallback=!0),Object.keys(t).length>0?t:void 0})(o);return{...e,progress:Math.max(1,s||0),successCount:a||0,failCount:r||0,status:o,isFetchingProxies:o&&(o.includes("正在获取代理IP")||o.includes("正在准备获取代理IP")),proxyPhase:i,proxyStats:c?{...e.proxyStats,...c}:e.proxyStats,..."completed"===l&&{status:"批量访问完成！",isPolling:!1,isOpening:!1,isTaskRunning:!1,isFetchingProxies:!1,taskId:null,progress:100,showProgress:!0,hasTaskRun:!0},..."error"===l&&{error:n,isPolling:!1,isOpening:!1,isTaskRunning:!1,isFetchingProxies:!1,taskId:null,showProgress:!0,hasTaskRun:!0},..."failed"===l&&{error:n,isPolling:!1,isOpening:!1,isTaskRunning:!1,isFetchingProxies:!1,taskId:null,showProgress:!0,hasTaskRun:!0},..."terminated"===l&&{status:"任务已终止",isPolling:!1,isOpening:!1,isTaskRunning:!1,isFetchingProxies:!1,taskId:null,showProgress:!0,hasTaskRun:!0}};default:return e}}let H=r.memo(e=>{let{t:t,locale:s,isLoading:o}=(0,n.o)(),i=o?e.t:t;o&&e.locale;let[c,d]=(0,r.useReducer)(K,F),{consumeTokens:m}=h(),[x,g]=(0,r.useState)(!1),[b,y]=(0,r.useState)(void 0),[f,N]=(0,r.useState)(void 0),{input:_,urls:E,progress:v,successCount:w,failCount:I,status:A,error:k,isOpening:P,isTaskRunning:L,isPolling:G,showProgress:H,hasTaskRun:W,cycleCount:X,cycleCountInput:Y,accessMode:q,proxyUrl:z,refererOption:$,selectedSocialMedia:J,customReferer:Q,taskId:Z,isValidatingProxy:ee,proxyValidationSuccess:et,lastValidatedProxyUrl:es,isFetchingProxies:ea,requiredProxyCount:er,totalVisits:en,taskStartTime:el,taskEndTime:eo,paramErrors:ei,proxyPhase:ec,proxyStats:ed,validationConfig:ep,phaseStatus:eu,completedPhases:em,phaseProgress:ex}=c,eh=(0,r.useRef)(q);(0,r.useEffect)(()=>{eh.current=q},[q]);let eg=(0,r.useCallback)(async()=>{if(0===E.length)return;let e=parseInt(Y)||5,t=E.length*e;V.info("代理需求计算完成:",{urls:E.length,cycleCount:e,totalVisits:t,requiredProxies:e}),d({type:"SET_REQUIRED_PROXY_COUNT",payload:e}),d({type:"SET_TOTAL_VISITS",payload:t})},[E.length,Y]);(0,r.useEffect)(()=>{eg()},[eg]);let eb=(0,r.useRef)(!1),ey=(0,r.useRef)(null),ef=(0,r.useCallback)(()=>{let e={},t=parseInt(Y)||5;return(t<1||t>1e3)&&(e.cycleCount="每个URL打开次数必须在1-1000之间"),z.trim()&&(z.startsWith("http")||(e.proxyUrl="代理API地址必须以http开头")),"custom"===$&&Q.trim()&&(Q.trim().startsWith("http://")||Q.trim().startsWith("https://")?Q.trim().match(/^https?:\/\/[^\s/$.?#].[^\s]*$/i)||(e.customReferer="请输入有效的URL格式"):e.customReferer="自定义Referer必须以http://或https://开头"),d({type:"SET_PARAM_ERRORS",payload:e}),0===Object.keys(e).length},[Y,z,$,Q]),eS=(0,r.useCallback)(e=>e.split("\n").filter(e=>{let t=e.trim();return t&&(t.startsWith("http://")||t.startsWith("https://"))}),[]),eN=(0,r.useCallback)(eS,[]),ej=(0,r.useMemo)(()=>M(e=>{d({type:"SET_URLS",payload:eN(e)})},300),[eN]);(0,r.useEffect)(()=>{ej(_)},[_,ej]);let eT=(0,r.useCallback)(async e=>{if(V.info("validateProxyUrl 被调用:",{url:e,currentProxyUrl:z,proxyValidationSuccess:et,lastValidatedProxyUrl:es,validationEnabled:null==ep?void 0:ep.enabled}),!e||!e.trim())return d({type:"SET_ERROR",payload:""}),d({type:"SET_PROXY_VALIDATION_SUCCESS",payload:!1}),d({type:"SET_LAST_VALIDATED_PROXY_URL",payload:null}),!1;if(ep&&!ep.enabled)return V.info("代理验证已禁用，跳过验证"),d({type:"SET_PROXY_VALIDATION_SUCCESS",payload:!0}),d({type:"SET_LAST_VALIDATED_PROXY_URL",payload:e.trim()}),d({type:"SET_ERROR",payload:""}),!0;if(et&&es===e.trim())return V.info("URL已验证过，跳过重复验证"),!0;d({type:"SET_IS_VALIDATING_PROXY",payload:!0}),d({type:"SET_PROXY_VALIDATION_SUCCESS",payload:!1}),d({type:"SET_ERROR",payload:""}),d({type:"SET_STATUS",payload:"正在验证代理URL..."});try{let t=new AbortController,s=setTimeout(()=>t.abort(),15e3),a=await fetch("/api/batchopen/proxy-url-validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({proxyUrl:e.trim()}),signal:t.signal});clearTimeout(s);let r=await a.json();if(a.ok&&((null==r?void 0:r.valid)===!0||(null==r?void 0:r.success)===!0))return V.info("代理URL验证成功:",(null==r?void 0:r.normalized)||(null==r?void 0:r.proxy)),d({type:"SET_STATUS",payload:"代理URL格式正确，成功获取代理IP！"}),d({type:"SET_PROXY_VALIDATION_SUCCESS",payload:!0}),d({type:"SET_LAST_VALIDATED_PROXY_URL",payload:e.trim()}),setTimeout(()=>d({type:"SET_STATUS",payload:""}),3e3),!0;{let e="代理URL验证失败：".concat((null==r?void 0:r.message)||"无效的代理地址");return d({type:"SET_ERROR",payload:e}),d({type:"SET_PROXY_VALIDATION_SUCCESS",payload:!1}),d({type:"SET_LAST_VALIDATED_PROXY_URL",payload:null}),!1}}catch(e){return V.error("验证代理URL时发生错误:",new p.$W("验证代理URL时发生错误:",{error:e instanceof Error?e.message:String(e)})),e instanceof Error&&"AbortError"===e.name?d({type:"SET_ERROR",payload:"代理URL验证超时，请检查网络连接或稍后重试"}):d({type:"SET_ERROR",payload:"代理URL验证网络错误，请检查网络连接"}),d({type:"SET_PROXY_VALIDATION_SUCCESS",payload:!1}),d({type:"SET_LAST_VALIDATED_PROXY_URL",payload:null}),!1}finally{d({type:"SET_IS_VALIDATING_PROXY",payload:!1})}},[es,et,ep]),e_=(0,r.useCallback)(async()=>{W&&(d({type:"SET_PROGRESS",payload:0}),d({type:"SET_SUCCESS_COUNT",payload:0}),d({type:"SET_FAIL_COUNT",payload:0}),d({type:"SET_STATUS",payload:""}),d({type:"SET_ERROR",payload:""}),d({type:"SET_TASK_ID",payload:null}),d({type:"SET_IS_POLLING",payload:!1}),d({type:"SET_TASK_START_TIME",payload:null}),d({type:"SET_TASK_END_TIME",payload:null})),d({type:"SET_SHOW_PROGRESS",payload:!0}),d({type:"SET_HAS_TASK_RUN",payload:!0}),d({type:"SET_TASK_START_TIME",payload:Date.now()});let e=parseInt(Y)||5,t=eh.current;if(V.info("使用当前参数启动任务:",{cycleCount:e,proxyUrl:z,refererOption:$,accessMode:t,accessModeSource:eh.current===t?"ref":"state"}),!ef())return;let s=eS(_);if(0===s.length)return void d({type:"SET_ERROR",payload:"请输入至少一个URL"});if(V.info("startBatchOpen - 当前验证状态:",{proxyValidationSuccess:et,proxyUrl:z,lastValidationTime:"N/A"}),!et)if(!ep||ep.enabled)return void(z.trim()?d({type:"SET_ERROR",payload:"代理验证失败，请先验证代理配置"}):d({type:"SET_ERROR",payload:"请先配置代理API地址并验证"}));else V.info("代理验证已禁用，允许启动任务");V.info("代理已验证，正在启动批量打开..."),d({type:"SET_STATUS",payload:"代理已验证，正在启动批量打开..."}),d({type:"SET_ERROR",payload:""}),d({type:"SET_IS_OPENING",payload:!0}),d({type:"SET_IS_TASK_RUNNING",payload:!0}),d({type:"SET_SHOW_PROGRESS",payload:!0}),d({type:"SET_HAS_TASK_RUN",payload:!0}),eb.current=!1,d({type:"SET_PROGRESS",payload:0}),d({type:"SET_SUCCESS_COUNT",payload:0}),d({type:"SET_FAIL_COUNT",payload:0}),d({type:"SET_ERROR",payload:""}),d({type:"SET_STATUS",payload:"正在初始化任务..."});try{let a="task_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));d({type:"SET_TASK_ID",payload:a});let r=s.length*e;if(!(await m("batchopen","silent_batch_open",r,{itemCount:r,description:"静默批量打开 - ".concat(s.length,"个URL x ").concat(e,"次"),onInsufficientBalance:()=>{d({type:"SET_ERROR",payload:"Token余额不足，请充值后重试"}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),d({type:"SET_IS_POLLING",payload:!1})}})).success)return;let n=(e=>e<20?e+5:e<50?Math.ceil(1.3*e):e<100?Math.ceil(1.2*e):Math.ceil(1.1*e))(r);d({type:"SET_REQUIRED_PROXY_COUNT",payload:n}),d({type:"SET_TOTAL_VISITS",payload:r});let l={taskId:a,urls:s,cycleCount:e,proxyUrl:z.trim(),refererOption:$,selectedSocialMedia:"social"===$?J:void 0,customReferer:"custom"===$?Q.trim():void 0,proxyValidated:!0,actualTotalVisits:r,accessMode:t};V.info("启动静默批量打开:",l),d({type:"SET_IS_POLLING",payload:!0}),d({type:"SET_PROGRESS",payload:1}),d({type:"SET_STATUS",payload:"任务初始化..."}),await new Promise(e=>setTimeout(e,200));let o="".concat(Date.now().toString(36),"-").concat(Math.random().toString(36).slice(2,10)),i=await fetch("/api/batchopen/silent-start",{method:"POST",headers:{"Content-Type":"application/json","Idempotency-Key":o},body:JSON.stringify(l)});if(!i.ok){let e=null;try{e=await i.json()}catch(e){}throw 402===i.status&&(y(null==e?void 0:e.required),N(null==e?void 0:e.balance),g(!0)),Error("启动失败: ".concat(i.status))}try{let e=await i.json();if("true"===D.env.NEXT_PUBLIC_USE_GO_BATCHOPEN)if(null==e?void 0:e.taskId)d({type:"SET_TASK_ID",payload:e.taskId});else throw Error((null==e?void 0:e.message)||"启动失败");else if(!(null==e?void 0:e.success))throw Error((null==e?void 0:e.message)||"启动失败")}catch(e){}V.info("任务启动成功，开始轮询进度:",{taskId:a})}catch(t){V.error("启动失败:",new p.$W("启动失败:",{error:t instanceof Error?t.message:String(t)}));let e=t instanceof Error?t.message:"未知错误";e.includes("代理验证失败")?e="代理验证失败，请检查代理配置后重试":e.includes("代理API返回了无效的代理配置")?e='用户提供的代理API无法提供可用的代理IP！\n\n可能的原因：\n1. 代理API地址不正确\n2. 代理API服务不可用\n3. 代理账号余额不足\n\n请检查代理配置后，点击"验证代理"按钮重新验证。':e.includes("代理URL验证失败")?e='代理URL验证失败！\n\n请检查代理API地址是否正确，然后点击"验证代理"按钮重新验证。':e.includes("未能获取到任何有效的代理配置")?e="用户提供的代理API未能返回任何有效的代理配置！\n\n请检查您的代理API地址和服务状态，然后重新验证。":e.includes("代理")&&(e="代理服务异常：".concat(e,"\n\n请检查代理配置或尝试稍后重试。")),d({type:"SET_ERROR",payload:e}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),d({type:"SET_IS_POLLING",payload:!1})}},[ef,eN,eT,W,Y,z,$,Q,_,et,m]),eE=(0,r.useCallback)(async()=>{if(Z&&(L||G)){V.info("开始终止任务:",{taskId:Z,isOpening:P});try{eb.current=!0,d({type:"SET_STATUS",payload:"正在终止..."});let e=!1,t=null;for(let s=1;s<=3;s++){try{V.info("终止请求尝试 ".concat(s,"/3"));let a=await fetch("/api/batchopen/silent-terminate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:Z})});if(a.ok){let t=await a.json();V.info("终止请求成功:",t),e=!0;break}{let e=await a.json();t=e.message||"未知错误",V.error("终止请求失败 (尝试 ".concat(s,"):"),e)}}catch(e){t=e instanceof Error?e.message:String(e),V.warn("终止请求异常 (尝试 ".concat(s,"):"),{error:t})}s<3&&await new Promise(e=>setTimeout(e,500))}e?(d({type:"SET_STATUS",payload:"任务已终止"}),d({type:"SET_ERROR",payload:""}),setTimeout(()=>{d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1})},1500)):(d({type:"SET_ERROR",payload:"终止失败: ".concat(t||"请求失败")}),setTimeout(()=>{d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),ey.current&&(clearInterval(ey.current),ey.current=null)},2e3))}catch(e){e instanceof Error&&"AbortError"===e.name&&"signal is aborted without reason"===e.message?(V.warn("终止请求超时"),d({type:"SET_ERROR",payload:"终止请求超时，请重试"})):(V.error("终止请求异常:",new p.$W("终止请求异常:",{error:e instanceof Error?e.message:String(e)})),d({type:"SET_ERROR",payload:"终止失败，请检查网络连接"})),setTimeout(()=>{d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),ey.current&&(clearInterval(ey.current),ey.current=null)},2e3)}}},[Z,L,G]);(0,r.useEffect)(()=>{ef()},[ef]);let ev=(0,r.useCallback)(e=>{if(d({type:"SET_PROGRESS",payload:Math.max(1,e.progress||0)}),d({type:"SET_SUCCESS_COUNT",payload:e.successCount||0}),d({type:"SET_FAIL_COUNT",payload:e.failCount||0}),d({type:"SET_STATUS",payload:e.message||"正在处理..."}),e.proxyPhase&&d({type:"SET_PROXY_PHASE",payload:e.proxyPhase}),e.phaseStatus&&d({type:"SET_PHASE_STATUS",payload:e.phaseStatus}),e.completedPhases&&d({type:"SET_COMPLETED_PHASES",payload:e.completedPhases}),e.phaseProgress&&d({type:"SET_PHASE_PROGRESS",payload:e.phaseProgress}),void 0!==e.pendingCount?d({type:"SET_PENDING_COUNT",payload:e.pendingCount}):d({type:"SET_PENDING_COUNT",payload:Math.max(0,(e.total||0)-(e.successCount||0)-(e.failCount||0))}),e.message&&(e.message.includes("正在获取代理IP")||e.message.includes("正在准备获取代理IP"))?d({type:"SET_IS_FETCHING_PROXIES",payload:!0}):e.message&&(e.message.includes("代理获取完成")||e.message.includes("开始批量访问")||e.message.includes("正在处理"))&&d({type:"SET_IS_FETCHING_PROXIES",payload:!1}),"completed"===e.status){let t=Date.now();console.log("SilentBatchOpen Debug - Task Completed:",{taskStartTime:el,endTime:t,duration:el?Math.floor((t-el)/1e3):0,hasTaskStartTime:!!el,timeDiff:el?t-el:0,taskStartTimeType:typeof el,endTimeType:typeof t}),d({type:"SET_TASK_END_TIME",payload:t}),console.log("After SET_TASK_END_TIME dispatch",{taskEndTime:t});let s=e.duration||e.elapsedTime;if(s){let e=Math.floor(s/1e3),t=Math.floor(e/60),a=e%60;d({type:"SET_STATUS",payload:"批量访问完成！耗时: ".concat(t>0?"".concat(t,"m").concat(a,"s"):"".concat(a,"s"))})}else{let e=el?Math.floor((t-el)/1e3):0,s=Math.floor(e/60),a=Math.max(1,e);d({type:"SET_STATUS",payload:"批量访问完成！耗时: ".concat(s>0?"".concat(s,"m").concat(a%60,"s"):"".concat(a,"s"))})}d({type:"SET_IS_POLLING",payload:!1}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),d({type:"SET_IS_FETCHING_PROXIES",payload:!1}),setTimeout(()=>{console.log("Final state check:",{taskStartTime:el,taskEndTime:t,status:"completed"}),d({type:"SET_TASK_ID",payload:null})},1e3),d({type:"SET_PROGRESS",payload:100}),d({type:"SET_SHOW_PROGRESS",payload:!0}),d({type:"SET_HAS_TASK_RUN",payload:!0})}else"error"===e.status?(d({type:"SET_ERROR",payload:e.message}),d({type:"SET_IS_POLLING",payload:!1}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),d({type:"SET_IS_FETCHING_PROXIES",payload:!1}),setTimeout(()=>{d({type:"SET_TASK_ID",payload:null})},1e3),d({type:"SET_SHOW_PROGRESS",payload:!0}),d({type:"SET_HAS_TASK_RUN",payload:!0})):"terminated"===e.status&&(d({type:"SET_STATUS",payload:"任务已终止"}),d({type:"SET_IS_POLLING",payload:!1}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),d({type:"SET_IS_FETCHING_PROXIES",payload:!1}),setTimeout(()=>{d({type:"SET_TASK_ID",payload:null})},1e3),d({type:"SET_SHOW_PROGRESS",payload:!0}),d({type:"SET_HAS_TASK_RUN",payload:!0}))},[]);(0,r.useCallback)(e=>{V.error("Real-time progress error:",new p.$W("Real-time progress error:",{error:e.message})),d({type:"SET_ERROR",payload:"网络连接异常，请刷新页面重试"}),d({type:"SET_IS_POLLING",payload:!1}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1})},[]),(0,r.useCallback)(()=>{d({type:"SET_IS_POLLING",payload:!1}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1})},[]),(0,r.useEffect)(()=>{if(!G||!Z)return;let e=null,t=async()=>{try{let t=await fetch("/api/batchopen/silent-progress?taskId=".concat(Z,"&t=").concat(Date.now())),s=await t.json();if(s.success&&(ev(s),"completed"===s.status||"error"===s.status||"terminated"===s.status)){setTimeout(async()=>{try{let e=await fetch("/api/batchopen/silent-progress?taskId=".concat(Z,"&t=").concat(Date.now())),t=await e.json();t.success&&ev(t)}catch(e){V.warn("获取最终状态失败:",e instanceof Error?e:Error(String(e)))}},1e3),d({type:"SET_IS_POLLING",payload:!1}),d({type:"SET_IS_OPENING",payload:!1}),d({type:"SET_IS_TASK_RUNNING",payload:!1}),d({type:"SET_IS_FETCHING_PROXIES",payload:!1}),e&&(clearInterval(e),e=null);return}}catch(e){V.warn("进度轮询错误:",e instanceof Error?e:Error(String(e)))}};return t(),e=setInterval(t,2e3),()=>{e&&clearInterval(e)}},[G,Z,ev]),(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/batchopen/validation-config"),t=await e.json();t.success?(d({type:"SET_VALIDATION_CONFIG",payload:t.config}),V.info("验证配置加载成功",{config:t.config})):V.warn("获取验证配置失败",{error:t.message})}catch(e){V.error("获取验证配置时发生错误",e instanceof Error?e:Error(String(e)))}})()},[]),(0,r.useEffect)(()=>()=>{d({type:"SET_IS_FETCHING_PROXIES",payload:!1}),d({type:"SET_IS_POLLING",payload:!1})},[]);let eR=(0,r.useCallback)(e=>{d({type:"SET_INPUT",payload:e})},[]),ew=(0,r.useCallback)(e=>{d({type:"SET_CYCLE_COUNT_INPUT",payload:e})},[]),eO=(0,r.useCallback)(e=>{d({type:"SET_CYCLE_COUNT",payload:e})},[]),eC=(0,r.useCallback)(e=>{V.info("Access mode changed:",{from:q,to:e}),d({type:"SET_ACCESS_MODE",payload:e})},[q]),eI=(0,r.useCallback)(e=>{d({type:"SET_PROXY_URL",payload:e})},[]),eA=(0,r.useCallback)(e=>{d({type:"SET_REFERER_OPTION",payload:e})},[]),ek=(0,r.useCallback)(e=>{d({type:"SET_SELECTED_SOCIAL_MEDIA",payload:e})},[]),eP=(0,r.useCallback)(e=>{d({type:"SET_CUSTOM_REFERER",payload:e})},[]),eL=(0,r.useCallback)(e=>{d({type:"SET_ERROR",payload:e})},[]),eU=(0,r.useCallback)(e=>{d({type:"SET_STATUS",payload:e})},[]),eD=(0,r.useCallback)(e=>{d({type:"SET_PROXY_VALIDATION_SUCCESS",payload:e})},[]),eM=(0,r.useCallback)(e=>{d({type:"SET_LAST_VALIDATED_PROXY_URL",payload:e})},[]),eV=(0,r.useCallback)(()=>{e_()},[e_]),eG=(0,r.useCallback)(()=>{eE()},[eE]);return(0,a.jsxs)(S,{onError:(e,t)=>{V.error("SilentBatchOpen组件错误:",new p.$W("SilentBatchOpen组件错误:",{error:e.message,componentStack:t.componentStack}))},children:[(0,a.jsx)(u.WeChatSubscribeModal,{open:x,onOpenChange:g,scenario:"insufficient_balance",requiredTokens:b,currentBalance:f}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h2",{className:l.B8.typography.h3+" mb-4",children:B(i,"batchopen.title")}),(0,a.jsx)("p",{className:l.B8.typography.body+" mb-6",children:B(i,"batchopen.desc")}),(0,a.jsx)(j,{input:_,onInputChange:eR,urls:E,isOpening:P,getTranslation:B,t:i}),(0,a.jsx)(T,{cycleCountInput:Y,cycleCount:X,isOpening:P,accessMode:q,proxyUrl:z,refererOption:$,customReferer:Q,paramErrors:ei,onCycleCountInputChange:ew,onCycleCountChange:eO,onAccessModeChange:eC,getTranslation:B,t:i}),(0,a.jsx)(R,{proxyUrl:z,proxyValidationSuccess:et,isValidatingProxy:ee,lastValidatedProxyUrl:es,refererOption:$,selectedSocialMedia:J,customReferer:Q,requiredProxyCount:er,isOpening:P,paramErrors:ei,onProxyUrlChange:eI,onRefererOptionChange:eA,onSelectedSocialMediaChange:ek,onCustomRefererChange:eP,onValidateProxy:eT,setError:eL,setStatus:eU,setProxyValidationSuccess:eD,setLastValidatedProxyUrl:eM}),(0,a.jsx)(O,{urls:E,paramErrors:ei,isOpening:P,isTaskRunning:L,isPolling:G,isValidatingProxy:ee,isFetchingProxies:ea,proxyValidationSuccess:et,error:k,onStartTask:eV,onTerminateTask:eG,getTranslation:B,t:i})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)(U,{getTranslation:B,t:i}),(0,a.jsx)(C,{showProgress:H,taskId:Z,progress:v,successCount:w,failCount:I,totalVisits:en,status:A||"running",message:A,taskStartTime:el,taskEndTime:eo})]})]})]})});H.displayName="SilentBatchOpen";var W=s(89223);let X=e=>{let{progress:t,total:s,isOpening:r,isTerminated:n,className:l=""}=e,o=s>0?Math.min(100,Math.round(t/s*100)):0;return 0!==t||r||n?(0,a.jsxs)("div",{className:"w-full space-y-2 ".concat(l),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,a.jsx)("span",{children:n?"批量打开已终止":t>=s&&s>0?"批量打开完成":r?"正在打开...":""}),(0,a.jsxs)("span",{className:"whitespace-nowrap",children:[t,"/",s," (",o,"%)"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(n?"bg-yellow-600":t>=s&&s>0?"bg-green-600":"bg-blue-600"),style:{width:"".concat(o,"%")}})})]}):null};var Y=s(44023),q=s(27047),z=s(33020),$=s(80035),J=s(65339),Q=s(48855),Z=s(66043),ee=s(557),et=s(18529);function es(e){let{taskId:t,className:s=""}=e,{data:n,isConnected:l,error:o,lastUpdate:i}=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],[s,a]=(0,r.useState)(null),[n,l]=(0,r.useState)(!1),[o,i]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!t||!e)return;let s=null,r=()=>{try{(s=new EventSource("/api/autoclick/tasks/".concat(e,"/live"))).onopen=()=>{l(!0),i(null)},s.onmessage=e=>{try{let t=JSON.parse(e.data);a(t),i(null)}catch(e){console.error("Error parsing SSE data:",e),i("Failed to parse progress data")}},s.onerror=e=>{console.error("EventSource error:",e),l(!1),i("Connection lost"),s&&s.close(),setTimeout(r,5e3)}}catch(e){console.error("Failed to create EventSource:",e),i("Failed to establish connection"),l(!1)}};return r(),()=>{s&&s.close()}},[e,t]),{data:s,isConnected:n,error:o,lastUpdate:(null==s?void 0:s.timestamp)?new Date(s.timestamp):null}}(t);if(!n)return(0,a.jsx)("div",{className:"p-6 bg-gray-50 rounded-lg ".concat(s),children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,a.jsx)(Y.A,{className:"w-4 h-4 animate-pulse"}),(0,a.jsx)("span",{children:"连接中..."})]})});let c=(()=>{switch(n.status){case"running":return{icon:(0,a.jsx)(q.A,{className:"w-5 h-5 text-green-600"}),color:"text-green-600 bg-green-50",text:"运行中"};case"pending":return{icon:(0,a.jsx)(z.A,{className:"w-5 h-5 text-yellow-600"}),color:"text-yellow-600 bg-yellow-50",text:"未启动"};case"terminated":return{icon:(0,a.jsx)($.A,{className:"w-5 h-5 text-red-600"}),color:"text-red-600 bg-red-50",text:"已终止"};default:return{icon:(0,a.jsx)(Y.A,{className:"w-5 h-5 text-gray-600"}),color:"text-gray-600 bg-gray-50",text:n.status}}})();return(0,a.jsxs)("div",{className:"space-y-4 ".concat(s),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ".concat(c.color),children:[c.icon,c.text]}),(0,a.jsx)("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(J.A,{className:"w-4 h-4 text-green-500"}),(0,a.jsx)("span",{children:"实时更新"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Q.A,{className:"w-4 h-4 text-red-500"}),(0,a.jsx)("span",{children:"连接断开"})]})})]}),i&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["更新于 ",i.toLocaleTimeString()]})]}),o&&(0,a.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-red-600",children:o})}),n.progress&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(Z.A,{className:"w-5 h-5 text-blue-600"}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"今日总进度"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"完成进度"}),(0,a.jsxs)("span",{className:"font-medium",children:[n.progress.total.completed.toLocaleString()," / ",n.progress.total.target.toLocaleString(),"(",n.progress.total.percentage,"%)"]})]}),(0,a.jsx)(X,{progress:n.progress.total.completed,total:n.progress.total.target,isOpening:"running"===n.status,isTerminated:"terminated"===n.status,className:"h-3"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"p-2 bg-blue-50 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"目标"}),(0,a.jsx)("p",{className:"font-semibold text-blue-600",children:n.progress.total.target.toLocaleString()})]}),(0,a.jsxs)("div",{className:"p-2 bg-green-50 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"已完成"}),(0,a.jsx)("p",{className:"font-semibold text-green-600",children:n.progress.total.completed.toLocaleString()})]}),(0,a.jsxs)("div",{className:"p-2 bg-purple-50 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"完成率"}),(0,a.jsxs)("p",{className:"font-semibold text-purple-600",children:[n.progress.total.percentage,"%"]})]})]})]})]}),n.progress.hourly&&(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(ee.A,{className:"w-5 h-5 text-orange-600"}),(0,a.jsxs)("h4",{className:"font-medium text-gray-900",children:["当前小时 (",new Date().getHours(),":00-",new Date().getHours()+1,":00)"]}),n.progress.hourly.isRunning&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full",children:"执行中"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"小时进度"}),(0,a.jsxs)("span",{className:"font-medium",children:[n.progress.hourly.completed," / ",n.progress.hourly.target]})]}),(0,a.jsx)(X,{progress:n.progress.hourly.completed,total:n.progress.hourly.target,isOpening:n.progress.hourly.isRunning,isTerminated:"terminated"===n.status,className:"h-2"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"p-2 bg-orange-50 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"目标"}),(0,a.jsx)("p",{className:"font-semibold text-orange-600",children:n.progress.hourly.target})]}),(0,a.jsxs)("div",{className:"p-2 bg-green-50 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"成功"}),(0,a.jsx)("p",{className:"font-semibold text-green-600",children:n.progress.hourly.completed})]}),(0,a.jsxs)("div",{className:"p-2 bg-red-50 rounded",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"失败"}),(0,a.jsx)("p",{className:"font-semibold text-red-600",children:n.progress.hourly.failed})]})]})]})]}),n.progress.total.percentage>0&&n.progress.total.percentage<100&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)(z.A,{className:"w-4 h-4 text-blue-600"}),(0,a.jsxs)("span",{className:"text-sm text-blue-700",children:["预计完成时间: ",new Date(Date.now()+Math.ceil((n.progress.total.target-n.progress.total.completed)/(n.progress.total.completed/(Date.now()-new Date().setHours(0,0,0,0)))*864e5)).toLocaleString()]})]}),n.progress.total.percentage>=100&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsx)(et.A,{className:"w-5 h-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-green-700",children:"今日任务已完成！"})]})]})]})}var ea=s(48474),er=s(89729),en=s(29179),el=s(43125),eo=s(73146),ei=s(15768),ec=s(49642),ed=s.n(ec);function ep(e){var t,s,n;let{locale:o,t:i}=e,{data:c}=(0,W.useSession)(),{openLoginModal:d}=(0,m.Z)(),{data:p,loading:x}=(0,ei.L)(),[h,g]=(0,r.useState)([]),[b,y]=(0,r.useState)(!0),[f,S]=(0,r.useState)(!1),[N,j]=(0,r.useState)(!1),[T,E]=(0,r.useState)(null),[v,R]=(0,r.useState)({offerUrl:"",country:"US",timeWindow:"06:00-24:00",dailyClicks:100,referer:"https://google.com",proxyUrl:""}),w=(null==p||null==(n=p.limits)||null==(s=n.batchopen)||null==(t=s.versions)?void 0:t.includes("autoclick"))||!1,[O,C]=(0,r.useState)(!1),[I,A]=(0,r.useState)("upgrade_required"),[k,P]=(0,r.useState)(void 0),[L,U]=(0,r.useState)(void 0),D=async()=>{try{let e=await fetch("/api/autoclick/tasks");if(e.ok){let t=await e.json();g(t.tasks||[])}}catch(e){console.error("Failed to fetch tasks:",e)}finally{y(!1)}};(0,r.useEffect)(()=>{c?D():(y(!1),g([]))},[c]);let M=async()=>{if(c){S(!0);try{let e=await fetch("/api/autoclick/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(e.ok)R({offerUrl:"",country:"US",timeWindow:"06:00-24:00",dailyClicks:100,referer:"https://google.com",proxyUrl:""}),j(!1),D();else{let t=null;try{t=await e.json()}catch(e){}402===e.status?(A("insufficient_balance"),P(null==t?void 0:t.required),U(null==t?void 0:t.balance),C(!0)):403===e.status?(A("upgrade_required"),C(!0)):alert((null==t?void 0:t.error)||"创建任务失败")}}catch(e){console.error("Failed to create task:",e),alert("创建任务失败")}finally{S(!1)}}},V=async(e,t)=>{try{let s=await fetch("/api/autoclick/tasks/".concat(e,"/").concat(t),{method:"POST"});if(s.ok)D();else{let e=null;try{e=await s.json()}catch(e){}402===s.status?(A("insufficient_balance"),P(null==e?void 0:e.required),U(null==e?void 0:e.balance),C(!0)):403===s.status?(A("upgrade_required"),C(!0)):alert((null==e?void 0:e.error)||"操作失败")}}catch(e){console.error("Failed to update task:",e),alert("操作失败")}},G=e=>{switch(e){case"running":return"text-green-600 bg-green-100";case"pending":return"text-yellow-600 bg-yellow-100";case"terminated":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},B=e=>{switch(e){case"running":return"已启动";case"pending":return"未启动";case"terminated":return"已终止";default:return e}},F=e=>{switch(e){case"running":return(0,a.jsx)(ea.A,{className:"w-4 h-4"});case"pending":return(0,a.jsx)(z.A,{className:"w-4 h-4"});case"terminated":return(0,a.jsx)(er.A,{className:"w-4 h-4"});default:return(0,a.jsx)($.A,{className:"w-4 h-4"})}},K=!!c;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(u.WeChatSubscribeModal,{open:O,onOpenChange:C,scenario:I,requiredTokens:k,currentBalance:L}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"自动化点击任务"}),(0,a.jsxs)("button",{onClick:()=>{c?w?j(!N):(A("upgrade_required"),C(!0)):d("autoclick")},className:"".concat(l.B8.buttons.primary," flex items-center gap-2"),children:[(0,a.jsx)(en.A,{className:"w-4 h-4"}),N?"取消":"新增任务"]})]}),N&&(0,a.jsxs)("div",{className:"".concat(l.B8.cards.simple," p-6"),children:[(0,a.jsx)("h4",{className:"text-lg font-medium mb-4",children:"创建新任务"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"目标URL *"}),(0,a.jsx)("input",{type:"url",value:v.offerUrl,onChange:e=>R({...v,offerUrl:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"国家/地区"}),(0,a.jsxs)("select",{value:v.country,onChange:e=>R({...v,country:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"US",children:"美国"}),(0,a.jsx)("option",{value:"CN",children:"中国"}),(0,a.jsx)("option",{value:"UK",children:"英国"}),(0,a.jsx)("option",{value:"JP",children:"日本"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"执行时间段"}),(0,a.jsxs)("select",{value:v.timeWindow,onChange:e=>R({...v,timeWindow:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"00:00-24:00",children:"全天 (00:00-24:00)"}),(0,a.jsx)("option",{value:"06:00-24:00",children:"日间 (06:00-24:00)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"每日点击次数 *"}),(0,a.jsx)("input",{type:"number",min:"1",max:"10000",value:v.dailyClicks,onChange:e=>R({...v,dailyClicks:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Referer"}),(0,a.jsx)("input",{type:"url",value:v.referer,onChange:e=>R({...v,referer:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://google.com"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"代理（可选）"}),(0,a.jsx)("input",{type:"text",value:v.proxyUrl,onChange:e=>R({...v,proxyUrl:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"http://user:pass@ip:port"})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>j(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"取消"}),(0,a.jsx)(_.L,{featureName:"autoclick",onClick:M,disabled:f||!v.offerUrl,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"创建中...":"创建任务"})]})]}),b?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"加载中..."})]}):0===h.length?(0,a.jsxs)("div",{className:"".concat(l.B8.cards.simple," p-8 text-center"),children:[(0,a.jsx)($.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:K?w?"暂无任务，点击上方按钮创建新任务":"请联系管理员开通自动化点击功能权限":"登录后可创建自动化点击任务"})]}):(0,a.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,a.jsxs)("div",{className:"".concat(l.B8.cards.simple," p-6"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(G(e.status)),children:[F(e.status),B(e.status)]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["创建于 ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"目标URL"}),(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:e.offerUrl})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"每日点击"}),(0,a.jsx)("p",{className:"font-medium",children:e.dailyClicks.toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"时间段"}),(0,a.jsx)("p",{className:"font-medium",children:e.timeWindow})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Referer"}),(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:e.referer})]})]}),e.todayProgress&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"今日进度"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.todayProgress.completed," / ",e.todayProgress.target,"(",e.todayProgress.percentage,"%)"]})]}),(0,a.jsx)(X,{progress:e.todayProgress.completed,total:e.todayProgress.target,isOpening:!1,isTerminated:"terminated"===e.status,className:"h-2"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 ml-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:["pending"===e.status&&(0,a.jsxs)("div",{className:"group relative",children:[w?(0,a.jsx)(_.L,{featureName:"autoclick",onClick:()=>V(e.id,"start"),className:"p-2 text-green-600 bg-green-50 rounded-lg hover:bg-green-100",children:(0,a.jsx)(ea.A,{className:"w-4 h-4"})}):(0,a.jsx)(ed(),{href:"/pricing",className:"p-2 text-green-600 bg-green-50 rounded-lg hover:bg-green-100 flex items-center justify-center",title:"升级到Max以使用此功能",children:(0,a.jsx)(el.A,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"启动任务"})]}),"running"===e.status&&(0,a.jsxs)("div",{className:"group relative",children:[w?(0,a.jsx)(_.L,{featureName:"autoclick",onClick:()=>V(e.id,"terminate"),className:"p-2 text-red-600 bg-red-50 rounded-lg hover:bg-red-100",children:(0,a.jsx)(er.A,{className:"w-4 h-4"})}):(0,a.jsx)(ed(),{href:"/pricing",className:"p-2 text-red-600 bg-red-50 rounded-lg hover:bg-red-100 flex items-center justify-center",title:"升级到Max以使用此功能",children:(0,a.jsx)(el.A,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"终止任务"})]})]}),(0,a.jsxs)("div",{className:"group relative",children:[w?(0,a.jsx)(_.L,{featureName:"autoclick",onClick:()=>E(T===e.id?null:e.id),className:"p-2 rounded-lg ".concat(T===e.id?"text-blue-600 bg-blue-100":"text-gray-600 bg-gray-100 hover:bg-gray-200"),children:(0,a.jsx)(eo.A,{className:"w-4 h-4"})}):(0,a.jsx)(ed(),{href:"/pricing",className:"p-2 rounded-lg ".concat(T===e.id?"text-blue-600 bg-blue-100":"text-gray-600 bg-gray-100 hover:bg-gray-200"," flex items-center justify-center"),title:"升级到Max以使用此功能",children:(0,a.jsx)(el.A,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"查看实时进度"})]})]})]}),T===e.id&&(0,a.jsx)("div",{className:"mt-4 border-t pt-4",children:(0,a.jsx)(es,{taskId:e.id})})]},e.id))}),(0,a.jsxs)("div",{className:"".concat(l.B8.cards.simple," p-6"),children:[(0,a.jsxs)("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[(0,a.jsx)(et.A,{className:"w-5 h-5 text-green-600"}),i("batchOpenSection.autoclickVersion.title")]}),(0,a.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"智能调度："}),"系统根据时间权重自动分配24小时点击量，高峰时段增加点击频率"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"自动执行："}),"无需人工干预，系统每小时自动执行点击任务"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"双引擎："}),"集成SimpleHttp和Puppeteer两种访问器，失败时自动切换"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"代理轮换："}),"每次访问使用新的代理IP，确保访问真实性"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Token计费："}),"按实际成功点击次数消耗Token，失败不扣费"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"实时监控："}),"可查看任务执行状态和今日进度"]})]})]})]})}var eu=s(8025),em=s(40459);function ex(){let e=(0,eu.zl)();if(e){let t=(0,eu.Ct)("RateLimit.RequestsPerMinute",e);if("number"==typeof t&&isFinite(t)&&t>0)return t}let t=parseInt(em.env.RATE_LIMIT_API_REQUESTS||em.env.RATE_LIMIT_API_PER_MINUTE||"500");return Number.isFinite(t)&&t>0?t:500}async function eh(){try{let e=await (0,eu.LO)(),t=(0,eu.Ct)("RateLimit.RequestsPerMinute",e);if("number"==typeof t&&isFinite(t)&&t>0)return t}catch(e){}return ex()}function eg(e,t){let s=e.split("."),a=null==t?void 0:t.config;for(let e of s)if(!a||"object"!=typeof a)return;else{let t=Object.keys(a).find(t=>t.toLowerCase()===e.toLowerCase());a=void 0!==t?a[t]:void 0}return a}let eb=(0,d.KV)("BatchOpenSection"),ey=e=>{let t=window.location.origin;window.postMessage(e,t)},ef={"batchopen.basicVersion.title":"初级版本","batchopen.advancedVersion.title":"高级版本","batchopen.silentVersion.title":"静默版本","batchopen.autoclickVersion.title":"自动化版本","batchopen.title":"批量打开URL","batchopen.desc":"后台批量访问URL，动态代理IP，自定义Referer","batchopen.advancedVersion.multiUrlMode":"多URL模式","batchopen.advancedVersion.singleUrlMode":"单URL模式","batchopen.advancedVersion.cycleCount":"循环次数","batchopen.advancedVersion.openCount":"打开次数","batchopen.advancedVersion.openInterval":"打开间隔(秒)","batchopen.input.title":"输入URL","batchopen.input.description":"请输入要打开的URL，每行一个","batchopen.input.placeholder":"请输入要批量打开的URL，每行一个...","batchopen.btn.opening":"正在打开...","batchopen.btn.open":"批量打开","batchopen.btn.clear":"清空","batchopen.btn.tip":"提示：批量打开前会自动关闭上次打开的所有标签页","batchopen.status.popup_blocked_tip":"弹窗被阻止！请允许弹窗后重试","batchopen.status.opening":"正在打开...","batchopen.status.popup_blocked":"弹窗被阻止","batchopen.status.success":"成功打开{count}个URL","batchopen.status.terminated":"正在终止批量打开...","batchopen.error.no_urls":"请输入至少一个URL","batchopen.error.invalid_cycle_count":"循环次数必须在1-60之间","batchopen.error.invalid_open_count":"打开次数必须在1-1000之间","batchopen.error.invalid_interval":"打开间隔必须在1-60秒之间","batchOpenSection.basicVersion.title":"初级版本说明","batchOpenSection.basicVersion.tip":"提示：无需安装单独的 Background Open 插件，但只能实现简单的批量打开URL功能，且需要手动刷新代理IP地址。","batchOpenSection.basicVersion.steps.title":"操作步骤：","batchOpenSection.basicVersion.steps.step1":"手动刷新代理IP地址","batchOpenSection.basicVersion.steps.step2":"输入需要打开的多个URL","batchOpenSection.basicVersion.steps.step3":'点击"批量打开"，实现批量打开URL',"batchOpenSection.advancedVersion.title":"高级版本说明","batchOpenSection.advancedVersion.tip":'必须安装单独的 <a href="/background-open-install" class="text-blue-700 underline mx-1" target="_blank" rel="noopener noreferrer">Background Open</a> 插件，可以实现更丰富的后台循环打开URL的功能，包括多URL模式、单URL模式、循环次数、间隔参数等。',"batchOpenSection.advancedVersion.stepsTitle":"使用步骤","batchOpenSection.advancedVersion.scenariosTitle":"适用场景","batchOpenSection.silentVersion.title":"静默版本说明","batchOpenSection.silentVersion.tip":"无需安装任何插件，通过后端Chromium浏览器实现真实的浏览器访问","batchOpenSection.autoclickVersion.title":"自动化版本说明","batchOpenSection.autoclickVersion.tip":"自动化版本将优先使用 HTTP 访问以提升性能；若检测到连续失败或失败率过高，将自动切换为浏览器访问（Puppeteer）以提升成功率，切换后本次任务将保持浏览器方式执行。","batchopen.btn.terminate":"终止"},eS=(e,t)=>g(e,t,ef[t]),eN=r.memo(e=>{let{t:t,locale:s,isLoading:o}=(0,n.o)(),i=o?e.t:t,c=o?e.locale:s,[d,p]=(0,r.useState)("basic"),[m,x]=(0,r.useState)(""),{consumeTokens:g,getTokenBalance:b}=h(),[y,f]=(0,r.useState)(!1),[S,N]=(0,r.useState)(void 0),[j,T]=(0,r.useState)(void 0),[E,v]=(0,r.useState)([]),R=(0,r.useRef)([]),[w,O]=(0,r.useState)(0),[C,I]=(0,r.useState)(""),[A,k]=(0,r.useState)(""),[P,L]=(0,r.useState)(!1),[U,D]=(0,r.useState)(!1),M=(0,r.useRef)(!1),[V,G]=(0,r.useState)(!1),[B,F]=(0,r.useState)(null),[K,W]=(0,r.useState)(null),[Y,q]=(0,r.useState)(!1),[z,$]=(0,r.useState)(!1),[J,Q]=(0,r.useState)(ex()),[Z,ee]=(0,r.useState)(void 0),[et,es]=(0,r.useState)(void 0),{data:ea}=(0,ei.L)();(0,r.useEffect)(()=>{eh().then(Q).catch(()=>{})},[]),(0,r.useEffect)(()=>{let{planRpm:e,featureRpm:t}=function(e,t){var s,a,r,n;let l,o,i=(0,eu.zl)();if(!i)return{};if(e)for(let t of["RateLimit.Plans","rate_limit.plans"]){let r=eg(t,i);if(r&&"object"==typeof r){let t=Object.keys(r).find(t=>t.toLowerCase()===String(e).toLowerCase()),n=t?r[t]:void 0;if(n&&"object"==typeof n){let e=null!=(s=n.RPM)?s:n.rpm,t=null!=(a=n.RPS)?a:n.rps;if("number"==typeof e&&e>0){l=e;break}if("number"==typeof t&&t>0){l=Math.round(60*t);break}}}}if(t)for(let e of["RateLimit.Features","rate_limit.features"]){let s=eg(e,i);if(s&&"object"==typeof s){let e=Object.keys(s).find(e=>e.toLowerCase()===String(t).toLowerCase()),a=e?s[e]:void 0;if(a&&"object"==typeof a){let e=null!=(r=a.RPM)?r:a.rpm,t=null!=(n=a.RPS)?n:a.rps;if("number"==typeof e&&e>0){o=e;break}if("number"==typeof t&&t>0){o=Math.round(60*t);break}}}}return{planRpm:l,featureRpm:o}}(null==ea?void 0:ea.planId,"batchopen");ee(e),es(t)},[null==ea?void 0:ea.planId]),(0,r.useMemo)(()=>{let e=K||E.length,t=e>0?Math.min(100,Math.round(w/e*100)):0;return{total:e,percent:t,displayPercent:t,displayProgress:"".concat(w,"/").concat(e),shouldShowProgress:P||w>0||z&&w>0}},[w,K,E.length,P,z]);let er=(0,r.useCallback)(()=>{eb.info("\uD83D\uDD0D 简化插件检测...");let e=window;return e.backgroundOpenExtension&&e.backgroundOpenExtension.id?(eb.info("✅ 检测到插件:"),G(!0),!0):document.querySelector("script[data-background-open]")||window.hasOwnProperty("backgroundOpenContentScriptLoaded")?(eb.info("✅ 检测到content script标记"),G(!0),!0):(eb.info("❌ 未检测到插件，可能需要手动激活"),G(!1),!1)},[]),en=(e,t)=>{F({type:e,message:t}),setTimeout(()=>F(null),5e3)};(0,r.useEffect)(()=>{let e=setTimeout(()=>{eb.info("\uD83D\uDE80 页面加载完成，开始插件检测"),er()},1e3);return()=>clearTimeout(e)},[er]),(0,r.useEffect)(()=>{function e(e){window.backgroundOpenExtension={id:e.detail.id},eb.info("✅ 页面端收到扩展事件"),G(!0)}window.addEventListener("backgroundOpenExtensionDetected",e),er();let t=setTimeout(()=>{eb.info("\uD83D\uDD50 延迟检测（1秒后）"),er()},1e3),s=setTimeout(()=>{eb.info("\uD83D\uDD50 延迟检测（3秒后）"),er()},3e3);return()=>{window.removeEventListener("backgroundOpenExtensionDetected",e),clearTimeout(t),clearTimeout(s)}},[er]),(0,r.useEffect)(()=>{var e;function t(e){if(!z){if(e.data&&"BATCH_OPEN_PROGRESS"===e.data.type){let t=e.data.count||0,s=e.data.total||1;O(t),W(s),I("已打开 ".concat(t,"/").concat(s," 个标签页")),t>=s&&setTimeout(()=>{L(!1),I("批量打开完成，共打开 ".concat(s," 个标签页"))},1e3)}e.data&&"BATCH_TERMINATE_CONFIRMED"===e.data.type&&(eb.info("收到终止确认消息:"),L(!1),$(!0),I("批量打开已完全终止"),en("success",e.data.message||"批量打开已完全终止"))}}function s(e,t,s){e&&"BATCH_TERMINATE_CONFIRMED"===e.type&&(eb.info("收到Chrome扩展终止确认:"),L(!1),$(!0),I("批量打开已完全终止"),en("success",e.message||"批量打开已完全终止"))}window.addEventListener("message",t);let a=null==(e=window.chrome)?void 0:e.runtime;return(null==a?void 0:a.onMessage)&&a.onMessage.addListener(s),()=>{window.removeEventListener("message",t),(null==a?void 0:a.onMessage)&&a.onMessage.removeListener(s)}},[z]);let el=e=>e.split(/\s|,|;|\n|\r/).map(e=>e.trim()).filter(e=>e.length>0&&/^https?:\/\//.test(e)),eo=e=>{M.current=!0,p(e),setTimeout(()=>{M.current=!1},100)},ec=async()=>{for(let e of(k(""),I(""),D(!1),O(0),$(!1),W(null),M.current=!1,R.current))try{e.close()}catch(e){}if(R.current=[],0===E.length){let e=eS(i,"batchopen.error.no_urls")||"请输入至少一个URL";k(e),en("error",e);return}L(!0);let e=!1,t=[];if("basic"===d){if(!(await g("batchopen","basic_batch_open",E.length,{itemCount:E.length,description:"批量打开 - ".concat(E.length,"个URL"),onInsufficientBalance:async()=>{k("Token余额不足，请联系顾问充值"),en("error","Token余额不足，请联系顾问充值");try{let e=await b();T(null!=e?e:void 0)}catch(e){}N(E.length),f(!0)}})).success)return void L(!1);for(let s=0;s<E.length&&!M.current;s++){let a=E[s],r=window.open(a,"_blank");if(!r){e=!0;break}t.push(r),O(s+1),await new Promise(e=>setTimeout(e,200))}if(R.current=t,setTimeout(()=>{L(!1),I("批量打开完成，共打开 ".concat(t.length," 个标签页"))},1e3),e){D(!0);let e=eS(i,"batchopen.status.popup_blocked")||"弹窗被拦截，请允许弹窗后重试";I(e),en("error",e)}else{var s;let e=(null==(s=eS(i,"batchopen.status.success"))?void 0:s.replace("{count}",String(t.length)))||"成功打开 ".concat(t.length," 个标签页");I(e),en("success",e)}}L(!1),e?(D(!0),I(eS(i,"batchopen.status.popup_blocked")||"弹窗被阻止")):M.current||I(eS(i,"batchopen.status.success")?eS(i,"batchopen.status.success").replace("{count}",String(t.length)):"已打开".concat(t.length,"个标签页"))};return K||E.length,(()=>{if(!P||0===w||!K)return;let e=0,t=(K-w)*1;if(t<60||t<3600);})(),(0,a.jsxs)("section",{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center text-xs text-gray-600 mb-2 gap-3",children:[(0,a.jsxs)("span",{children:["每分钟请求上限（展示）: ",(0,a.jsx)("span",{className:"font-semibold text-gray-800",children:J})]}),Z?(0,a.jsxs)("span",{children:["套餐上限: ",(0,a.jsxs)("span",{className:"font-semibold text-gray-800",children:[Z," RPM"]})]}):null,et?(0,a.jsxs)("span",{children:["功能上限: ",(0,a.jsxs)("span",{className:"font-semibold text-gray-800",children:[et," RPM"]})]}):null]}),(0,a.jsxs)("div",{className:"flex items-center justify-center text-xs text-gray-600 mb-2",children:[(0,a.jsx)("span",{children:"每分钟请求上限（展示）:"}),(0,a.jsx)("span",{className:"ml-2 font-semibold text-gray-800",children:J})]}),(0,a.jsx)(u.WeChatSubscribeModal,{open:y,onOpenChange:f,scenario:"insufficient_balance",requiredTokens:S,currentBalance:j}),(0,a.jsxs)("div",{className:"flex justify-center gap-4 mb-8",children:[(0,a.jsx)("button",{className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 ".concat("basic"===d?l.B8.buttons.primary:l.B8.buttons.outline),onClick:()=>eo("basic"),children:eS(i,"batchopen.basicVersion.title")}),(0,a.jsx)("button",{className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 ".concat("silent"===d?l.B8.buttons.primary:l.B8.buttons.outline),onClick:()=>eo("silent"),children:eS(i,"batchopen.silentVersion.title")}),(0,a.jsxs)("button",{className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 ".concat("autoclick"===d?l.B8.buttons.primary:l.B8.buttons.outline," relative"),onClick:()=>eo("autoclick"),children:[eS(i,"batchopen.autoclickVersion.title"),(0,a.jsx)("span",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold",children:"New"})]})]}),(0,a.jsx)("div",{className:"".concat(l.B8.cards.simple," p-8 mb-8"),children:"silent"===d?(0,a.jsx)(H,{locale:c,t:i}):"autoclick"===d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4 p-3 rounded-lg bg-blue-50 border border-blue-200 text-sm text-blue-800",children:[(0,a.jsx)("strong",{className:"mr-2",children:"提示"}),eS(i,"batchOpenSection.autoclickVersion.tip")]}),(0,a.jsx)(ep,{locale:c,t:i})]}):(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h2",{className:l.B8.typography.h3+" mb-4",children:eS(i,"batchopen.title")}),(0,a.jsx)("p",{className:l.B8.typography.body+" mb-6",children:eS(i,"batchopen.desc")}),B&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded-lg text-sm ".concat("success"===B.type?"bg-green-100 text-green-800 border border-green-200":"error"===B.type?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:B.message}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:l.B8.typography.h4+" mb-3",children:eS(i,"batchopen.input.title")}),(0,a.jsx)("p",{className:l.B8.typography.small+" mb-4",children:eS(i,"batchopen.input.description")}),(0,a.jsx)("textarea",{className:"w-full min-h-[120px] border-2 border-gray-200 rounded-xl p-4 mb-4 focus:border-blue-500 focus:outline-none transition-colors resize-none",placeholder:eS(i,"batchopen.input.placeholder"),value:m,onChange:e=>{x(e.target.value),v(el(e.target.value)),k("")}}),(0,a.jsxs)("div",{className:"mb-4 text-sm text-gray-500 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"".concat(E.length," 个URL")]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,a.jsx)(_.L,{featureName:"batchopen",className:"".concat(l.B8.buttons.primary," disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"),onClick:ec,disabled:P||0===E.length,children:P?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),eS(i,"batchopen.btn.opening")]}):eS(i,"batchopen.btn.open")}),(0,a.jsx)("button",{className:"".concat(l.B8.buttons.outline," disabled:opacity-50 disabled:cursor-not-allowed"),onClick:()=>{for(let e of(q(!0),O(0),I(""),k(""),D(!1),W(null),L(!1),M.current=!0,$(!1),setTimeout(()=>{M.current=!1,q(!1)},200),ey({type:"BATCH_CLOSE_ALL_TABS"}),R.current))try{e.close()}catch(e){}R.current=[]},disabled:P,children:eS(i,"batchopen.btn.clear")})]}),(0,a.jsxs)("p",{className:l.B8.typography.caption+" flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),eS(i,"batchopen.btn.tip")]})]}),A&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-red-600 font-bold text-sm",children:"!"})}),(0,a.jsx)("p",{className:"text-red-800 text-sm font-medium",children:A})]})}),U&&(0,a.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 mb-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-orange-600 font-bold text-sm",children:"!"})}),(0,a.jsx)("p",{className:"text-orange-800 text-sm font-medium",children:eS(i,"batchopen.status.popup_blocked_tip")})]})})]}),"basic"===d&&(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-6 text-slate-900 border-b border-slate-200 pb-2",children:eS(i,"batchOpenSection.basicVersion.title")}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-blue-600 text-base",children:"\uD83D\uDCA1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-900 text-base mb-2",children:"功能说明"}),(0,a.jsx)("p",{className:"text-blue-800 text-base leading-relaxed",children:eS(i,"batchOpenSection.basicVersion.tip")})]})]})}),(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("h4",{className:"font-semibold text-gray-900 text-base mb-3 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"\uD83D\uDCCB"}),eS(i,"batchOpenSection.basicVersion.steps.title")]}),(0,a.jsxs)("ol",{className:"list-decimal list-inside text-gray-700 text-sm leading-relaxed space-y-2",children:[(0,a.jsx)("li",{className:"pl-1",children:eS(i,"batchOpenSection.basicVersion.steps.step1")}),(0,a.jsx)("li",{className:"pl-1",children:eS(i,"batchOpenSection.basicVersion.steps.step2")}),(0,a.jsx)("li",{className:"pl-1",children:eS(i,"batchOpenSection.basicVersion.steps.step3")})]})]})]}),(0,a.jsx)(X,{progress:w,total:K||E.length,isOpening:P,isTerminated:z,className:"mt-8 mb-2 px-2"})]})]})})]})});eN.displayName="BatchOpenSection";var ej=s(59264),eT=s(51747),e_=s(75701),eE=s(47227);function ev(){let{t:e,isLoading:t,locale:s}=(0,n.o)(),[o,i]=r.useState(!1);return t?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4",role:"status","aria-label":"页面加载中"}),(0,a.jsx)("p",{className:"text-gray-600","aria-live":"polite",children:"Loading..."}),(0,a.jsx)("span",{className:"sr-only",children:"正在加载页面内容，请稍候"})]})}):(0,a.jsx)("div",{className:"min-h-screen ".concat(l.B8.gradients.hero),children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)(u.WeChatSubscribeModal,{open:o,onOpenChange:i,scenario:"batchopen_entry"}),(0,a.jsxs)("header",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:l.B8.typography.h1,children:"真实点击"}),(0,a.jsx)("p",{className:"".concat(l.B8.typography.subtitle," max-w-3xl mx-auto"),children:"零插件实现云端真实访问，支持代理IP轮换，Referer随心设置，真实模拟用户请求"}),(0,a.jsx)("div",{className:"mt-4 flex items-center justify-center",children:(0,a.jsx)(eE.$,{variant:"outline",onClick:()=>i(!0),children:"了解与开通静默/自动化版本"})})]}),(0,a.jsx)("main",{className:"mt-12",role:"main","aria-labelledby":"batch-open-title",children:(0,a.jsx)(eN,{locale:s||"zh-CN",t:e})}),(0,a.jsx)("section",{className:"mt-16","aria-labelledby":"steps-title",children:(0,a.jsx)(c,{title:"简单三步操作",subtitle:"选择适合的版本，轻松实现批量访问",steps:[{number:1,icon:(0,a.jsx)(ej.A,{className:"w-6 h-6"}),title:"选择版本",description:"根据需求选择初级、静默或自动化版本",content:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"初级版本"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"简单批量打开，无需安装插件"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-purple-600 font-semibold text-sm",children:"2"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"静默版本"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"云端真实访问，支持代理IP和自定义Referer"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-green-600 font-semibold text-sm",children:"3"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"自动化版本"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"定时任务，智能调度，24小时自动化运行"})]})]})]})},{number:2,icon:(0,a.jsx)(eT.A,{className:"w-6 h-6"}),title:"配置参数",description:"灵活配置访问参数，满足不同场景需求",content:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(eT.A,{className:"w-4 h-4 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"代理IP配置"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"支持多种代理协议，自动获取和验证代理池"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(e_.A,{className:"w-4 h-4 text-orange-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"访问模式选择"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"HTTP快速访问或Puppeteer真实浏览器渲染"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-blue-600 font-semibold text-sm",children:"⚙️"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"高级参数"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"循环次数、访问间隔、随机化策略等"})]})]})]})},{number:3,icon:(0,a.jsx)(q.A,{className:"w-6 h-6"}),title:"开始执行",description:"一键启动，实时监控，获取详细报告",content:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(q.A,{className:"w-4 h-4 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"实时监控"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"进度条实时显示，成功率和失败率一目了然"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-blue-600 font-semibold text-sm",children:"\uD83D\uDCCA"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"详细统计"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"访问时长、状态码、错误信息等完整记录"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-purple-600 font-semibold text-sm",children:"\uD83D\uDD04"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 text-base",children:"任务管理"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"支持暂停、终止、重试等多种操作"})]})]})]})}]})}),(0,a.jsxs)("section",{className:"mt-16 bg-white rounded-2xl shadow-lg p-8","aria-labelledby":"features-title",children:[(0,a.jsxs)("header",{className:"text-center mb-8",children:[(0,a.jsx)("h2",{id:"features-title",className:"text-2xl md:text-3xl font-bold text-gray-900 mb-4",children:"为什么选择我们的真实点击服务？"}),(0,a.jsx)("p",{className:"text-gray-600",children:"专业的云端访问解决方案，让您的营销更高效"})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",role:"list",children:[(0,a.jsxs)("div",{className:"text-center p-6 bg-blue-50 rounded-xl",role:"listitem",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4","aria-hidden":"true",children:(0,a.jsx)(eT.A,{className:"h-6 w-6 text-white"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"安全可靠"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"企业级安全保障，数据加密传输，保护您的隐私"})]}),(0,a.jsxs)("div",{className:"text-center p-6 bg-green-50 rounded-xl",role:"listitem",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4","aria-hidden":"true",children:(0,a.jsx)(q.A,{className:"h-6 w-6 text-white"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"高效快速"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"并发处理，智能调度，大幅提升处理效率"})]}),(0,a.jsxs)("div",{className:"text-center p-6 bg-purple-50 rounded-xl",role:"listitem",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4","aria-hidden":"true",children:(0,a.jsx)(e_.A,{className:"h-6 w-6 text-white"})}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"全球覆盖"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"多地区代理节点，模拟真实用户地理分布"})]})]})]})]})})})}},82622:(e,t,s)=>{Promise.resolve().then(s.bind(s,60646))}},e=>{var t=t=>e(e.s=t);e.O(0,[2076,4121,7358],()=>t(82622)),_N_E=e.O()}]);