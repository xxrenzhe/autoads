(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9557],{6096:(e,s,t)=>{Promise.resolve().then(t.bind(t,32173))},32173:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var a=t(54568),n=t(7620),l=t(49642),i=t.n(l),c=t(63353),r=t(64148),d=t(47227),x=t(18529),o=t(90721),m=t(33020),h=t(39756),j=t(89125),f=t(15051),u=t(75701),p=t(27047),N=t(73297),g=t(12344);function y(){let{data:e}=(0,N.I)({queryKey:["backend","health"],queryFn:async()=>(function(e){if(e&&"object"==typeof e){let s={};return"string"==typeof e.status&&(s.status=e.status),"string"==typeof e.message&&(s.message=e.message),"timestamp"in e&&(s.timestamp=e.timestamp),s}return{status:"unknown"}})(await g.H.get("/health")),staleTime:15e3,refetchInterval:3e4}),[s,t]=(0,n.useState)(null),[l,y]=(0,n.useState)({api:"online",database:"online",adspower:"offline",oauth:"online"}),[b,w]=(0,n.useState)(!0),[v,A]=(0,n.useState)(new Date);(0,n.useEffect)(()=>{Z(),B()},[]);let Z=async()=>{try{let e=await fetch("/build-info.json");if(e.ok){let s=await e.json();t(s)}}catch(e){console.error("加载构建信息失败:",e)}},B=async()=>{w(!0);try{let s=(null==e?void 0:e.status)==="ok"?"online":"degraded";y({api:s,database:"online",adspower:"offline",oauth:"online"})}catch(e){y({api:"offline",database:"online",adspower:"offline",oauth:"degraded"})}finally{w(!1),A(new Date)}},k=e=>{let s={online:{color:"bg-green-100 text-green-800",icon:x.A,label:"在线"},offline:{color:"bg-red-100 text-red-800",icon:o.A,label:"离线"},degraded:{color:"bg-yellow-100 text-yellow-800",icon:m.A,label:"降级"}},t=s[e]||s.offline,n=t.icon;return(0,a.jsxs)(r.E,{className:"".concat(t.color," flex items-center gap-1"),children:[(0,a.jsx)(n,{className:"h-3 w-3"}),t.label]})};return(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"系统状态"}),(0,a.jsx)("p",{className:"text-gray-600",children:"AdsCenter 系统运行状态和构建信息"})]}),(0,a.jsxs)(d.$,{onClick:B,disabled:b,children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2 ".concat(b?"animate-spin":"")}),"刷新状态"]})]}),(0,a.jsxs)(c.Zp,{className:"mb-6",children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c.ZB,{children:"整体状态"}),(0,a.jsx)(c.BT,{children:"系统整体运行状况"})]}),k((()=>{let e=Object.values(l);return e.every(e=>"online"===e)?"online":e.some(e=>"offline"===e)?"degraded":"online"})())]})}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["最后检查: ",v.toLocaleString()]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"API 服务"}),(0,a.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.Wu,{children:[k(l.api),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"后端 API 服务状态"})]})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"数据存储"}),(0,a.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.Wu,{children:[k(l.database),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"本地数据存储状态"})]})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"AdsPower"}),(0,a.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.Wu,{children:[k(l.adspower),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"需要本地 AdsPower 客户端"})]})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ZB,{className:"text-sm font-medium",children:"OAuth 服务"}),(0,a.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.Wu,{children:[k(l.oauth),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Google OAuth 授权服务"})]})]})]}),s&&(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"构建信息"}),(0,a.jsx)(c.BT,{children:"当前部署版本的构建详情"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"构建时间:"}),(0,a.jsx)("span",{className:"text-sm font-mono",children:new Date(s.buildTime).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"环境:"}),(0,a.jsx)(r.E,{variant:"production"===s.environment?"default":"secondary",children:s.environment})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"域名:"}),(0,a.jsx)("span",{className:"text-sm font-mono",children:s.domain})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Node.js:"}),(0,a.jsx)("span",{className:"text-sm font-mono",children:s.nodeVersion})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"平台:"}),(0,a.jsxs)("span",{className:"text-sm font-mono",children:[s.platform,"-",s.arch]})]}),s.vercelEnv&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Vercel 环境:"}),(0,a.jsx)("span",{className:"text-sm font-mono",children:s.vercelEnv})]}),s.branch&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"分支:"}),(0,a.jsx)("span",{className:"text-sm font-mono",children:s.branch})]}),s.commitSha&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"提交:"}),(0,a.jsx)("span",{className:"text-sm font-mono",children:s.commitSha.substring(0,7)})]})]})]})})]}),(0,a.jsxs)(c.Zp,{className:"mt-6",children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"快速链接"}),(0,a.jsx)(c.BT,{children:"常用功能和页面链接"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsx)(d.$,{variant:"outline",asChild:!0,children:(0,a.jsx)(i(),{href:"/adscenter",children:"主页面"})}),(0,a.jsx)(d.$,{variant:"outline",asChild:!0,children:(0,a.jsx)(i(),{href:"/adscenter/accounts",children:"账号管理"})}),(0,a.jsx)(d.$,{variant:"outline",asChild:!0,children:(0,a.jsx)(i(),{href:"/adscenter/executions",children:"执行监控"})}),(0,a.jsx)(d.$,{variant:"outline",asChild:!0,children:(0,a.jsx)(i(),{href:"/api/adscenter/system?action=health",children:"API 健康检查"})})]})})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2076,4121,7358],()=>s(6096)),_N_E=e.O()}]);