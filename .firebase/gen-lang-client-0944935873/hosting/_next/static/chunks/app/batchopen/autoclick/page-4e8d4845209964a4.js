(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8527],{3951:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var l=t(54568),r=t(7620),s=t(58482),i=t(8039),n=t(64303);function c(){let[e,a]=(0,r.useState)([]),[t,c]=(0,r.useState)(!0),[d,o]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),[h,y]=(0,r.useState)({name:"",urls:"",timezone:"US",timeWindow:"00:00-24:00",dailyTarget:100,refererType:"social",refererValue:"",proxyUrl:""});async function f(){c(!0);try{let e=await i.L.get("/batchopen/autoclick/schedules"),t=(Array.isArray(e)?e:(null==e?void 0:e.data)||[]).map(e=>{var a,t;return{id:e.id,name:e.name,timezone:e.timezone,timeWindow:e.timeWindow||e.time_window,dailyTarget:e.dailyTarget||e.daily_target,refererType:e.refererType||e.referer_type,refererValue:e.refererValue||e.referer_value,proxyUrl:null!=(t=null!=(a=e.proxyUrl)?a:e.proxy_url)?t:null,status:(e.status||"DISABLED").toUpperCase(),createdAt:e.createdAt||e.created_at||new Date().toISOString(),updatedAt:e.updatedAt||e.updated_at||new Date().toISOString()}});a(t)}catch(e){}c(!1)}async function j(){m(!0);try{let e={name:h.name,urls:h.urls.split("\n").map(e=>e.trim()).filter(Boolean),timezone:h.timezone,timeWindow:h.timeWindow,dailyTarget:h.dailyTarget,referer:{type:h.refererType,value:h.refererValue||void 0},proxyUrl:h.proxyUrl||void 0};x?await i.L.put("/batchopen/autoclick/schedules/".concat(x.id),e):await i.L.post("/batchopen/autoclick/schedules",e),o(!1),await f()}catch(e){alert("保存失败")}m(!1)}async function g(e){if(confirm("确认删除该任务？"))try{await i.L.delete("/batchopen/autoclick/schedules/".concat(e)),await f()}catch(e){alert("删除失败")}}async function v(e,a){try{await i.L.post("/batchopen/autoclick/schedules/".concat(e,"/").concat(a?"enable":"disable")),await f()}catch(e){alert("操作失败")}}async function N(e){try{let a=await fetch("/api/v2/autoclick/schedules/".concat(e,"/execution/current")),t=await a.json().catch(()=>({}));if(!a.ok||!(null==t?void 0:t.id))return void alert("当前无进行中任务");window.location.href="/adscenter/executions/v2/".concat(t.id)}catch(e){alert("获取进度失败")}}return(0,r.useEffect)(()=>{f()},[]),(0,l.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,l.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsx)("h1",{className:s.B8.typography.h2,children:"自动化点击任务"}),(0,l.jsx)(n.L,{featureName:"autoclick",onClick:function(){p(null),y({name:"",urls:"",timezone:"US",timeWindow:"00:00-24:00",dailyTarget:100,refererType:"social",refererValue:"",proxyUrl:""}),o(!0)},className:s.B8.buttons.primary,children:"新增任务"})]}),d&&(0,l.jsxs)("div",{className:"".concat(s.B8.cards.simple," p-6 mb-6"),children:[(0,l.jsx)("h3",{className:s.B8.typography.h3+" mb-4",children:x?"编辑任务":"新增任务"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"任务名称"}),(0,l.jsx)("input",{className:"w-full border rounded-lg px-3 py-2",value:h.name,onChange:e=>y({...h,name:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"国家/时区"}),(0,l.jsxs)("select",{className:"w-full border rounded-lg px-3 py-2",value:h.timezone,onChange:e=>y({...h,timezone:e.target.value}),children:[(0,l.jsx)("option",{value:"US",children:"美国 US (UTC-8)"}),(0,l.jsx)("option",{value:"CN",children:"中国 CN (UTC+8)"}),(0,l.jsx)("option",{value:"UK",children:"英国 UK (UTC+0)"}),(0,l.jsx)("option",{value:"JP",children:"日本 JP (UTC+9)"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"执行时间段"}),(0,l.jsxs)("select",{className:"w-full border rounded-lg px-3 py-2",value:h.timeWindow,onChange:e=>y({...h,timeWindow:e.target.value}),children:[(0,l.jsx)("option",{value:"00:00-24:00",children:"00:00-24:00"}),(0,l.jsx)("option",{value:"06:00-24:00",children:"06:00-24:00"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"每日点击总数"}),(0,l.jsx)("input",{type:"number",min:1,className:"w-full border rounded-lg px-3 py-2",value:h.dailyTarget,onChange:e=>y({...h,dailyTarget:Number(e.target.value||0)})})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"URL 列表（每行一个）"}),(0,l.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 min-h-[120px]",value:h.urls,onChange:e=>y({...h,urls:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Referer 类型"}),(0,l.jsxs)("select",{className:"w-full border rounded-lg px-3 py-2",value:h.refererType,onChange:e=>y({...h,refererType:e.target.value}),children:[(0,l.jsx)("option",{value:"social",children:"社媒"}),(0,l.jsx)("option",{value:"custom",children:"自定义"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"Referer 值（可选）"}),(0,l.jsx)("input",{className:"w-full border rounded-lg px-3 py-2",value:h.refererValue,onChange:e=>y({...h,refererValue:e.target.value}),placeholder:"https://www.facebook.com/"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"text-sm text-gray-600",children:"代理（可选）"}),(0,l.jsx)("input",{className:"w-full border rounded-lg px-3 py-2",value:h.proxyUrl,onChange:e=>y({...h,proxyUrl:e.target.value}),placeholder:"http://user:pass@ip:port"})]})]}),(0,l.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,l.jsx)("button",{className:s.B8.buttons.outline,onClick:()=>o(!1),children:"取消"}),(0,l.jsx)(n.L,{featureName:"autoclick",onClick:j,disabled:u,className:s.B8.buttons.primary,children:u?"保存中...":"保存"})]})]}),(0,l.jsx)("div",{className:"".concat(s.B8.cards.simple," p-6"),children:t?(0,l.jsx)("div",{className:"text-center text-gray-600",children:"加载中..."}):0===e.length?(0,l.jsx)("div",{className:"text-center text-gray-600",children:"暂无任务，点击“新增任务”创建"}):(0,l.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,l.jsxs)("div",{className:"border rounded-xl p-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"font-semibold text-gray-900",children:e.name}),(0,l.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[e.timezone," \xb7 ",e.timeWindow," \xb7 每日 ",e.dailyTarget," 次"]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["状态：","ENABLED"===e.status?"已启动":"未启动"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{className:s.B8.buttons.outline,onClick:()=>{p(e),y({name:e.name,urls:"",timezone:e.timezone,timeWindow:e.timeWindow,dailyTarget:e.dailyTarget,refererType:e.refererType||"social",refererValue:e.refererValue||"",proxyUrl:e.proxyUrl||""}),o(!0)},children:"编辑"}),(0,l.jsx)("button",{className:s.B8.buttons.outline,onClick:()=>g(e.id),children:"删除"}),"ENABLED"===e.status?(0,l.jsx)(n.L,{featureName:"autoclick",className:s.B8.buttons.outline,onClick:()=>v(e.id,!1),children:"停止"}):(0,l.jsx)(n.L,{featureName:"autoclick",className:s.B8.buttons.primary,onClick:()=>v(e.id,!0),children:"启动"}),(0,l.jsx)(n.L,{featureName:"autoclick",className:s.B8.buttons.outline,onClick:()=>N(e.id),children:"查看进度"})]})]},e.id))})})]})})}},99182:(e,a,t)=>{Promise.resolve().then(t.bind(t,3951))}},e=>{var a=a=>e(e.s=a);e.O(0,[2076,4121,7358],()=>a(99182)),_N_E=e.O()}]);