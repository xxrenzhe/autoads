(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9733],{87846:(s,e,a)=>{Promise.resolve().then(a.bind(a,88153))},88153:(s,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>w});var l=a(54568),i=a(7620),t=a(47227),n=a(63353),c=a(64148),r=a(48474),d=a(84748),x=a(18529),m=a(90721),h=a(33020),j=a(6541),o=a(72825),u=a(80035),f=a(39756),p=a(62708),N=a(22878),v=a(28359),g=a(3761),y=a(70111);function w(){let[s,e]=(0,i.useState)([]),[a,w]=(0,i.useState)(!0),[b,Z]=(0,i.useState)(null),[T,C]=(0,i.useState)(!1),[R,A]=(0,i.useState)(!1);(0,i.useEffect)(()=>{k()},[]);let k=async()=>{try{w(!0),e([{id:"1",name:"每日链接更新",description:"每天凌晨2点自动更新所有链接",cronExpression:"0 2 * * *",configurationId:"config-1",status:"active",lastRun:"2024-01-15T02:00:00Z",nextRun:"2024-01-16T02:00:00Z",executionHistory:[{id:"exec-1",status:"success",startTime:"2024-01-15T02:00:00Z",endTime:"2024-01-15T02:15:00Z",duration:9e5},{id:"exec-2",status:"success",startTime:"2024-01-14T02:00:00Z",endTime:"2024-01-14T02:18:00Z",duration:108e4}],settings:{retryCount:3,timeout:36e5,notifications:!0,maxConcurrent:5}},{id:"2",name:"每周报告生成",description:"每周一生成执行报告",cronExpression:"0 9 * * 1",configurationId:"config-2",status:"active",lastRun:"2024-01-15T09:00:00Z",nextRun:"2024-01-22T09:00:00Z",executionHistory:[{id:"exec-3",status:"success",startTime:"2024-01-15T09:00:00Z",endTime:"2024-01-15T09:05:00Z",duration:3e5}],settings:{retryCount:1,timeout:18e5,notifications:!0,maxConcurrent:1}},{id:"3",name:"实时监控任务",description:"每小时检查系统状态",cronExpression:"0 * * * *",configurationId:"config-3",status:"paused",lastRun:"2024-01-15T14:00:00Z",nextRun:"2024-01-15T15:00:00Z",executionHistory:[{id:"exec-4",status:"failed",startTime:"2024-01-15T14:00:00Z",endTime:"2024-01-15T14:05:00Z",duration:3e5}],settings:{retryCount:2,timeout:6e5,notifications:!1,maxConcurrent:3}}])}catch(s){console.error("加载定时任务失败:",s)}finally{w(!1)}},E=async(s,a)=>{try{let l="active"===a?"paused":"active";e(e=>{var a;return null==e||null==(a=e.filter(Boolean))?void 0:a.map(e=>e.id===s?{...e,status:l}:e)})}catch(s){console.error("切换任务状态失败:",s)}},W=async s=>{if(confirm("确定要删除这个定时任务吗？"))try{e(e=>e.filter(e=>e.id!==s))}catch(s){console.error("删除任务失败:",s)}},B=s=>{let e={active:r.A,paused:d.A,completed:x.A,failed:m.A}[s]||h.A;return(0,l.jsxs)(c.E,{variant:{active:"default",paused:"secondary",completed:"default",failed:"destructive"}[s]||"default",className:"flex items-center gap-1",children:[(0,l.jsx)(e,{className:"h-3 w-3"}),{active:"运行中",paused:"已暂停",completed:"已完成",failed:"失败"}[s]||s]})},I=s=>new Date(s).toLocaleString(),H=s=>{let e=Math.floor(s/1e3),a=Math.floor(e/60),l=Math.floor(a/60);return l>0?"".concat(l,"小时").concat(a%60,"分钟"):a>0?"".concat(a,"分钟").concat(e%60,"秒"):"".concat(e,"秒")},S=s=>{let{task:e}=s;return(0,l.jsxs)(n.Zp,{className:"hover:shadow-lg transition-shadow",children:[(0,l.jsx)(n.aR,{children:(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(n.ZB,{className:"text-lg",children:e.name}),(0,l.jsx)(n.BT,{children:e.description})]}),B(e.status)]})}),(0,l.jsx)(n.Wu,{children:(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Cron表达式:"}),(0,l.jsx)("div",{className:"font-mono text-xs bg-gray-100 p-1 rounded mt-1",children:e.cronExpression})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-600",children:"配置ID:"}),(0,l.jsx)("div",{className:"font-mono text-xs",children:e.configurationId.slice(-8)})]})]}),(0,l.jsxs)("div",{className:"text-sm",children:[e.lastRun&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"上次运行:"}),(0,l.jsx)("span",{children:I(e.lastRun)})]}),e.nextRun&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"下次运行:"}),(0,l.jsx)("span",{children:I(e.nextRun)})]})]}),(0,l.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,l.jsxs)(t.$,{size:"sm",variant:"outline",onClick:()=>{Z(e),A(!0)},children:[(0,l.jsx)(j.A,{className:"h-4 w-4 mr-1"}),"详情"]}),(0,l.jsx)(t.$,{size:"sm",variant:"outline",onClick:()=>E(e.id,e.status),children:"active"===e.status?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"暂停"]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.A,{className:"h-4 w-4 mr-1"}),"启动"]})}),(0,l.jsxs)(t.$,{size:"sm",variant:"outline",onClick:()=>W(e.id),children:[(0,l.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"删除"]})]})]})})]})};return a?(0,l.jsx)("div",{className:"container mx-auto p-6",children:(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{children:"加载定时任务中..."})]})})}):(0,l.jsxs)("div",{className:"container mx-auto p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"定时任务"}),(0,l.jsx)("p",{className:"text-gray-600",children:"管理和监控自动化任务的定时执行"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(t.$,{onClick:k,variant:"outline",children:[(0,l.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"刷新"]}),(0,l.jsxs)(t.$,{onClick:()=>C(!0),children:[(0,l.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"创建任务"]})]})]}),(0,l.jsxs)(g.tU,{defaultValue:"active",className:"w-full",children:[(0,l.jsxs)(g.j7,{className:"grid w-full grid-cols-3",children:[(0,l.jsxs)(g.Xi,{value:"active",children:["活跃任务 (",s.filter(s=>"active"===s.status).length,")"]}),(0,l.jsxs)(g.Xi,{value:"paused",children:["已暂停 (",s.filter(s=>"paused"===s.status).length,")"]}),(0,l.jsxs)(g.Xi,{value:"all",children:["全部任务 (",s.length,")"]})]}),(0,l.jsx)(g.av,{value:"active",className:"space-y-6",children:0===s.filter(s=>"active"===s.status).length?(0,l.jsx)(n.Zp,{children:(0,l.jsxs)(n.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,l.jsx)(N.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"暂无活跃任务"}),(0,l.jsx)("p",{className:"text-gray-600",children:"当前没有正在运行的定时任务"})]})}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.filter(s=>"active"===s.status).map(s=>(0,l.jsx)(S,{task:s},s.id))})}),(0,l.jsx)(g.av,{value:"paused",className:"space-y-6",children:0===s.filter(s=>"paused"===s.status).length?(0,l.jsx)(n.Zp,{children:(0,l.jsxs)(n.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,l.jsx)(d.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"暂无暂停任务"}),(0,l.jsx)("p",{className:"text-gray-600",children:"没有暂停的定时任务"})]})}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.filter(s=>"paused"===s.status).map(s=>(0,l.jsx)(S,{task:s},s.id))})}),(0,l.jsx)(g.av,{value:"all",className:"space-y-6",children:0===s.length?(0,l.jsx)(n.Zp,{children:(0,l.jsxs)(n.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,l.jsx)(N.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"暂无定时任务"}),(0,l.jsx)("p",{className:"text-gray-600",children:"还没有创建任何定时任务"})]})}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(s=>(0,l.jsx)(S,{task:s},s.id))})})]}),(0,l.jsx)(v.lG,{open:R,onOpenChange:A,children:(0,l.jsxs)(v.Cf,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,l.jsxs)(v.c7,{children:[(0,l.jsx)(v.L3,{children:"任务详情"}),(0,l.jsx)(v.rr,{children:"查看定时任务的详细信息和配置"})]}),b&&(0,l.jsx)(s=>{let{task:e}=s;return(0,l.jsxs)(g.tU,{defaultValue:"overview",className:"w-full",children:[(0,l.jsxs)(g.j7,{className:"grid w-full grid-cols-3",children:[(0,l.jsx)(g.Xi,{value:"overview",children:"概览"}),(0,l.jsx)(g.Xi,{value:"history",children:"执行历史"}),(0,l.jsx)(g.Xi,{value:"settings",children:"设置"})]}),(0,l.jsxs)(g.av,{value:"overview",className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{className:"pb-2",children:(0,l.jsx)(n.ZB,{className:"text-sm",children:"任务状态"})}),(0,l.jsx)(n.Wu,{children:B(e.status)})]}),(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{className:"pb-2",children:(0,l.jsx)(n.ZB,{className:"text-sm",children:"执行次数"})}),(0,l.jsx)(n.Wu,{children:(0,l.jsx)("div",{className:"text-2xl font-bold",children:e.executionHistory.length})})]})]}),(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{children:(0,l.jsx)(n.ZB,{className:"text-sm",children:"任务信息"})}),(0,l.jsxs)(n.Wu,{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"任务ID:"}),(0,l.jsx)("span",{className:"font-mono",children:e.id})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"配置ID:"}),(0,l.jsx)("span",{className:"font-mono",children:e.configurationId})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Cron表达式:"}),(0,l.jsx)("span",{className:"font-mono",children:e.cronExpression})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"描述:"}),(0,l.jsx)("span",{children:e.description})]}),e.lastRun&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"上次运行:"}),(0,l.jsx)("span",{children:I(e.lastRun)})]}),e.nextRun&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"下次运行:"}),(0,l.jsx)("span",{children:I(e.nextRun)})]})]})]})]}),(0,l.jsx)(g.av,{value:"history",className:"space-y-4",children:0===e.executionHistory.length?(0,l.jsxs)(y.Fc,{children:[(0,l.jsx)(u.A,{className:"h-4 w-4"}),(0,l.jsx)(y.TN,{children:"暂无执行历史"})]}):e.executionHistory.map((s,e)=>(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{className:"pb-2",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)(n.ZB,{className:"text-sm",children:["执行 #",s.id.slice(-8)]}),(0,l.jsx)(c.E,{variant:"success"===s.status?"default":"destructive",children:"success"===s.status?"成功":"失败"})]})}),(0,l.jsx)(n.Wu,{children:(0,l.jsxs)("div",{className:"text-sm space-y-1",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"开始时间:"}),(0,l.jsx)("span",{children:I(s.startTime)})]}),s.endTime&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"结束时间:"}),(0,l.jsx)("span",{children:I(s.endTime)})]}),s.duration&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"持续时间:"}),(0,l.jsx)("span",{children:H(s.duration)})]})]})})]},e))}),(0,l.jsx)(g.av,{value:"settings",className:"space-y-4",children:(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{children:(0,l.jsx)(n.ZB,{className:"text-sm",children:"任务设置"})}),(0,l.jsxs)(n.Wu,{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"重试次数:"}),(0,l.jsx)("span",{children:e.settings.retryCount})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"超时时间:"}),(0,l.jsx)("span",{children:H(e.settings.timeout)})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"通知启用:"}),(0,l.jsx)("span",{children:e.settings.notifications?"是":"否"})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"最大并发数:"}),(0,l.jsx)("span",{children:e.settings.maxConcurrent})]})]})]})})]})},{task:b})]})}),(0,l.jsx)(v.lG,{open:T,onOpenChange:C,children:(0,l.jsxs)(v.Cf,{className:"max-w-2xl",children:[(0,l.jsxs)(v.c7,{children:[(0,l.jsx)(v.L3,{children:"创建定时任务"}),(0,l.jsx)(v.rr,{children:"配置新的定时执行任务"})]}),(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)(y.Fc,{children:[(0,l.jsx)(u.A,{className:"h-4 w-4"}),(0,l.jsx)(y.TN,{children:"任务创建功能正在开发中，敬请期待！"})]})})]})})]})}}},s=>{var e=e=>s(s.s=e);s.O(0,[2076,4121,7358],()=>e(87846)),_N_E=s.O()}]);