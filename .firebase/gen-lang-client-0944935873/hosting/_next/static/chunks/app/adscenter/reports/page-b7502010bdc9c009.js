(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9638],{47089:(e,s,a)=>{Promise.resolve().then(a.bind(a,86271))},86271:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>v});var t=a(54568),l=a(7620),c=a(58482),i=a(47227),r=a(64148),n=a(3761),d=a(39756),x=a(73146),m=a(44023),o=a(66043),h=a(33020),j=a(557),u=a(97904),p=a(51603),g=a(4376),f=a(48790);function N(){let[e,s]=(0,l.useState)(null),[a,N]=(0,l.useState)(!1),[v,y]=(0,l.useState)("7d"),[b,w]=(0,l.useState)("overview");(0,l.useEffect)(()=>{B()},[v]);let B=async()=>{try{N(!0);let e=new Date,a=new Date;switch(v){case"7d":a.setDate(e.getDate()-7);break;case"30d":a.setDate(e.getDate()-30);break;case"90d":a.setDate(e.getDate()-90);break;case"all":a=new Date(0)}let t=[].filter(e=>e.startTime>=a),l=S(t,{start:a,end:e});s(l)}catch(e){console.error("加载报告数据失败:",e)}finally{N(!1)}},S=(e,s)=>{var a,t;let l={totalSessions:e.length,completedSessions:e.filter(e=>"completed"===e.status).length,failedSessions:e.filter(e=>"failed"===e.status).length,successRate:0,averageDuration:0,totalExecutionTime:0};l.successRate=l.totalSessions>0?l.completedSessions/l.totalSessions*100:0;let c=null==(t=e.filter(e=>void 0!==e.duration))||null==(a=t.filter(Boolean))?void 0:a.map(e=>e.duration);l.averageDuration=c.length>0?c.reduce((e,s)=>e+s,0)/c.length:0,l.totalExecutionTime=c.reduce((e,s)=>e+s,0);let i={};e.forEach(e=>{i[e.type]||(i[e.type]={count:0,success:0,failed:0,averageDuration:0}),i[e.type].count++,"completed"===e.status?i[e.type].success++:"failed"===e.status&&i[e.type].failed++}),Object.keys(i).forEach(s=>{let a=e.filter(e=>e.type===s&&e.duration),t=a.length>0?a.reduce((e,s)=>e+(s.duration||0),0)/a.length:0;i[s].averageDuration=t});let r={};e.forEach(e=>{r[e.status]=(r[e.status]||0)+1});let n=Array.from({length:24},(s,a)=>({hour:a,count:e.filter(e=>e.startTime.getHours()===a).length})),d=[],x=Math.min(90,Math.ceil((s.end.getTime()-s.start.getTime())/864e5));for(let s=x-1;s>=0;s--){let a=new Date;a.setDate(a.getDate()-s);let t=a.toISOString().split("T")[0],l=e.filter(e=>e.startTime.toISOString().split("T")[0]===t),c=l.filter(e=>"completed"===e.status).length,i=l.length>0?c/l.length*100:0;d.push({date:t,sessions:l.length,successRate:i})}return{sessions:e,timeRange:s,summary:l,performance:{byType:i,byStatus:r,hourlyDistribution:n,dailyTrend:d}}},D=s=>{if(e)if("csv"===s){var a,t,l,c;let s=new Blob([((t=[["会话ID","名称","类型","状态","开始时间","结束时间","执行时长","进度","错误信息"],...null==(c=e.sessions)||null==(l=c.filter(Boolean))?void 0:l.map(e=>{var s,a;return[e.id,e.name,e.type,e.status,e.startTime.toISOString(),(null==(s=e.endTime)?void 0:s.toISOString())||"",(null==(a=e.duration)?void 0:a.toString())||"","".concat(e.progress.current,"/").concat(e.progress.total),e.error||""]})],false),null==(a=t.filter(Boolean)))?void 0:a.map(e=>e.join(",")).join("\n")],{type:"text/csv"}),i=URL.createObjectURL(s),r=document.createElement("a");r.href=i,r.download="execution-report-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),URL.revokeObjectURL(i)}else{let s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="execution-report-".concat(new Date().toISOString().split("T")[0],".json"),t.click(),URL.revokeObjectURL(a)}},A=e=>e<1e3?"".concat(e,"ms"):e<6e4?"".concat((e/1e3).toFixed(1),"s"):e<36e5?"".concat((e/6e4).toFixed(1),"min"):"".concat((e/36e5).toFixed(1),"h"),O=e=>e.toLocaleString("zh-CN");return e?(0,t.jsx)("div",{className:"min-h-screen ".concat(c.B8.gradients.hero),children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)("div",{className:"text-center mb-12",children:[(0,t.jsx)("h1",{className:c.B8.typography.h1,children:"\uD83D\uDCCA 数据分析报告"}),(0,t.jsx)("p",{className:"".concat(c.B8.typography.subtitle," max-w-3xl mx-auto"),children:"全面的执行数据分析，包含成功率、执行时间、性能指标的趋势分析和可视化报告"})]}),(0,t.jsx)("div",{className:"".concat(c.B8.cards.featured," p-6 mb-8"),children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"text-center lg:text-left",children:[(0,t.jsxs)("h2",{className:c.B8.typography.h2+" flex items-center justify-center lg:justify-start gap-2 mb-2",children:[(0,t.jsx)(x.A,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"数据分析报告"})]}),(0,t.jsx)("p",{className:"".concat(c.B8.typography.body," max-w-2xl"),children:"查看执行统计和性能分析"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["7d","30d","90d","all"].map(e=>(0,t.jsx)(i.$,{variant:v===e?"default":"ghost",size:"sm",onClick:()=>y(e),className:"text-xs",children:"7d"===e?"7天":"30d"===e?"30天":"90d"===e?"90天":"全部"},e))}),(0,t.jsx)(i.$,{variant:"outline",onClick:B,disabled:a,children:(0,t.jsx)(d.A,{className:"h-4 w-4 ".concat(a?"animate-spin":"")})})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,t.jsx)(m.A,{className:"h-6 w-6 text-blue-600"})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:e.summary.totalSessions}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"总会话数"})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"时间范围内总计"})]}),(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:(0,t.jsx)(o.A,{className:"h-6 w-6 text-green-600"})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:[e.summary.successRate.toFixed(1),"%"]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"成功率"})]})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[e.summary.completedSessions," 成功 / ",e.summary.failedSessions," 失败"]})]}),(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:(0,t.jsx)(h.A,{className:"h-6 w-6 text-purple-600"})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:A(e.summary.averageDuration)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"平均时长"})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"平均执行时间"})]}),(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:(0,t.jsx)(j.A,{className:"h-6 w-6 text-orange-600"})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:A(e.summary.totalExecutionTime)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"总执行时间"})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"累计执行时间"})]}),(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center",children:(0,t.jsx)(u.A,{className:"h-6 w-6 text-indigo-600"})}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:"导出"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"报告"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(i.$,{size:"sm",onClick:()=>D("csv"),className:c.B8.buttons.primary,children:"CSV"}),(0,t.jsx)(i.$,{size:"sm",variant:"outline",onClick:()=>D("json"),children:"JSON"})]})]})]}),(0,t.jsx)("div",{className:c.B8.cards.default+" p-6",children:(0,t.jsxs)(n.tU,{value:b,onValueChange:e=>w(e),children:[(0,t.jsxs)(n.j7,{className:"grid w-full grid-cols-4 mb-6",children:[(0,t.jsxs)(n.Xi,{value:"overview",className:"flex items-center gap-2",children:[(0,t.jsx)(p.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"概览"})]}),(0,t.jsxs)(n.Xi,{value:"performance",className:"flex items-center gap-2",children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"性能分析"})]}),(0,t.jsxs)(n.Xi,{value:"executions",className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"执行记录"})]}),(0,t.jsxs)(n.Xi,{value:"analytics",className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"趋势分析"})]})]}),(0,t.jsxs)(n.av,{value:"overview",className:"space-y-6",children:[(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("h3",{className:c.B8.typography.h3+" flex items-center gap-2 mb-6",children:[(0,t.jsx)(p.A,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"按类型统计"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(e.performance.byType).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:c.B8.cards.default+" p-4",children:[(0,t.jsx)("h4",{className:"font-semibold mb-4",children:s}),(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"总数量:"}),(0,t.jsx)("span",{className:"font-medium",children:a.count})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"成功:"}),(0,t.jsx)("span",{className:"text-green-600",children:a.success})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"失败:"}),(0,t.jsx)("span",{className:"text-red-600",children:a.failed})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"成功率:"}),(0,t.jsxs)("span",{className:"font-medium",children:[a.count>0?(a.success/a.count*100).toFixed(1):0,"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"平均时长:"}),(0,t.jsx)("span",{className:"font-medium",children:A(a.averageDuration)})]})]})]},s)})})]}),(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("h3",{className:c.B8.typography.h3+" flex items-center gap-2 mb-6",children:[(0,t.jsx)(m.A,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"按状态统计"})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:Object.entries(e.performance.byStatus).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6 text-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold mb-2",children:a}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:s})]},s)})})]})]}),(0,t.jsx)(n.av,{value:"performance",className:"space-y-6",children:(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("h3",{className:c.B8.typography.h3+" flex items-center gap-2 mb-6",children:[(0,t.jsx)(h.A,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"小时分布"})]}),(0,t.jsx)("p",{className:"".concat(c.B8.typography.body," mb-6"),children:"24小时内执行会话分布情况"}),(0,t.jsx)("div",{className:"space-y-3",children:e.performance.hourlyDistribution.map(s=>{var a,l;return(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"w-16 text-sm font-medium",children:[s.hour,":00"]}),(0,t.jsxs)("div",{className:"flex-1 bg-gray-200 rounded-full h-6 relative",children:[(0,t.jsx)("div",{className:"bg-blue-600 h-6 rounded-full transition-all",style:{width:"".concat(s.count/Math.max(...null==(l=e.performance.hourlyDistribution)||null==(a=l.filter(Boolean))?void 0:a.map(e=>e.count))*100,"%")}}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium",children:s.count})]})]},s.hour)})})]})}),(0,t.jsx)(n.av,{value:"executions",className:"space-y-6",children:(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("h3",{className:c.B8.typography.h3+" flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"执行记录"})]}),(0,t.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"过滤"]})]}),(0,t.jsx)("p",{className:"".concat(c.B8.typography.body," mb-6"),children:"详细的执行会话记录"}),(0,t.jsxs)("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[e.sessions.map(e=>(0,t.jsxs)("div",{className:c.B8.cards.default+" p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.type})]}),(0,t.jsx)(r.E,{className:"completed"===e.status?"bg-green-100 text-green-800":"failed"===e.status?"bg-red-100 text-red-800":"running"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:e.status})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"开始时间"}),(0,t.jsx)("p",{children:O(e.startTime)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"执行时长"}),(0,t.jsx)("p",{children:e.duration?A(e.duration):"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"进度"}),(0,t.jsxs)("p",{children:[e.progress.current,"/",e.progress.total]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"成功率"}),(0,t.jsxs)("p",{children:[e.progress.total>0?(e.progress.current/e.progress.total*100).toFixed(1):0,"%"]})]})]}),e.error&&(0,t.jsx)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:e.error})]},e.id)),0===e.sessions.length&&(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(g.A,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),(0,t.jsx)("p",{className:"text-lg",children:"暂无执行记录"})]})]})]})}),(0,t.jsx)(n.av,{value:"analytics",className:"space-y-6",children:(0,t.jsxs)("div",{className:c.B8.cards.default+" p-6",children:[(0,t.jsxs)("h3",{className:c.B8.typography.h3+" flex items-center gap-2 mb-6",children:[(0,t.jsx)(j.A,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"每日趋势"})]}),(0,t.jsx)("p",{className:"".concat(c.B8.typography.body," mb-6"),children:"执行数量和成功率趋势"}),(0,t.jsx)("div",{className:"space-y-3",children:e.performance.dailyTrend.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-24 text-sm font-medium",children:e.date}),(0,t.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-4 relative",children:(0,t.jsx)("div",{className:"bg-blue-600 h-4 rounded-full",style:{width:"".concat(Math.min(10*e.sessions,100),"%")}})}),(0,t.jsx)("span",{className:"text-sm w-12",children:e.sessions})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-4 relative",children:(0,t.jsx)("div",{className:"bg-green-600 h-4 rounded-full",style:{width:"".concat(e.successRate,"%")}})}),(0,t.jsxs)("span",{className:"text-sm w-12",children:[e.successRate.toFixed(0),"%"]})]})]})]},e.date))})]})})]})})]})})}):(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.A,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-lg",children:"加载报告数据..."})]})})}function v(){return(0,t.jsx)(N,{})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2076,4121,7358],()=>s(47089)),_N_E=e.O()}]);