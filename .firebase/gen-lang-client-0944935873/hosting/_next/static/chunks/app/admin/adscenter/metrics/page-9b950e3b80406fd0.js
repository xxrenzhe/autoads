(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2024],{61557:(e,s,a)=>{Promise.resolve().then(a.bind(a,93864))},93864:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>u});var t=a(54568),l=a(7620),c=a(63353),n=a(47227),r=a(65165),i=a(67474),d=a(51874),o=a(89223);function u(){let{data:e}=(0,o.useSession)();(0,l.useEffect)(()=>{var s;let a=null==e||null==(s=e.user)?void 0:s.role;a&&"ADMIN"===String(a).toUpperCase()||(window.location.href="/ops/console/login")},[e]);let[s,a]=(0,l.useState)(""),[u,m]=(0,l.useState)("mock"),[h,v]=(0,l.useState)(7),p=async()=>{var e;let a=new URLSearchParams;s.trim()&&a.set("userId",s.trim()),u.trim()&&a.set("account",u.trim()),h>0&&a.set("days",String(h));let t=await fetch("/api/v2/admin/adscenter/metrics/backfill?".concat(a.toString()),{method:"POST"}),l=await t.json().catch(()=>({}));if(!t.ok||(null==l?void 0:l.ok)!==!0)return void d.oR.error((null==l?void 0:l.message)||"回填失败");d.oR.success("回填完成，插入 ".concat(null!=(e=null==l?void 0:l.inserted)?e:0))},x=async()=>{let e=Date.now(),s=document.createElement("a");s.href="/api/v2/admin/adscenter/google-ads/credentials/export",s.download="google_ads_credentials_".concat(e,".csv"),document.body.appendChild(s),s.click(),s.remove()};return(0,t.jsxs)("div",{className:"max-w-3xl mx-auto p-6 space-y-6",children:[(0,t.jsxs)(c.Zp,{className:"p-6 space-y-3",children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:"指标回填"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.J,{children:"User ID（可选）"}),(0,t.jsx)(r.p,{value:s,onChange:e=>a(e.target.value),placeholder:"不填则对全部活跃账号"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.J,{children:"Account（可选）"}),(0,t.jsx)(r.p,{value:u,onChange:e=>m(e.target.value),placeholder:"customerId 或 mock"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.J,{children:"Days"}),(0,t.jsx)(r.p,{type:"number",value:h,onChange:e=>v(parseInt(e.target.value||"7"))})]})]}),(0,t.jsx)(n.$,{onClick:p,children:"触发回填"})]}),(0,t.jsxs)(c.Zp,{className:"p-6 space-y-3",children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:"导出凭据"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"导出脱敏后的 google_ads_configs（userId/customerId/name/is_active/updated_at）。"}),(0,t.jsx)(n.$,{onClick:x,children:"导出 CSV"})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2076,4121,7358],()=>s(61557)),_N_E=e.O()}]);