(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2646],{92374:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y,dynamic:()=>N});var l=s(54568),a=s(7620),r=s(62942),c=s(47227),n=s(63353),i=s(65165),d=s(67474),o=s(70111),x=s(51747),h=s(80035),m=s(65837),u=s(6541),p=s(49642),j=s.n(p);let N="force-dynamic";function y(){var e;let t=(0,r.useRouter)(),s=(0,r.useSearchParams)(),[p,N]=(0,a.useState)(""),[y,v]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1),[w,b]=(0,a.useState)(!1),[S,k]=(0,a.useState)(null!=(e=null==s?void 0:s.get("error"))?e:null),_=async e=>{e.preventDefault(),b(!0),k(null);try{let e=await fetch("/ops/admin/login",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:p,password:y})});if(!e.ok){k("邮箱或密码错误"),b(!1);return}let l=null;try{l=await e.json()}catch(e){}let a=(null==l?void 0:l.token)||(null==l?void 0:l.access_token)||(null==l?void 0:l.jwt);if(!a){k("登录响应异常"),b(!1);return}let r="https:"===window.location.protocol,c=["Path=/; SameSite=Lax","Max-Age=".concat(21600),r?"Secure":""].filter(Boolean).join("; ");document.cookie="OPS_ADMIN_TOKEN=".concat(encodeURIComponent(a),"; ").concat(c);let n=(null==s?void 0:s.get("callbackUrl"))||"/ops/console/panel";t.push(n),t.refresh()}catch(e){k("登录失败，请稍后重试")}finally{b(!1)}};return(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)(x.A,{className:"h-8 w-8 text-white"})}),(0,l.jsx)("h1",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"管理员登录"}),(0,l.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"仅管理员可使用账号密码登录，普通用户请使用Google登录"})]}),S&&(0,l.jsxs)(o.Fc,{variant:"destructive",children:[(0,l.jsx)(h.A,{className:"h-4 w-4"}),(0,l.jsx)(o.TN,{children:S})]}),(0,l.jsxs)(n.Zp,{children:[(0,l.jsxs)(n.aR,{children:[(0,l.jsxs)(n.ZB,{className:"flex items-center text-xl",children:[(0,l.jsx)(x.A,{className:"mr-2 h-5 w-5"}),"管理员控制台"]}),(0,l.jsx)(n.BT,{children:"仅限系统管理员和超级管理员访问"})]}),(0,l.jsxs)(n.Wu,{className:"space-y-6",children:[(0,l.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(d.J,{htmlFor:"email",children:"邮箱地址"}),(0,l.jsx)(i.p,{id:"email",type:"email",value:p,onChange:e=>N(e.target.value),required:!0,className:"mt-1",placeholder:"请输入管理员邮箱"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d.J,{htmlFor:"password",children:"密码"}),(0,l.jsxs)("div",{className:"relative mt-1",children:[(0,l.jsx)(i.p,{id:"password",type:f?"text":"password",value:y,onChange:e=>v(e.target.value),required:!0,placeholder:"请输入密码",className:"pr-10"}),(0,l.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>g(!f),children:f?(0,l.jsx)(m.A,{className:"h-4 w-4 text-gray-400"}):(0,l.jsx)(u.A,{className:"h-4 w-4 text-gray-400"})})]})]}),(0,l.jsx)(c.$,{type:"submit",disabled:w,className:"w-full",size:"lg",children:w?"登录中...":"登录"})]}),(0,l.jsx)("div",{className:"mt-6 text-center",children:(0,l.jsx)(j(),{href:"/",className:"text-sm text-gray-600 hover:text-gray-900",children:"返回首页"})})]})]}),(0,l.jsxs)("div",{className:"text-center text-xs text-gray-500",children:[(0,l.jsx)("p",{children:"• 仅限授权管理员访问"}),(0,l.jsx)("p",{children:"• 请妥善保管您的登录凭证"}),(0,l.jsx)("p",{children:"• 登录失败将被记录"})]})]})})}},96529:(e,t,s)=>{Promise.resolve().then(s.bind(s,92374))}},e=>{var t=t=>e(e.s=t);e.O(0,[2076,4121,7358],()=>t(96529)),_N_E=e.O()}]);