(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5928],{75487:(e,s,a)=>{Promise.resolve().then(a.bind(a,98797))},98797:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var t=a(54568),r=a(7620);async function n(){let e=await fetch("/api/offers",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error((await e.json().catch(()=>({message:"Failed to fetch offers"}))).message||"An unknown error occurred");return e.json()}async function l(e){let s=await fetch("/api/offers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json().catch(()=>({message:"Failed to create offer"}))).message||"An unknown error occurred");return s.json()}var i=a(47227),c=a(89609),d=a(28359),o=a(65165),h=a(67474),m=a(25980),x=a(50839);function f(){let[e,s]=(0,r.useState)([]),[a,f]=(0,r.useState)(!0),[u,j]=(0,r.useState)(null),[p,g]=(0,r.useState)(!1),[N,y]=(0,r.useState)(""),[w,v]=(0,r.useState)(""),[C,b]=(0,r.useState)(!1),[S,A]=(0,r.useState)(null),O=async()=>{try{f(!0),j(null);let e=await n();s(e)}catch(e){j(e.message||"Failed to load offers.")}finally{f(!1)}};(0,r.useEffect)(()=>{O()},[]);let E=async e=>{if(e.preventDefault(),b(!0),A(null),!N||!w){A("Both name and URL are required."),b(!1);return}try{await l({name:N,originalUrl:w}),y(""),v(""),g(!1),await O()}catch(e){A(e.message||"Failed to create offer.")}finally{b(!1)}};return(0,t.jsxs)("div",{className:"container mx-auto py-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Offer Library"}),(0,t.jsxs)(d.lG,{open:p,onOpenChange:g,children:[(0,t.jsx)(d.zM,{asChild:!0,children:(0,t.jsxs)(i.$,{children:[(0,t.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Create Offer"]})}),(0,t.jsxs)(d.Cf,{className:"sm:max-w-[425px]",children:[(0,t.jsxs)(d.c7,{children:[(0,t.jsx)(d.L3,{children:"Create a New Offer"}),(0,t.jsx)(d.rr,{children:"Enter the details for your new offer. It will start in the 'evaluating' state."})]}),(0,t.jsxs)("form",{onSubmit:E,children:[(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h.J,{htmlFor:"name",className:"text-right",children:"Name"}),(0,t.jsx)(o.p,{id:"name",value:N,onChange:e=>y(e.target.value),className:"col-span-3",placeholder:"e.g., Summer Sale Campaign",disabled:C})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(h.J,{htmlFor:"url",className:"text-right",children:"URL"}),(0,t.jsx)(o.p,{id:"url",value:w,onChange:e=>v(e.target.value),className:"col-span-3",placeholder:"https://example.com/offer",type:"url",disabled:C})]}),S&&(0,t.jsx)("p",{className:"text-red-500 text-sm col-span-4 text-center",children:S})]}),(0,t.jsxs)(d.Es,{children:[(0,t.jsx)(d.HM,{asChild:!0,children:(0,t.jsx)(i.$,{type:"button",variant:"secondary",disabled:C,children:"Cancel"})}),(0,t.jsxs)(i.$,{type:"submit",disabled:C,children:[C&&(0,t.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Offer"]})]})]})]})]})]}),(0,t.jsx)("div",{className:"border rounded-lg",children:a?(0,t.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,t.jsx)(m.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,t.jsx)("p",{className:"ml-2",children:"Loading Offers..."})]}):u?(0,t.jsx)("p",{className:"text-red-500 text-center py-10",children:u}):0===e.length?(0,t.jsx)("p",{className:"text-center text-muted-foreground py-10",children:"No offers found. Create your first one!"}):(0,t.jsxs)(c.XI,{children:[(0,t.jsx)(c.A0,{children:(0,t.jsxs)(c.Hj,{children:[(0,t.jsx)(c.nd,{children:"Name"}),(0,t.jsx)(c.nd,{children:"Original URL"}),(0,t.jsx)(c.nd,{children:"Status"}),(0,t.jsx)(c.nd,{children:"Created At"})]})}),(0,t.jsx)(c.BF,{children:e.map(e=>(0,t.jsxs)(c.Hj,{children:[(0,t.jsx)(c.nA,{className:"font-medium",children:e.name}),(0,t.jsx)(c.nA,{children:e.originalUrl}),(0,t.jsx)(c.nA,{children:e.status}),(0,t.jsx)(c.nA,{children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2076,4121,7358],()=>s(75487)),_N_E=e.O()}]);