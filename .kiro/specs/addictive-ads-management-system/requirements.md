# 上瘾式广告管理系统需求文档

## 项目概述

### 核心目标
基于8个核心用户痛点，设计一个让广告投放管理者"上瘾"的Google Ads多账户管理系统。通过"发现-评估-测试-监控-操作-优化"的上瘾闭环，将用户从繁杂重复操作中解放，让他们感觉像投资组合经理一样掌控100+个Google Ads账户。

### 设计理念
- **即时反馈：** 每个操作都有清晰的数据反馈，让用户看到立即的结果
- **掌控感：** 通过可视化和一键操作，让用户感觉完全掌控复杂的广告投放
- **成就感：** 通过ROSC提升和智能建议采纳，持续给用户正向激励
- **简单化：** 复杂的技术实现对用户透明，只暴露最核心的业务价值

### 技术原则
- 使用Firebase AI Logic实现AI能力，避免自训练模型
- 使用SimilarWeb API获取第三方市场数据
- 优先最简单的方式解决用户痛点，避免过度设计

## 用户痛点分析

| 痛点编号 | 用户痛点描述 | 解决策略 |
|---------|-------------|---------|
| 痛点1 | Offer库管理混乱，不知道哪些跑过、哪些没跑、哪些需要放弃 | 可视化看板管理，拖拽式状态流转 |
| 痛点2 | 无法快速评估Offer价值，不知道是否值得投放 | 10秒智能评估，0-100分量化评分 |
| 痛点3 | 评估-仿真-放大流程断裂，操作繁琐 | 一键仿真启动，自动化流程串联 |
| 痛点4 | 100+账户管理混乱，数据分散难以汇总 | 全局视图，按Offer汇总数据 |
| 痛点5 | 多账户操作效率低，重复工作量大 | 批量操作矩阵，一键执行多账户操作 |
| 痛点6 | 风险识别滞后，需要人工每天检查 | AI主动预警，24/7智能监控 |
| 痛点7 | 不知道如何找到相似的高价值Offer | 机会雷达，基于成功案例自动发现 |
| 痛点8 | 广告表现不佳不知如何优化 | 一键诊断，智能优化建议 |## 核
心业务需求

### 需求1：Offer生命周期可视化管理
**解决痛点：** 痛点1 - Offer库管理混乱

**用户故事：** 作为广告投放管理者，我希望能够像管理投资组合一样可视化管理所有Offer的生命周期，以便清晰掌握哪些在赚钱、哪些需要放弃。

**上瘾设计要点：**
- **视觉化进程：** 拖拽卡片的物理交互带来掌控感和"事情在前进"的满足感
- **状态一目了然：** 清晰看到Offer组合状态，降低管理心智负担
- **即时反馈：** 每次状态变更都有视觉反馈和数据更新

**验收标准：**
1. WHEN 用户访问Offer指挥中心 THEN 系统 SHALL 显示看板式视图，包含"机会池"、"评估中"、"仿真中"、"放大中"、"衰退期"、"归档"六个阶段
2. WHEN 用户拖拽Offer卡片到不同阶段 THEN 系统 SHALL 更新Offer状态并记录状态变更历史，提供视觉反馈动画
3. WHEN Offer处于不同阶段 THEN 系统 SHALL 显示对应的关键指标（ROSC、花费、收入）和操作按钮
4. WHEN 用户查看Offer详情 THEN 系统 SHALL 显示完整的ROSC计算过程和历史趋势图
5. WHEN Offer卡片显示 THEN 系统 SHALL 用颜色编码表示表现（绿色=盈利，红色=亏损，黄色=测试中）
6. WHEN 用户将Offer设置为"归档"状态 THEN 系统 SHALL 同步下线补点击任务和相关广告系列，并明确告知用户操作风险
7. WHEN Offer连续5天出现0曝光0点击 THEN 系统 SHALL 自动将Offer状态转为"衰退期"并通知用户
7. WHEN 用户批量录入Offer THEN 系统 SHALL 支持输入广告联盟Offer URL和投放国家，快速积累机会池
8. WHEN 用户进行批量评估或批量仿真 THEN 系统 SHALL 验证用户套餐权限，仅Max/Elite套餐支持高级批量操作##
# 需求2：智能Offer评估系统
**解决痛点：** 痛点2 - 快速评估Offer价值

**用户故事：** 作为广告投放管理者，我希望输入一个URL就能立即知道这个Offer值不值得投放，就像有一个专业分析师在10秒内给我完整的投资建议。

**上瘾设计要点：**
- **量化不确定性：** 将复杂评估变成直观的0-100分，用户会沉迷于寻找"90分以上"的机会
- **即时反馈：** 10秒内从想法变成数据驱动的反馈，鼓励用户不断探索
- **寻宝体验：** 每次评估都像在寻找隐藏的金矿

**简化实现：**
- 使用SimilarWeb API获取流量数据，避免复杂的爬虫系统
- 使用Firebase AI Logic进行内容分析，避免自训练NLP模型

**验收标准：**
1. WHEN 用户输入广告联盟Offer URL THEN 系统 SHALL 在10秒内通过多重重定向获取最终落地页地址
2. WHEN 获取落地页地址 THEN 系统 SHALL 提取域名并通过SimilarWeb API获取投放国家的流量、排名、关键词数据
3. WHEN 系统访问落地页 THEN 系统 SHALL 使用Firebase AI Logic分析网站内容，获取行业、产品类型、客单价、目标客群信息
4. WHEN 系统分析市场数据 THEN 系统 SHALL 识别季节性波动模式和当前市场机会窗口，评估最佳投放时机
5. WHEN 数据收集完成 THEN 系统 SHALL 基于统一评估标准生成0-100分的归一化评分，并显示进度条动画
6. WHEN 系统生成评分 THEN 系统 SHALL 显示流量潜力、关键词精准度、预估CPC成本、合规风险、季节性机会五个维度的雷达图
7. IF 评分高于80分 THEN 系统 SHALL 显示醒目的绿色"启动仿真"按钮，并播放成功音效
8. WHEN 系统检测到合规风险 THEN 系统 SHALL 用红色标记风险类型并提供详细说明和建议### 需求3：一
键仿真启动系统
**解决痛点：** 痛点3 - 快速串联评估-仿真-放大流程

**用户故事：** 作为广告投放管理者，我希望一键就能启动Offer测试，就像按下"自动驾驶"按钮，系统自动完成所有复杂的设置工作。

**上瘾设计要点：**
- **零摩擦启动：** 将数小时的设置工作压缩到一次点击，极致效率提升让用户产生依赖
- **期待感：** 看着ROSC从N/A变为具体数字，充满期待就像等待开奖
- **掌控感：** 可以自定义点击模型，让用户感觉在精细调控策略

**简化实现：**
- 使用现有代理IP API，避免自建IP池
- 使用Playwright简化浏览器自动化，避免复杂的反检测系统

**验收标准：**
1. WHEN 用户点击"启动仿真"按钮 THEN 系统 SHALL 一键配置补点击任务（Offer URL、投放国家、每日点击数），显示"仿真启动中"动画
2. WHEN 补点击任务启动 THEN 系统 SHALL 使用Playwright无头浏览器模拟真实访问，自动处理所有技术细节
3. WHEN 执行URL访问 THEN 系统 SHALL 通过代理IP API为每次访问获取投放国家的不重复IP，确保来源分散
4. WHEN 配置访问模型 THEN 系统 SHALL 提供3个内置模型（工作日模式、周末模式、节假日模式），用可视化曲线展示
5. WHEN 用户需要自定义模型 THEN 系统 SHALL 提供直观的拖拽界面自定义点击分布曲线和Referer配置
6. WHEN 仿真进行中 THEN 系统 SHALL 实时显示执行进度、成功率、ROSC计算倒计时，营造紧张感和期待感
7. WHEN 仿真启动 THEN 系统 SHALL 自动将Offer卡片移入"仿真中"列，并开始显示实时数据更新#
## 需求4：全局多账户管理视图
**解决痛点：** 痛点4 - 100+账户管理混乱

**用户故事：** 作为广告投放管理者，我希望像基金经理看投资组合一样，一眼看到所有账户的核心表现，不再需要登录几十个账户查看数据。

**上瘾设计要点：**
- **上帝视角：** 用户第一次能从全局审视整个"广告帝国"，带来巨大权力感和安全感
- **聚焦核心：** 自动过滤账户层面噪音，直达"哪个Offer赚钱"这个核心问题
- **即时洞察：** 复杂数据变成简单的红绿灯，让决策变得简单清晰

**简化实现：**
- 使用Google Ads API批量获取数据，避免复杂的数据同步系统
- 按Offer维度聚合，简化数据模型

**验收标准：**
1. WHEN 用户访问全局资产视图 THEN 系统 SHALL 按Offer汇总显示所有账户数据，用仪表盘风格展示
2. WHEN 显示Offer汇总数据 THEN 系统 SHALL 包含总花费、总收入、总ROSC、关联账户数量，用颜色编码表示盈亏状态
3. WHEN 用户未输入收益数据 THEN 系统 SHALL 显示ROSC=0并用醒目提示引导用户输入，避免数据单调
4. WHEN 显示Offer表现数据 THEN 系统 SHALL 包含曝光量、点击量、CTR、CPC、总费用、质量得分，用图表可视化展示
5. WHEN 用户筛选数据 THEN 系统 SHALL 支持按ROSC范围、花费区间、时间段等条件过滤，提供预设的快速筛选选项
6. WHEN 数据更新 THEN 系统 SHALL 每小时自动同步Google Ads数据，避免API调用过于频繁，显示最后更新时间
7. WHEN 显示趋势数据 THEN 系统 SHALL 提供天维度的趋势图，展示花费、收入、ROSC、点击量等关键指标的变化趋势
8. WHEN 用户查看趋势图 THEN 系统 SHALL 支持7天、30天、90天等不同时间范围的趋势分析### 需求
5：批量操作管理系统
**解决痛点：** 痛点5 - 多账户操作效率低下

**用户故事：** 作为广告投放管理者，我希望能够像操作Excel一样批量管理所有广告系列，将过去需要几小时的重复操作压缩到30秒完成。

**上瘾设计要点：**
- **效率的快感：** 十倍甚至百倍的效率提升是让用户上瘾的核心
- **零风险操作：** 操作预览和一键撤销让用户敢于大胆操作，增强掌控感
- **自动化满足感：** 定时换链接让用户感觉拥有了自动赚钱机器

**简化实现：**
- 使用Google Ads API批量操作，避免复杂的并发控制
- 简化操作类型，专注最常用的CPC调整、预算调整、换链接

**验收标准：**
1. WHEN 用户访问批量操作矩阵 THEN 系统 SHALL 以Offer为操作对象显示界面，用户选择Offer进行批量操作而非直接操作Google Ads账户
2. WHEN 用户设置过滤条件 THEN 系统 SHALL 提供智能筛选（如"ROSC<1.0且花费>$50"），快速定位问题广告系列
3. WHEN 用户选择批量操作 THEN 系统 SHALL 显示操作预览，包含影响的广告系列数量和预期效果
4. WHEN 用户确认批量操作 THEN 系统 SHALL 显示进度条，完成后提供一键撤销功能
5. WHEN 批量操作完成 THEN 系统 SHALL 显示操作结果摘要，包含成功/失败数量和详细日志
6. WHEN 用户配置"换链接"操作 THEN 系统 SHALL 支持定时触发（每5分钟/每小时/每日）和手动触发，用可视化时间轴显示
7. WHEN 执行"换链接"操作 THEN 系统 SHALL 访问广告联盟Offer URL，经过多重重定向获取最终落地页地址
8. WHEN 获取最终落地页地址 THEN 系统 SHALL 根据"?"前后拆解出Final URL和Final URL suffix，确保每次都获得新的suffix
9. WHEN 执行"换链接"操作 THEN 系统 SHALL 在广告组层面更新Final URL suffix，自动清空广告下的Final URL suffix避免冲突
10. WHEN "换链接"操作完成 THEN 系统 SHALL 记录完整的操作历史，包含操作前后的URL和suffix对比
11. WHEN Max/Elite套餐用户选择A/B测试功能 THEN 系统 SHALL 支持一键复制现有广告组创建测试版本
12. WHEN A/B测试启动 THEN 系统 SHALL 自动分配流量并跟踪两个版本的关键指标对比
13. WHEN A/B测试运行 THEN 系统 SHALL 实时显示测试进度和统计显著性，并在达到置信度时推荐获胜版本### 需求6
：AI智能预警与优化建议
**解决痛点：** 痛点6 - 风险识别和优化建议

**用户故事：** 作为广告投放管理者，我希望有一个24/7的专属优化师主动告诉我哪里有问题、哪里有机会，不需要我每天登录查看数据。

**上瘾设计要点：**
- **从被动到主动：** 用户不再需要"找问题"，而是由AI助手主动报告"机会"
- **正向反馈循环：** 每次采纳建议看到好结果，都会强化对系统的信任和依赖
- **专家感觉：** 让用户感觉拥有了一个永不疲倦的专业分析师

**简化实现：**
- 使用Firebase AI Logic进行数据分析，避免复杂的机器学习模型
- 基于规则引擎和阈值检测，避免复杂的异常检测算法

**验收标准：**
1. WHEN 系统检测到风险 THEN 系统 SHALL 在AI洞察信息流中推送红色预警，包含具体数据和建议操作
2. WHEN 系统发现优化机会 THEN 系统 SHALL 推送绿色优化建议，包含预期收益和一键执行按钮
3. WHEN 用户采纳建议后 THEN 系统 SHALL 跟踪效果并在24小时后反馈结果，强化正向体验
4. WHEN AI分析完成 THEN 系统 SHALL 使用Firebase AI Logic进行多场景分析：落地页内容分析、优化建议生成、风险识别、广告文案合规性检查
5. IF ROSC连续3天下滑超过20% THEN 系统 SHALL 自动发送紧急预警并建议暂停相关广告系列
6. WHEN 系统分析表现数据 THEN 系统 SHALL 监控曝光量、CTR、CPC、质量得分等关键指标的异常变化
7. WHEN 检测到表现异常 THEN 系统 SHALL 提供具体原因分析和3个可选的优化方案
8. WHEN 系统检测到业务风险 THEN 系统 SHALL 识别并预警：Ads账号被封禁、广告主认证触发、广告被拒绝、广告受限、广告费不足（小于20）等业务风险类型
9. WHEN 系统检测到系统运行风险 THEN 系统 SHALL 识别并预警：Offer URL无法解析、补点击大量失败、换链接失败、点击时间分布曲线偏离过大等系统风险类型
10. WHEN 风险预警触发 THEN 系统 SHALL 根据后台配置的风险识别策略执行相应的处理流程
11. WHEN 检测到系统运行异常 THEN 系统 SHALL 立即暂停相关任务并通知用户和管理员### 需求7
：机会发现与扩展系统
**解决痛点：** 痛点7 - 寻找相似高价值Offer

**用户故事：** 作为广告投放管理者，我希望每次成功都能变成下一次成功的起点，系统能够基于我的盈利Offer自动发现更多类似的赚钱机会。

**上瘾设计要点：**
- **永动机：** 将每次成功变成下次成功的起点，创造无限增长期望
- **发现的惊喜：** 系统总能带来用户没想到的新机会，"挖到宝"的惊喜感极具吸引力
- **复制成功：** 让用户感觉找到了"赚钱公式"，可以无限复制

**简化实现：**
- 使用SimilarWeb API的相似网站功能，避免复杂的相似度算法
- 基于关键词和行业标签匹配，避免复杂的语义分析

**验收标准：**
1. WHEN 用户查看ROSC>2.0的Offer详情 THEN 系统 SHALL 自动触发机会雷达，显示"发现相似机会"模块
2. WHEN 机会雷达激活 THEN 系统 SHALL 使用SimilarWeb API找到相似网站，并分析行业、产品类型匹配度
3. WHEN 显示相似机会 THEN 系统 SHALL 为每个新机会生成预判评分，并按评分排序展示
4. WHEN 系统分析关键词 THEN 系统 SHALL 推荐当前Offer未覆盖但相关的高搜索量关键词
5. WHEN 系统分析受众 THEN 系统 SHALL 基于成功Offer的受众特征，建议相似的人群扩展
6. WHEN 用户点击相似机会 THEN 系统 SHALL 一键将其添加到"机会池"，并预填评估数据
7. WHEN Offer进入"放大"阶段 THEN 系统 SHALL 提前引导用户完成Google Ads账号授权，并将Ads账号与Offer关联

### 需求8：广告诊断与优化系统
**解决痛点：** 痛点8 - 广告表现不佳不知如何优化

**用户故事：** 作为广告投放管理者，我希望对于表现不佳的广告，系统能像医生一样快速诊断病因并开出药方，而不是让我盲目提高CPC浪费钱。

**上瘾设计要点：**
- **化繁为简：** 将复杂的优化问题变成清晰的"诊断-药方"模式，降低焦虑感和挫败感
- **建立信任：** 每次诊断都切中要害，用户会把系统当成解决广告难题的"最终权威"
- **即时解决：** 从发现问题到解决问题一气呵成，给用户强烈的效率感

**简化实现：**
- 使用Google Ads API的质量得分和建议API，避免复杂的诊断算法
- 基于规则引擎进行问题分类，避免复杂的机器学习诊断

**验收标准：**
1. WHEN 用户点击"一键诊断"按钮 THEN 系统 SHALL 分析关键词质量分、广告相关性、出价策略、落地页体验等维度
2. WHEN 诊断完成 THEN 系统 SHALL 输出简单的诊断报告，用红绿灯显示各维度状态，并提供具体优化建议
3. WHEN 系统识别主要问题 THEN 系统 SHALL 提供一键修复按钮，如"一键优化CPC"、"一键暂停低质量关键词"
4. WHEN 诊断无曝光无点击问题 THEN 系统 SHALL 分析CPC过低、关键词匹配过严格、广告质量差等具体原因
5. WHEN 提供优化建议 THEN 系统 SHALL 预估优化后的效果，如"预计CTR提升30%，CPC降低15%"#
# 支撑系统需求

### 需求9：数据安全与合规管理

**用户故事：** 作为系统管理员，我希望确保系统的数据安全和合规性，以便保护用户隐私和满足法规要求。

**验收标准：**
1. WHEN 用户连接Google Ads账户 THEN 系统 SHALL 使用OAuth 2.0安全认证
2. WHEN 系统存储敏感数据 THEN 系统 SHALL 使用加密存储在Firestore中
3. WHEN 系统检测违规内容 THEN 系统 SHALL 标记并阻止相关操作
4. WHEN 用户执行批量操作 THEN 系统 SHALL 记录完整的操作审计日志
5. WHEN 系统访问Google Ads API THEN 系统 SHALL 遵循API使用限制和最佳实践
6. WHEN 用户访问数据 THEN 系统 SHALL 实施严格的多用户数据隔离，确保用户只能访问自己的数据
7. WHEN 执行数据库查询 THEN 系统 SHALL 在所有查询中强制包含用户ID条件，防止数据泄露

### 需求10：系统性能与可扩展性

**用户故事：** 作为系统架构师，我希望系统能够高效处理大量数据和用户请求，以便支持业务快速增长。

**验收标准：**
1. WHEN 系统处理100+账户数据 THEN 系统 SHALL 在5秒内完成数据加载和显示
2. WHEN 用户执行批量操作 THEN 系统 SHALL 支持并发处理并显示进度
3. WHEN 系统进行数据同步 THEN 系统 SHALL 使用增量同步减少API调用
4. WHEN 系统负载增加 THEN 系统 SHALL 自动扩展Cloud Run实例
5. WHEN 系统出现错误 THEN 系统 SHALL 记录详细日志并提供错误恢复机制

### 需求11：套餐管理与订阅系统

**用户故事：** 作为产品经理，我希望能够灵活管理不同的套餐和订阅，以便满足不同用户的需求和商业目标。

**验收标准：**
1. WHEN 系统设计套餐 THEN 系统 SHALL 提供Pro（尝鲜）、Max（日常使用）、Elite（深度使用）三个套餐
2. WHEN 用户点击"立即订阅" THEN 系统 SHALL 显示弹窗让用户扫码添加客服微信
3. WHEN 用户完成线下支付 THEN 管理员 SHALL 在后台管理系统手动配置套餐和重置Token
4. WHEN 用户使用功能 THEN 系统 SHALL 根据套餐权限控制功能访问和Token消耗
5. WHEN Pro套餐用户尝试批量操作 THEN 系统 SHALL 提示升级到Max/Elite套餐以使用高级批量功能
6. WHEN Max/Elite套餐用户使用批量功能 THEN 系统 SHALL 支持批量评估、批量仿真等高级操作### 需求12
：后台管理系统

**用户故事：** 作为系统管理员，我希望有一个完善的后台管理系统，以便高效管理用户、套餐、风险策略等系统资源。

**验收标准：**

#### 仪表盘功能
1. WHEN 管理员访问后台仪表盘 THEN 系统 SHALL 显示实时统计数据：用户总数、活跃用户、收入统计、系统状态
2. WHEN 显示收入统计 THEN 系统 SHALL 包含日/周/月收入趋势、套餐订阅分布、Token消耗统计
3. WHEN 显示系统状态 THEN 系统 SHALL 包含服务健康状态、API调用统计、错误率监控、性能指标
4. WHEN 显示用户活跃度 THEN 系统 SHALL 包含登录统计、功能使用热力图、用户留存率分析

#### 用户管理功能
5. WHEN 管理员管理用户 THEN 系统 SHALL 支持用户列表查看、搜索、筛选（按套餐、状态、注册时间）
6. WHEN 查看用户详情 THEN 系统 SHALL 显示用户基本信息、套餐状态、Token余额、使用统计、操作历史
7. WHEN 管理用户账户 THEN 系统 SHALL 支持账户状态管理（激活、暂停、封禁）、套餐变更、Token充值
8. WHEN 处理用户问题 THEN 系统 SHALL 支持查看用户操作日志、错误记录、支持工单管理

#### 套餐管理功能
9. WHEN 管理员管理套餐 THEN 系统 SHALL 支持创建、编辑、删除套餐，配置功能权限列表
10. WHEN 配置套餐权限 THEN 系统 SHALL 支持设置功能模块访问权限、API调用限制、资源配额
11. WHEN 设置套餐价格 THEN 系统 SHALL 支持多币种定价、促销价格、试用期配置
12. WHEN 套餐变更 THEN 系统 SHALL 支持套餐升级/降级规则、数据迁移策略、计费调整

#### Token管理功能
13. WHEN 管理员管理Token THEN 系统 SHALL 支持查看全局Token消耗统计、用户Token余额、消耗趋势
14. WHEN 配置消耗规则 THEN 系统 SHALL 支持设置不同功能的Token消耗标准、批量操作计费规则
15. WHEN 手动充值Token THEN 系统 SHALL 支持批量充值、充值记录、充值原因备注
16. WHEN 监控Token使用 THEN 系统 SHALL 支持异常消耗预警、Token滥用检测、使用模式分析

#### 动态配置功能
17. WHEN 管理员配置系统参数 THEN 系统 SHALL 支持评估标准、AI提示词、风险规则、代理设置的可视化配置
18. WHEN 配置AI参数 THEN 系统 SHALL 支持Firebase AI Logic提示词模板管理、模型参数调整
19. WHEN 配置业务规则 THEN 系统 SHALL 支持自动状态转换规则、预警阈值、操作限制的动态设置
20. WHEN 配置更新 THEN 系统 SHALL 通过Firestore实现配置的实时推送、版本管理、回滚功能

#### 系统监控功能
25. WHEN 管理员监控系统异常 THEN 系统 SHALL 提供全局系统运行风险事件查看，包含异常类型、发生时间、影响范围、处理状态
26. WHEN 管理员查看定时任务 THEN 系统 SHALL 提供定时任务执行结果查看，包含任务类型、执行状态、成功率、错误日志
27. WHEN 系统发生异常 THEN 系统 SHALL 自动记录异常事件并分类存储，支持按时间、类型、严重程度筛选查看
28. WHEN 定时任务执行 THEN 系统 SHALL 记录详细的执行日志，包含开始时间、结束时间、处理数量、错误详情

#### API调用管理功能
21. WHEN 管理员监控API调用 THEN 系统 SHALL 提供Google Ads API调用统计、频率分析、配额管理，确保不超过每日15000次限制
22. WHEN API调用接近限制 THEN 系统 SHALL 自动调整调用频率并发送预警通知
23. WHEN 管理员分析点击真实性 THEN 系统 SHALL 提供AI优化的仿真阶段点击分析，并支持将优化策略更新到URL解析服务
24. WHEN 点击策略优化 THEN 系统 SHALL 支持实时推送优化后的点击模式到所有URL解析服务实例

### 需求13：用户认证与访问控制

**用户故事：** 作为系统安全管理员，我希望实现安全的用户认证和精细的访问控制，以便保护系统安全。

**验收标准：**
1. WHEN 用户未登录访问网站 THEN 系统 SHALL 允许浏览静态页面，确保SEO有效
2. WHEN 用户尝试使用业务功能 THEN 系统 SHALL 强制通过Firebase Authentication登录
3. WHEN 用户登录成功 THEN 系统 SHALL 根据用户套餐权限显示可用功能
4. WHEN 用户会话过期 THEN 系统 SHALL 自动跳转到登录页面
5. WHEN 用户登出 THEN 系统 SHALL 清除会话信息并跳转到首页

### 需求14：前端UI/UX优化

**用户故事：** 作为UX设计师，我希望创建直观易用的用户界面，以便提供优秀的用户体验。

**验收标准：**
1. WHEN 用户使用系统 THEN 界面 SHALL 采用响应式设计，支持桌面和移动设备
2. WHEN 用户执行操作 THEN 系统 SHALL 提供清晰的视觉反馈和加载状态
3. WHEN 用户查看数据 THEN 系统 SHALL 使用图表和可视化组件提升数据可读性
4. WHEN 用户进行复杂操作 THEN 系统 SHALL 提供操作引导和帮助提示
5. WHEN 系统出现错误 THEN 系统 SHALL 显示友好的错误信息和解决建议
6. WHEN 用户自定义点击分布曲线 THEN 系统 SHALL 提供直观的拖拽交互界面
7. WHEN 用户在移动端使用系统 THEN 系统 SHALL 优化触摸交互和手势操作，确保核心功能在移动端可轻松操作
8. WHEN 用户访问系统页面 THEN 系统 SHALL 仅保留网站Logo和Footer链接，其他内容采用全新设计

### 需求21：系统页面内容管理

**用户故事：** 作为产品经理，我希望根据最新的产品设计更新系统页面内容，以便提供准确的产品信息和法律条款。

**验收标准：**
1. WHEN 用户访问/about页面 THEN 系统 SHALL 显示最新的产品介绍、核心功能、技术优势和团队信息
2. WHEN 用户访问/contact页面 THEN 系统 SHALL 提供多种联系方式、客服支持和反馈渠道
3. WHEN 用户访问/privacy页面 THEN 系统 SHALL 显示完整的隐私政策，包含数据收集、使用、存储和保护条款
4. WHEN 用户访问/terms页面 THEN 系统 SHALL 显示服务条款、用户协议和免责声明
5. WHEN 用户访问系统页面 THEN 系统 SHALL 确保内容与最新的产品设计和UI/UX设计保持一致

### 需求22：国际化与多语言支持

**用户故事：** 作为国际用户，我希望能够使用母语访问和操作系统，以便更好地理解和使用产品功能。

**验收标准：**
1. WHEN 用户访问系统 THEN 系统 SHALL 支持中英双语切换，默认根据浏览器语言自动选择
2. WHEN 用户切换语言 THEN 系统 SHALL 实时更新所有界面文本、错误信息、通知内容
3. WHEN 系统显示数据 THEN 系统 SHALL 根据语言设置格式化日期、时间、数字和货币
4. WHEN 用户使用AI功能 THEN 系统 SHALL 根据语言设置调用相应的AI提示词模板
5. WHEN 系统发送通知 THEN 系统 SHALL 使用用户设置的语言发送邮件和推送通知

### 需求23：SEO优化与站点地图

**用户故事：** 作为营销人员，我希望系统具备优秀的SEO表现，以便提高搜索引擎排名和用户发现率。

**验收标准：**
1. WHEN 搜索引擎爬取网站 THEN 系统 SHALL 提供完整的站点地图，包含所有公开页面的多语言版本
2. WHEN 用户访问任何页面 THEN 系统 SHALL 提供优化的meta标签、标题、描述和关键词
3. WHEN 系统生成页面 THEN 系统 SHALL 确保语义化HTML结构和适当的heading层级
4. WHEN 用户分享页面 THEN 系统 SHALL 提供Open Graph和Twitter Card元数据
5. WHEN 搜索引擎索引网站 THEN 系统 SHALL 提供robots.txt和结构化数据标记
6. WHEN 用户访问不同语言版本 THEN 系统 SHALL 提供正确的hreflang标签指向对应语言页面

## 技术架构需求

### 需求15：通用URL解析服务（常驻服务）

**用户故事：** 作为系统架构师，我希望有一个高性能的URL解析服务，以便为多个业务模块提供稳定可靠的URL解析能力。

**技术架构考虑：**
- **服务复用：** Offer评估、换链接、仿真启动都需要解析广告联盟URL
- **常驻服务：** 部署为Cloud Run常驻服务，避免冷启动，维持浏览器实例池
- **性能优化：** 统一的服务可以实现批量处理和资源复用
- **维护简化：** 集中管理反检测策略和代理IP轮换

**验收标准：**
1. WHEN 部署URL解析服务 THEN 系统 SHALL 创建独立的Cloud Run常驻服务，维持最小1个实例运行
2. WHEN 服务启动 THEN 系统 SHALL 初始化Playwright浏览器实例池，支持并发处理多个URL解析请求
3. WHEN 任何模块需要解析Offer URL THEN 系统 SHALL 调用统一的URL解析服务API
4. WHEN 解析URL THEN 系统 SHALL 返回最终落地页地址、Final URL、Final URL suffix等结构化数据
5. WHEN 解析失败 THEN 系统 SHALL 提供重试机制和错误详情
6. WHEN 服务调用 THEN 系统 SHALL 支持批量解析，提高处理效率
7. WHEN 访问URL THEN 系统 SHALL 根据投放国家匹配相应的时区、语言和User-Agent，提高访问真实性
8. WHEN 检测到反爬虫 THEN 系统 SHALL 自动切换代理IP和优化User-Agent策略
9. WHEN 服务空闲 THEN 系统 SHALL 保持浏览器实例活跃，避免频繁创建销毁带来的性能损耗
10. WHEN 处理相同国家的不同Offer URL THEN 系统 SHALL 在时间窗口内复用代理IP，但确保同一Offer URL每次访问使用不重复的代理IP
11. WHEN 管理员配置代理设置 THEN 系统 SHALL 支持配置"国家-代理IP API URL"的关联关系，便于获取不同国家的代理IP

### 需求16：Google Ads账号授权与关联管理

**用户故事：** 作为广告投放管理者，我希望能够安全便捷地管理多个Google Ads账号的授权和关联，以便统一管理所有广告投放。

**上瘾设计要点：**
- **无缝集成：** 授权过程简单快捷，不打断用户的工作流程
- **安全感：** 清晰的权限说明和安全提示，让用户放心授权
- **掌控感：** 用户可以随时查看和管理已授权的账号

**验收标准：**
1. WHEN Offer进入"放大"阶段 THEN 系统 SHALL 主动引导用户完成Google Ads账号授权
2. WHEN 用户进行账号授权 THEN 系统 SHALL 使用Google Ads OAuth 2.0流程，确保安全性
3. WHEN 授权完成 THEN 系统 SHALL 显示账号基本信息（账号名称、ID、货币）供用户确认
4. WHEN 用户关联Offer与Ads账号 THEN 系统 SHALL 支持一个Offer关联多个账号，一个账号关联多个Offer
5. WHEN 用户查看账号列表 THEN 系统 SHALL 显示每个账号的授权状态、关联Offer数量、最后同步时间
6. WHEN 授权过期或失效 THEN 系统 SHALL 主动提醒用户重新授权，并暂停相关操作
7. WHEN 用户取消授权 THEN 系统 SHALL 清理相关数据并停止所有相关的自动化操作#
## 需求17：定时任务管理系统

**用户故事：** 作为系统架构师，我希望有一个统一的定时任务管理系统，以便支持补点击任务、换链接、数据同步等各种定时操作。

**技术架构考虑：**
- **任务调度：** 使用Cloud Scheduler作为定时触发器
- **消息分发：** 通过Pub/Sub实现任务消息的可靠分发
- **任务执行：** Cloud Functions作为轻量级任务执行器
- **业务处理：** Cloud Run服务处理具体的业务逻辑

**验收标准：**
1. WHEN 系统需要定时任务 THEN 系统 SHALL 使用Cloud Scheduler + Pub/Sub + Cloud Functions的架构模式
2. WHEN 创建补点击任务 THEN 系统 SHALL 通过Cloud Scheduler定时发送消息到`click-simulation-topic`
3. WHEN 创建换链接任务 THEN 系统 SHALL 通过Cloud Scheduler定时发送消息到`link-rotation-topic`
4. WHEN 创建数据同步任务 THEN 系统 SHALL 通过Cloud Scheduler定时发送消息到`ads-sync-topic`
5. WHEN Pub/Sub接收到任务消息 THEN 系统 SHALL 触发对应的Cloud Function执行器
6. WHEN Cloud Function执行 THEN 系统 SHALL 调用相应的Cloud Run服务处理业务逻辑
7. WHEN 任务执行失败 THEN 系统 SHALL 支持自动重试和死信队列处理
8. WHEN 用户配置定时策略 THEN 系统 SHALL 动态创建或更新Cloud Scheduler作业
9. WHEN 任务执行完成 THEN 系统 SHALL 记录执行日志和结果状态

### 需求18：技术栈优化与扩展

**用户故事：** 作为系统架构师，我希望充分利用现有技术栈并合理扩展新组件，以便构建稳定高效的系统架构。

**技术栈优化策略：**

#### 充分利用现有技术栈
1. **Google Cloud Pub/Sub优化利用**
   - 定时任务消息分发
   - 服务间异步通信
   - 事件驱动架构实现

2. **Google Cloud Functions优化利用**
   - 定时任务执行器
   - 轻量级数据处理
   - 事件响应处理

3. **Google Cloud SQL优化利用**
   - 历史数据存储（广告数据、财务记录）
   - 复杂查询和报表分析
   - 事务处理和审计日志

4. **Firestore优化利用**
   - 实时配置与缓存
   - 用户会话与状态管理
   - 轻量级业务数据
   - 实时通知与消息

#### 新增必要技术组件

**验收标准：**
1. WHEN 系统需要定时调度 THEN 系统 SHALL 集成Google Cloud Scheduler
2. WHEN 系统需要文件存储 THEN 系统 SHALL 集成Google Cloud Storage用于日志归档和报表存储
3. WHEN 系统需要监控告警 THEN 系统 SHALL 集成Google Cloud Monitoring & Logging
4. WHEN 系统需要密钥管理 THEN 系统 SHALL 集成Google Cloud Secret Manager
5. WHEN 系统部署 THEN 系统 SHALL 按照以下架构层次组织：
   ```
   定时任务层：Cloud Scheduler
       ↓
   消息队列层：Pub/Sub
       ↓
   任务执行层：Cloud Functions
       ↓
   业务逻辑层：Cloud Run Services
       ↓
   数据存储层：Firestore + Cloud SQL
       ↓
   监控告警层：Cloud Monitoring
   ```
6. WHEN 数据存储设计 THEN 系统 SHALL 按照以下原则分配：
   - Firestore：配置数据、实时状态、临时数据、消息通知
   - Cloud SQL：历史数据、复杂查询、事务处理、审计日志
7. WHEN 服务通信 THEN 系统 SHALL 通过API Gateway统一管理外部API调用和限流
8. WHEN 系统扩展 THEN 系统 SHALL 保持技术栈的一致性和可维护性

### 需求19：测试策略与质量保证

**用户故事：** 作为开发团队，我希望有完善的测试体系，以便确保系统的稳定性、性能和功能正确性。

**验收标准：**
1. WHEN 开发新功能 THEN 系统 SHALL 要求单元测试覆盖率达到80%以上
2. WHEN 系统集成 THEN 系统 SHALL 实施端到端测试覆盖关键用户流程
3. WHEN 系统部署 THEN 系统 SHALL 执行性能测试确保响应时间和并发处理能力
4. WHEN 代码提交 THEN 系统 SHALL 自动运行测试套件并阻止不通过的代码合并
5. WHEN 测试执行 THEN 系统 SHALL 生成详细的测试报告和覆盖率分析
6. WHEN 性能测试 THEN 系统 SHALL 验证100+账户数据加载在5秒内完成
7. WHEN 负载测试 THEN 系统 SHALL 支持1000并发用户访问而不影响性能

### 需求20：动态配置管理系统

**用户故事：** 作为系统管理员，我希望能够动态配置系统参数和业务规则，以便快速响应业务需求变化而无需重新部署。

**验收标准：**
1. WHEN 管理员修改配置 THEN 系统 SHALL 通过Firestore实现配置的热更新，无需重启服务
2. WHEN 配置更新 THEN 系统 SHALL 在30秒内将配置变更推送到所有服务实例
3. WHEN 管理业务规则 THEN 系统 SHALL 支持可视化配置评估标准、风险阈值、预警规则
4. WHEN 配置AI提示词 THEN 系统 SHALL 支持动态更新Firebase AI Logic的提示词模板
5. WHEN 管理套餐权限 THEN 系统 SHALL 支持动态调整套餐功能权限和Token消耗规则
6. WHEN 配置代理服务 THEN 系统 SHALL 支持动态添加、删除、修改代理IP服务商配置
7. WHEN 系统扩展 THEN 系统 SHALL 支持插件化架构，通过配置启用或禁用功能模块
8. WHEN 配置变更 THEN 系统 SHALL 记录完整的配置变更历史和回滚能力## 上瘾体验设计
总结

### 即时反馈循环
- 每个操作都有立即的视觉反馈（动画、颜色变化、数据更新）
- 评估→仿真→优化的每个环节都有明确的进度指示和结果展示
- 用户永远知道"下一步该做什么"和"现在处于什么状态"

### 掌控感和成就感
- 拖拽操作、一键执行、批量处理让用户感觉"一切尽在掌握"
- ROSC提升、建议采纳成功、风险及时发现给用户持续的正向激励
- 从"机会发现"到"规模扩大"的完整闭环让用户看到增长路径

### 简化复杂性
- 将技术复杂性隐藏在简单的界面后面
- 用颜色、图表、评分等直观方式展示复杂数据
- 提供预设选项和智能建议，减少用户的认知负担

## 技术实现策略

### 避免过度工程
- 使用Firebase AI Logic而不是自训练模型
- 使用SimilarWeb API而不是自建爬虫系统
- 使用Google Ads API的现有功能而不是重复造轮子
- 创建统一的URL解析服务，避免在多个模块中重复实现相同功能

### 专注核心价值
- 优先实现直接解决用户痛点的功能
- 避免炫技式的复杂功能，专注业务价值
- 用最简单的技术方案实现最大的用户价值
- 通过服务复用提高开发效率和系统稳定性

### 渐进式增强
- 先实现核心功能的MVP版本
- 基于用户反馈逐步增加高级功能
- 保持系统的可扩展性但不过度设计
- 统一的URL解析服务为后续功能扩展提供坚实基础

### 架构优化考虑
- 通用URL解析服务支持Offer评估、换链接、仿真启动等多个模块
- 实现批量处理，提高系统性能
- 集中管理反检测策略和地域化配置，简化维护工作
- 优化API调用频率，避免触及Google Ads API限制

## 需求总结

本需求文档包含20个核心需求模块：

**核心业务需求（需求1-8）：**
- 解决8个核心用户痛点
- 实现完整的上瘾体验闭环
- 提供核心的广告管理功能

**支撑系统需求（需求9-16）：**
- 确保系统安全性和合规性
- 提供良好的用户体验
- 支持商业模式和运营管理
- Google Ads账号授权与关联管理

**技术架构需求（需求17-18）：**
- 构建稳定高效的技术架构
- 充分利用现有技术栈
- 支持系统的可扩展性和可维护性

**质量保证需求（需求19-20）：**
- 完善的测试策略和质量保证体系
- 动态配置管理和热更新能力
- 提高系统的可维护性和扩展性

每个需求都包含清晰的用户故事、上瘾设计要点（适用时）、简化实现策略（适用时）和详细的EARS格式验收标准，为后续的设计和开发提供了完整的指导。