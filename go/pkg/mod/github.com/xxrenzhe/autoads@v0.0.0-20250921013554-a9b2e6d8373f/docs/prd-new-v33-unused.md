# AutoAds 多用户 SaaS 系统重构 PRD

## 文档信息
- **项目名称**: AutoAds 多用户 SaaS 系统
- **版本**: v33.0
- **创建日期**: 2025-01-09
- **最后更新**: 2025-09-12
- **负责人**: 产品团队

## 目录

1. **执行摘要**
2. **项目概述**
   2.1 现有项目分析
   2.2 命名说明
   2.3 目标和背景
3. **需求分析**
   3.1 功能需求（FR）
   3.2 非功能需求（NFR）
   3.3 兼容性需求（CR）
   3.4 用户套餐权限矩阵
   3.5 Token充值价格
4. **技术架构设计**
   4.1 整体架构
   4.2 GoFly框架核心特性
   4.3 架构评估：Go单体应用+模块化设计
   4.4 数据库设计
   4.5 API设计
   4.6 安全设计
   4.7 性能优化策略
   4.8 监控与运维
5. **用户界面设计**
   5.1 界面增强目标
   5.2 现有UI集成策略
6. **技术约束和集成需求**
   6.1 现有技术栈
   6.2 集成方法
   6.3 现有业务逻辑保护
   6.4 代码组织和标准
   6.5 部署和运维
   6.6 风险评估和缓解
7. **实施计划**
   7.1 项目阶段划分
   7.2 资源需求
   7.3 风险管理
   7.4 成功指标
8. **用户故事和验收标准**
   8.1 Epic定义
   8.2 核心用户故事
9. **系统架构优化**
   9.1 GoFly框架深度分析
   9.2 管理系统集成方案
   9.3 API网关设计
   9.4 数据一致性管理
   9.5 监控告警集成
10. **附录**
    10.1 术语表
    10.2 参考资料
    10.3 变更日志

---

## 1. 执行摘要

AutoAds 正在从 Next.js 单体应用重构为基于 GoFly 框架的多用户 SaaS 系统。当前系统已实现完整的用户认证、权限管理和三大核心功能，包括：✅ BatchOpen（批量访问，已实现三种模式）、✅ SiteRank（网站排名，已集成真实SimilarWeb API）、❌ ChangeLink（链接管理，仅有UI原型）。重构目标是将现有功能（BatchOpen→BatchGo、SiteRank→SiteRankGo、ChangeLink→AdsCenterGo）迁移至 Go 语言 + GoFly 架构，实现4900%性能提升和专业的后台管理系统。

## 2. 能力与限额单一真相源（SSOT）表

| 功能模块 | 参数 | Free套餐 | Pro套餐 | Max套餐 | 说明 |
|---------|------|----------|---------|---------|------|
| **BatchGo Basic** | 单次任务URL数量 | 10 | 100 | 1,000 | 前端标签页打开模式 |
| **BatchGo Silent** | 单次任务URL数量 | 10 | 100 | 1,000 | HTTP/Puppeteer模式 |
| **BatchGo Automated** | 单次任务URL数量 | 不支持 | 100 | 1,000 | HTTP/Puppeteer模式 |
| **并发任务数** | Basic/Silent/Automated | 1 / 5 / 不支持 | 1 / 5 / 50 | 1 / 5 / 50 | 同时运行的任务数 |
| **循环次数上限** | 所有版本 | 10 | 100 | 100 | 每个任务的循环执行次数 |
| **HTTP模式并发倍数** | 性能提升 | - | 10x | 10x | 相对于Puppeteer的性能倍数 |
| **SiteRankGo** | 单次查询域名数 | 100 | 500 | 5,000 | 批量查询上限 |
| **SiteRankGo** | 查询频率 | 30次/分钟 | 30次/分钟 | 30次/分钟 | 系统级限制，与套餐无关 |
| **AdsCenterGo** | 管理账号数 | 不支持 | 10个 | 100个 | Google Ads账号数量 |
| **包含Token数量** | 初始配额 | 1,000 | 10,000 | 100,000 | 月度重置 |
| **API调用频率** | 限制 | 100/小时 | 1,000/小时 | 10,000/小时 | 基于套餐的API限流 |

## 3. 关键参数修正

基于SSOT表，以下参数需要统一：

1. **Basic版本URL数量**：统一为10个/任务
2. **并发数**：
   - Basic版本：1并发（前端标签页）
   - Silent版本：5并发
   - Automated版本：50并发（仅Pro/Max）
3. **SiteRank频率限制**：统一为系统级30次/分钟，所有套餐相同
4. **循环次数**：统一为Basic/Pro 10次，Max 100次

## 4. 技术栈统一

所有技术实现统一基于GoFly + GoFrame：

- **Web框架**：GoFrame (gf)
- **路由**：GoFly自动路由系统
- **中间件**：GoFly内置中间件栈
- **ORM**：GoFly gform
- **WebSocket**：GoFly WebSocket封装
- **配置管理**：GoFly YAML配置

移除所有Gin相关代码示例。